
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as P,ar as G,ax as H,aS as J,as as Z,M as y,g as O,a1 as S,at as Q,N as V,o as g,m as x,r as N,k as T,a as l,B as $,aJ as A,aT as W,Z as X,a3 as Y,aP as R,ao as ee,aU as te,aV as ae,aL as F,aD as le,b as j,av as U,aM as K,aN as ne,ad as oe,v as se,c as ue,R as re,S as de}from"./index-Bnionyve.js";import{V as ie}from"./VisuallyHiddenInput-DIcn5ZUO.js";const[pe,ce]=Q("PinInputRoot");var me=P({inheritAttrs:!1,__name:"PinInputRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:Array,required:!1},placeholder:{type:String,required:!1,default:""},mask:{type:Boolean,required:!1},otp:{type:Boolean,required:!1},type:{type:null,required:!1,default:"text"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","complete"],setup(d,{emit:n}){var w;const t=d,o=n,{mask:u,otp:c,placeholder:_,type:i,disabled:p,dir:v}=G(t),{forwardRef:I}=H(),M=J(v),h=Z(t,"modelValue",o,{defaultValue:(w=t.defaultValue)!=null?w:[],passive:!0,deep:!0}),q=y(()=>Array.isArray(h.value)?[...h.value]:[]),b=O(new Set);function D(m){b.value.add(m)}const k=y(()=>t.type==="number"),B=y(()=>q.value.filter(f=>!!f||k.value&&f===0).length===b.value.size);return S(h,()=>{B.value&&o("complete",h.value)},{deep:!0}),ce({modelValue:h,currentModelValue:q,mask:u,otp:c,placeholder:_,type:i,dir:M,disabled:p,isCompleted:B,inputElements:b,onInputElementChange:D,isNumericMode:k}),(m,f)=>(g(),V(l(A),$(m.$attrs,{ref:l(I),dir:l(M),"data-complete":B.value?"":void 0,"data-disabled":l(p)?"":void 0}),{default:x(()=>{var e;return[N(m.$slots,"default",{modelValue:l(h)}),T(ie,{id:m.id,as:"input",feature:"focusable",tabindex:"-1",value:q.value.join(""),name:(e=m.name)!=null?e:"",disabled:l(p),required:m.required,onFocus:f[0]||(f[0]=a=>{var s,r;return(r=(s=Array.from(b.value))==null?void 0:s[0])==null?void 0:r.focus()})},null,8,["id","value","name","disabled","required"])]}),_:3},16,["dir","data-complete","data-disabled"]))}}),fe=me,ve=P({__name:"PinInputInput",props:{index:{type:Number,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},setup(d){const n=d,t=pe(),o=y(()=>Array.from(t.inputElements.value)),u=y(()=>t.currentModelValue.value[n.index]),c=y(()=>n.disabled||t.disabled.value),_=y(()=>t.otp.value),i=y(()=>t.mask.value),{primitiveElement:p,currentElement:v}=W();function I(e){var r,C;const a=e.target;if(((C=(r=e.data)==null?void 0:r.length)!=null?C:0)>1){w(a.value);return}if(t.isNumericMode.value&&!/^\d*$/.test(a.value)){a.value=a.value.replace(/\D/g,"");return}a.value=e.data||a.value.slice(-1),f(n.index,a.value);const s=o.value[n.index+1];s&&s.focus()}function M(){const e=v.value;ee(()=>{e&&!e.value&&(e.placeholder=t.placeholder.value)})}function h(e){te(e,ae(),void 0,{itemsArray:o.value,focus:!0,loop:!1,arrowKeyOptions:"horizontal",dir:t.dir.value})}function q(e){if(e.preventDefault(),e.target.value)f(n.index,"");else{const r=o.value[n.index-1];r&&(r.focus(),f(n.index-1,""))}}function b(e){e.key==="Delete"&&(e.preventDefault(),f(n.index,""))}function D(e){const a=e.target;a.setSelectionRange(1,1),a.value||(a.placeholder="")}function k(e){M()}function B(e){e.preventDefault();const a=e.clipboardData;if(!a)return;const s=a.getData("text");w(s)}function w(e){var C;const a=[...t.currentModelValue.value],s=e.length>=o.value.length?0:n.index,r=Math.min(s+e.length,o.value.length);for(let E=s;E<r;E++){const L=o.value[E],z=e[E-s];t.isNumericMode.value&&!/^\d*$/.test(z)||(a[E]=z,L.focus())}t.modelValue.value=a,(C=o.value[r])==null||C.focus()}function m(e){let a=e.length-1;for(;a>=0&&e[a]==="";)e.pop(),a--;return e}function f(e,a){const s=[...t.currentModelValue.value];if(t.isNumericMode.value){const r=+a;a===""||isNaN(r)?delete s[e]:s[e]=r}else s[e]=a;t.modelValue.value=m(s)}return S(u,()=>{u.value||M()}),X(()=>{t.onInputElementChange(v.value)}),Y(()=>{var e;(e=t.inputElements)==null||e.value.delete(v.value)}),(e,a)=>(g(),V(l(A),{ref_key:"primitiveElement",ref:p,autocapitalize:"none",as:e.as,"as-child":e.asChild,autocomplete:_.value?"one-time-code":"false",type:i.value?"password":"text",inputmode:l(t).isNumericMode.value?"numeric":"text",pattern:l(t).isNumericMode.value?"[0-9]*":void 0,placeholder:l(t).placeholder.value,value:u.value,disabled:c.value,"data-disabled":c.value?"":void 0,"data-complete":l(t).isCompleted.value?"":void 0,"aria-label":"pin input ".concat(e.index+1," of ").concat(o.value.length),onInput:a[0]||(a[0]=s=>I(s)),onKeydown:[R(h,["left","right","up","down","home","end"]),R(q,["backspace"]),R(b,["delete"])],onFocus:D,onBlur:k,onPaste:B},{default:x(()=>[N(e.$slots,"default")]),_:3},8,["as","as-child","autocomplete","type","inputmode","pattern","placeholder","value","disabled","data-disabled","data-complete","aria-label"]))}}),he=ve;const ye=P({__name:"PinInput",props:{modelValue:{default:()=>[]},defaultValue:{},placeholder:{},mask:{type:Boolean},otp:{type:Boolean},type:{},dir:{},disabled:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue","complete"],setup(d,{emit:n}){const t=d,o=n,u=F(t,"class"),c=le(u,o);return(_,i)=>(g(),V(l(fe),$(l(c),{class:l(j)("flex gap-2 items-center",t.class)}),{default:x(()=>[N(_.$slots,"default")]),_:3},16,["class"]))}}),ge=P({__name:"PinInputGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(d){const n=d,t=F(n,"class"),o=U(t);return(u,c)=>(g(),V(l(A),$(l(o),{class:l(j)("flex items-center",n.class)}),{default:x(()=>[N(u.$slots,"default")]),_:3},16,["class"]))}}),_e=P({__name:"PinInputSlot",props:{index:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(d){const n=d,t=F(n,"class"),o=U(t);return(u,c)=>(g(),V(l(he),$(l(o),{class:l(j)("relative text-center focus:outline-none focus:ring-2 focus:ring-ring focus:relative focus:z-10 flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",n.class)}),null,16,["class"]))}}),xe=P({name:"FaPinInput",__name:"index",props:K({length:{default:6}},{modelValue:{},modelModifiers:{}}),emits:K(["complete"],["update:modelValue"]),setup(d,{emit:n}){const t=n,o=ne(d,"modelValue"),u=O([]);S(o,i=>{var p;u.value=(p=i==null?void 0:i.split(""))!=null?p:[]});function c(i){o.value=i.join(""),t("complete")}const _=oe();return(i,p)=>(g(),V(l(ye),{id:l(_),modelValue:l(u),"onUpdate:modelValue":p[0]||(p[0]=v=>se(u)?u.value=v:null),placeholder:"○",otp:"",onComplete:c},{default:x(()=>[T(l(ge),null,{default:x(()=>[(g(!0),ue(re,null,de(d.length,(v,I)=>(g(),V(l(_e),{key:v,index:I},null,8,["index"]))),128))]),_:1})]),_:1},8,["id","modelValue"]))}});export{xe as _};
