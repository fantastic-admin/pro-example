
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-TgflyMpU-BuemEpsd.js","./index-Bnionyve.js","./index-DpF4sDjY.css"])))=>i.map(i=>d[i]);
import{an as Z,Z as F,g as b,ar as ee,M as w,a1 as L,ao as te,c as u,o as i,r as $,O as c,N as ae,D as le,B as T,U as p,l as v,p as f,R as V,S as oe,a as o,k as re,cA as ie,cC as se}from"./index-Bnionyve.js";import{Q as ue,A as ne,v as ve,m as A,C as de,g as pe,p as E,b as ce,a as ye,I as C,f as _,y as fe,O as I,G as me}from"./vue-data-ui-DO-nR8BN.js";import{t as ge,o as M}from"./useNestedProp-dJX_8vvZ-Dub3p3M4.js";import{J as he}from"./themes-AUNCOb2G-RAhReTPj.js";import{S as be,T as xe}from"./BaseScanner-BgWxam9d-Cak_1oua.js";import"./alert-Vqv_sKXu.js";import"./command.vue_vue_type_script_setup_true_lang-BupUAzs5.js";import"./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js";const ke=["onClick","onMouseenter","onMouseleave"],we={key:1},Ae=["xmlns","viewBox"],Ce=["id"],_e=["stop-color"],Se=["stop-color"],$e=["height","width","fill","rx"],Ie=["height","width","fill","rx"],De=["height","width","fill","rx"],ze={key:2,ref:"source",dir:"auto"},Me={__name:"vue-ui-sparkbar",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}},backgroundOpacity:{type:Number,default:null}},emits:["selectDatapoint"],setup(R,{emit:P}){const G=ie(()=>se(()=>import("./PackageVersion-TgflyMpU-BuemEpsd.js"),__vite__mapDeps([0,1,2]),import.meta.url)),{vue_ui_sparkbar:U}=ge(),y=R,W=Z();F(()=>{W["chart-background"]&&console.warn("VueUiSparkbar does not support the #chart-background slot.")});const D=b(ue()),e=b(S()),{loading:x,FINAL_DATASET:d}=be({...ee(y),FINAL_CONFIG:e,prepareConfig:S,skeletonDataset:[{name:"_",value:21,target:25,color:"#808080"},{name:"_",value:13,target:25,color:"#ADADAD"},{name:"_",value:8,target:25,color:"#DBDBDB"}],skeletonConfig:ne({defaultConfig:e.value,userConfig:{style:{backgroundColor:"#99999930",animation:{show:!1},layout:{independant:!0},gutter:{backgroundColor:"#6A6A6A",opacity:50},bar:{gradient:{underlayerColor:"#6A6A6A"}}}}})}),z=w(()=>!!e.value.debug);function S(){const t=M({userConfig:y.config,defaultConfig:U});return t.theme?{...M({userConfig:he.vue_ui_sparkbar[t.theme]||y.config,defaultConfig:t}),customPalette:ve[t.theme]||A}:t}L(()=>y.config,t=>{e.value=S()},{deep:!0});const j=w(()=>de(e.value.customPalette)),m=b(d.value.map(t=>({...t,value:e.value.style.animation.show?0:t.value||0,formatter:t.formatter||null}))),B=b(null);F(async()=>{pe(y.dataset)&&E({componentName:"VueUiSparkbar",type:"dataset",debug:z.value}),N()});function N(){if(e.value.style.animation.show){let t=function(){h+=r/l,h<r?(m.value=m.value.map((s,k)=>({...s,value:s.value+=a[k]})),B.value=requestAnimationFrame(t)):m.value=d.value.map(s=>({...s,value:s.value||0,formatter:s.formatter||null}))};const l=e.value.style.animation.animationFrames,a=d.value.map((s,k)=>s.value/l),r=d.value.map(s=>s.value||0).reduce((s,k)=>s+k,0);let h=0;t()}}L(()=>d.value,async t=>{cancelAnimationFrame(B.value),m.value=d.value.map(l=>({...l,value:e.value.style.animation.show?0:l.value||0,formatter:l.formatter||null})),te(N)},{deep:!0});const n=b({width:500,height:16}),q=w(()=>Math.max(...d.value.map(t=>t.value))),Q=w(()=>(d.value.forEach((t,l)=>{ce({datasetObject:t,requiredAttributes:["name","value"]}).forEach(a=>{E({componentName:"VueUiSparkbar",type:"datasetSerieAttribute",property:a,index:l,debug:z.value})})}),m.value.map((t,l)=>({...t,value:t.value||0,color:ye(t.color)||j.value[l]||A[l]||A[l%A.length]}))));function J(t){return t/q.value}function O(t){return e.value.style.layout.independant?t.target?t.value/t.target:e.value.style.layout.percentage?t.value>100?1:t.value/100:e.value.style.layout.target===0?1:t.value/e.value.style.layout.target:J(t.value)}function g(t){return e.value.style.layout.independant&&t.target||e.value.style.layout.target}const H=P;function K(t,l){H("selectDatapoint",{datapoint:t,index:l}),e.value.events.datapointClick&&e.value.events.datapointClick({datapoint:t,seriesIndex:l})}function X(t,l){e.value.events.datapointEnter&&e.value.events.datapointEnter({datapoint:t,seriesIndex:l})}function Y(t,l){e.value.events.datapointLeave&&e.value.events.datapointLeave({datapoint:t,seriesIndex:l})}return(t,l)=>(i(),u("div",{class:"vue-data-ui-component vue-ui-sparkbar",style:p({width:"100%",position:"relative",fontFamily:e.value.style.fontFamily,background:y.backgroundOpacity!==null?o(I)(e.value.style.backgroundColor,y.backgroundOpacity):e.value.style.backgroundColor})},[t.$slots.title?$(t.$slots,"title",le(T({key:0},{title:{...t.title,title:e.value.style.title.text,subtitle:e.value.style.title.subtitle.text}}))):c("",!0),!t.$slots.title&&e.value.style.title.text?(i(),u("div",{key:1,class:"vue-ui-sparkbar-title-container",style:p({background:e.value.style.title.backgroundColor,margin:e.value.style.title.margin,textAlign:e.value.style.title.textAlign})},[v("div",{class:"vue-ui-sparkbar-title",style:p({fontSize:e.value.style.title.fontSize+"px",color:e.value.style.title.color,fontWeight:e.value.style.title.bold?"bold":"normal"})},f(e.value.style.title.text),5),e.value.style.title.subtitle.text?(i(),u("div",{key:0,class:"vue-ui-sparkbar-subtitle",style:p({fontSize:e.value.style.title.subtitle.fontSize+"px",color:e.value.style.title.subtitle.color,fontWeight:e.value.style.title.subtitle.bold?"bold":"normal"})},f(e.value.style.title.subtitle.text),5)):c("",!0)],4)):c("",!0),(i(!0),u(V,null,oe(Q.value,(a,r)=>(i(),u("div",{style:p("display:flex !important;".concat(["left","right"].includes(e.value.style.labels.name.position)?"flex-direction: ".concat(e.value.style.labels.name.position==="right"?"row-reverse":"row"," !important"):"flex-direction:column !important",";gap:").concat(e.value.style.gap,"px !important;align-items:center;").concat(o(d).length>0&&r!==o(d).length-1?"margin-bottom:6px":"")),onClick:h=>K(a,r),onMouseenter:h=>X(a,r),onMouseleave:h=>Y(a,r)},[o(x)?c("",!0):$(t.$slots,"data-label",T({key:0,ref_for:!0},{bar:{...a,target:g(a),valueLabel:o(C)(a.formatter,a.value,o(_)({p:a.prefix||"",v:a.value,s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r}),targetLabel:o(C)(a.formatter,g(a),o(_)({p:a.prefix||"",v:g(a),s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r})}})),!t.$slots["data-label"]||o(x)?(i(),u("div",{key:1,style:p({display:"flex",justifyContent:["right","top-right"].includes(e.value.style.labels.name.position)?"flex-end":["top-center"].includes(e.value.style.labels.name.position)?"center":"flex-start",alignItems:"center",width:e.value.style.labels.name.width,color:e.value.style.labels.name.color,fontSize:e.value.style.labels.fontSize+"px",fontWeight:e.value.style.labels.name.bold?"bold":"normal",flexWrap:"wrap"})},[o(x)?(i(),u("div",{key:0,class:"vue-ui-sparkbar-skeleton-name",style:p({width:"60px",height:e.value.style.labels.fontSize+"px",borderRadius:e.value.style.labels.fontSize/4+"px",display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"5px"})},[v("div",{style:p({height:"100%",width:"40px",borderRadius:e.value.style.labels.fontSize/4+"px",backgroundColor:"#6A6A6A80"})},null,4),v("div",{style:p({height:"100%",width:"15px",borderRadius:e.value.style.labels.fontSize/4+"px",backgroundColor:"#6A6A6A80"})},null,4)],4)):(i(),u(V,{key:1},[v("span",null,f(a.name),1),e.value.style.labels.value.show?(i(),u("span",{key:0,style:p("font-weight:".concat(e.value.style.labels.value.bold?"bold":"normal"))},": "+f(o(C)(a.formatter,a.value,o(_)({p:a.prefix||"",v:a.value,s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r})),5)):c("",!0),e.value.style.layout.showTargetValue?(i(),u("span",we,f(" "+e.value.style.layout.targetValueText)+" "+f(o(C)(a.formatter,g(a),o(_)({p:a.prefix||"",v:g(a),s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r})),1)):c("",!0)],64))],4)):c("",!0),(i(),u("svg",{xmlns:o(fe),viewBox:"0 0 ".concat(n.value.width," ").concat(n.value.height),width:"100%"},[re(o(G)),v("defs",null,[v("linearGradient",{x1:"0%",y1:"0%",x2:"100%",y2:"0%",id:"sparkbar_gradient_".concat(r,"_").concat(D.value)},[v("stop",{offset:"0%","stop-color":o(I)(o(me)(a.color,.03),100-e.value.style.bar.gradient.intensity)},null,8,_e),v("stop",{offset:"100%","stop-color":a.color},null,8,Se)],8,Ce)]),v("rect",{height:n.value.height,width:n.value.width,x:0,y:0,fill:o(I)(e.value.style.gutter.backgroundColor,e.value.style.gutter.opacity),rx:n.value.height/2},null,8,$e),v("rect",{height:n.value.height,width:n.value.width*O(a),x:0,y:0,fill:e.value.style.bar.gradient.underlayerColor,rx:n.value.height/2},null,8,Ie),v("rect",{height:n.value.height,width:n.value.width*O(a),x:0,y:0,fill:e.value.style.bar.gradient.show?"url(#sparkbar_gradient_".concat(r,"_").concat(D.value,")"):a.color,rx:n.value.height/2},null,8,De)],8,Ae))],44,ke))),256)),t.$slots.source?(i(),u("div",ze,[$(t.$slots,"source")],512)):c("",!0),o(x)?(i(),ae(xe,{key:3})):c("",!0)],4))}};export{Me as default};
