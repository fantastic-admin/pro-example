
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as L,g as f,M as R,a1 as _,bt as T,bu as U,c as M,o as v,n as W,a as S,b as D,R as x,S as G,O as H,N,ad as J,ao as Q}from"./index-Bnionyve.js";import{r as X,I as Y}from"./item-B68YLLh5.js";import{_ as Z}from"./sub.vue_vue_type_script_setup_true_lang-C2XQaksz.js";const ae=L({name:"MainMenu",__name:"index",props:{menu:{},value:{},accordion:{type:Boolean,default:!0},defaultOpeneds:{default:()=>[]},alwaysOpeneds:{default:()=>[]},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1},dark:{type:Boolean,default:!1},direction:{default:"ltr"}},setup(B){const l=B,w=new WeakMap;function d(e){return w.has(e)||w.set(e,J()),w.get(e)}const t=f(l.value),o=f({}),c=f({}),s=f(Array.from(new Set([...l.alwaysOpeneds.slice(0),...l.defaultOpeneds.slice(0)]))),g=f(l.alwaysOpeneds.slice(0)),$=f([]),I=R(()=>l.mode==="horizontal"||l.mode==="vertical"&&l.collapse);function P(e,n=[]){e.forEach(a=>{var p,h;const u=(p=a.path)!=null?p:d(a);if((h=a.children)!=null&&h.some(i=>{var m;return((m=i.meta)==null?void 0:m.menu)!==!1})){const i=[...n,u];c.value[u]={index:u,indexPath:i,active:!1},P(a.children,i)}else o.value[u]={index:u,indexPath:n}})}const C=(e,n)=>{s.value.includes(e)||(l.accordion&&(s.value=s.value.filter(a=>n.includes(a)||g.value.includes(a))),s.value.push(e))},y=e=>{if(Array.isArray(e)){Q(()=>{y(e.at(-1)),e.length>1&&y(e.slice(0,-1))});return}s.value=s.value.filter(n=>n!==e)};function b(e){var n,a;for(const u in c.value)c.value[u].active=!1;(n=c.value[e])==null||n.indexPath.forEach(u=>{c.value[u].active=!0}),(a=o.value[e])==null||a.indexPath.forEach(u=>{c.value[u].active=!0})}const E=e=>{(l.mode==="horizontal"||l.collapse)&&(s.value=[]),b(e)},F=(e,n)=>{s.value.includes(e)?y(e):C(e,n)};function O(){const e=t.value&&o.value[t.value];b(t.value),!(!e||I.value||l.collapse)&&e.indexPath.forEach(n=>{const a=c.value[n];a&&C(n,a.indexPath)})}return _(()=>l.menu,e=>{P(e),O()},{deep:!0,immediate:!0}),_(()=>l.value,e=>{o.value[e]||(t.value="");const n=o.value[e]||t.value&&o.value[t.value]||o.value[l.value];n?t.value=n.index:t.value=e,O()}),_(()=>l.collapse,e=>{e?s.value=[]:s.value=l.alwaysOpeneds.slice(0),O()}),T(X,U({props:l,getUseId:d,items:o,subMenus:c,activeIndex:t,openedMenus:s,alwaysOpenedsMenus:g,mouseInMenu:$,isMenuPopup:I,openMenu:C,closeMenu:y,handleMenuItemClick:E,handleSubMenuClick:F})),(e,n)=>(v(),M("div",{class:W(S(D)("h-full w-full flex flex-col of-hidden transition-all-300",{"flex-row w-auto":S(I)&&l.mode==="horizontal","py-1":l.mode==="vertical"}))},[(v(!0),M(x,null,G(B.menu,a=>{var u,p,h,i,m,q;return v(),M(x,{key:(u=a.path)!=null?u:d(a)},[((p=a.meta)==null?void 0:p.menu)!==!1?(v(),M(x,{key:0},[(h=a.children)!=null&&h.length?(v(),N(Z,{key:0,menu:a,"unique-key":[(i=a.path)!=null?i:a.children.every(k=>{var r;return((r=k.meta)==null?void 0:r.menu)===!1})?a.children[0].path:d(a)]},null,8,["menu","unique-key"])):(v(),N(Y,{key:1,item:a,"unique-key":[(q=a.path)!=null?q:(m=a.children)!=null&&m.every(k=>{var r;return((r=k.meta)==null?void 0:r.menu)===!1})?a.children[0].path:d(a)],onClick:k=>{var r,z;return E((z=a.path)!=null?z:(r=a.children)!=null&&r.every(K=>{var A;return((A=K.meta)==null?void 0:A.menu)===!1})?a.children[0].path:d(a))}},null,8,["item","unique-key","onClick"]))],64)):H("",!0)],64)}),128))],2))}});export{ae as _};
