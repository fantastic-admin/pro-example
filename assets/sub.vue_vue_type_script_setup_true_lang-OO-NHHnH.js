
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as F,ac as x,bz as U,M as R,a4 as N,c as g,o as r,R as y,k as q,N as p,O as k,a as d,bm as P,T as z,B as A,a_ as L,m as H,w as V,x as j,be as D,n as O,l as G,S as I,a8 as B,ao as J}from"./index-Bnionyve.js";import{r as Q,I as X}from"./item-w-j_qmtO.js";const Y={class:"columns-3 p-2 px-3 2xl:columns-4"},ee=F({name:"SubMenu",__name:"sub",props:{uniqueKey:{},menu:{},level:{default:0}},setup(s){var C;const u=s,M=x("itemRef"),b=x("subMenuRef"),n=U(Q),v=(C=u.menu.path)!=null?C:n.getUseId(u.menu),K=R(()=>n.openedMenus.includes(u.uniqueKey.at(-1))),T={enter(e){e.offsetHeight>window.innerHeight&&(e.style.height="".concat(window.innerHeight,"px"))},afterEnter:()=>{},beforeLeave:e=>{e.style.overflow="hidden",e.style.maxHeight="".concat(e.offsetHeight,"px")},leave:e=>{e.style.maxHeight="0"},afterLeave(e){e.style.overflow="",e.style.maxHeight=""}},E={enterActiveClass:"ease-in-out duration-300",enterFromClass:"opacity-0 translate-x-4",enterToClass:"opacity-100",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},m=R(()=>{var e,t;return(t=(e=u.menu.children)==null?void 0:e.some(i=>{var a;return((a=i.meta)==null?void 0:a.menu)!==!1}))!=null?t:!1});function S(){var e,t;m.value||(e=u.menu.meta)!=null&&e.link||(t=u.menu.meta)!=null&&t.newWindow||n.handleMenuItemClick(v)}let o;function W(){u.level===0&&(n.mouseInMenu=u.uniqueKey,o==null||o(),{stop:o}=B(()=>{if(m.value)n.openMenu(v),J(()=>{var l,c;const e=(l=M.value)==null?void 0:l.ref,t=(c=b.value)==null?void 0:c.$el;if(!e||!t)return;let i=0,a=0;n.props.mode==="vertical"||u.level!==0?(i=e.getBoundingClientRect().top+e.scrollTop,a=(n.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right)+e.getBoundingClientRect().width,i+t.offsetHeight>window.innerHeight&&(i=window.innerHeight-t.offsetHeight)):(i=e.getBoundingClientRect().top+e.getBoundingClientRect().height,a=n.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right,i+t.offsetHeight>window.innerHeight&&(t.style.height="".concat(window.innerHeight-i,"px")),a+t.offsetWidth>document.documentElement.clientWidth&&(a=document.documentElement.clientWidth-t.offsetWidth)),t.style.top="".concat(i,"px"),t.style.insetInlineStart="".concat(a,"px")});else{const e=u.menu.children?n.subMenus[v].indexPath.at(-1):n.items[v].indexPath.at(-1);n.openMenu(e)}},300))}function w(){u.level===0&&(n.mouseInMenu=[],o==null||o(),{stop:o}=B(()=>{n.mouseInMenu.length===0?n.closeMenu(u.uniqueKey):m.value&&!n.mouseInMenu.includes(u.uniqueKey.at(-1))&&n.closeMenu(u.uniqueKey.at(-1))},300))}function $(){o==null||o()}return(e,t)=>{const i=N("SubMenu"),a=D;return r(),g(y,null,[q(X,{ref_key:"itemRef",ref:M,"unique-key":s.uniqueKey,item:s.menu,level:s.level,"sub-menu":d(m),onClick:S,onMouseenter:W,onMouseleave:w},null,8,["unique-key","item","level","sub-menu"]),d(m)?(r(),p(P,{key:0,to:"body",disabled:s.level!==0},[s.level===0?(r(),p(z,A({key:0},E,L(T)),{default:H(()=>[V(q(a,{ref_key:"subMenuRef",ref:b,mask:"",class:O(["sub-menu z-3000 w-150 border rounded-lg bg-[var(--g-sub-sidebar-bg)] shadow-xl fixed! 2xl:w-200",{dark:d(n).props.dark}]),onMouseenter:$,onMouseleave:w},{default:H(()=>[G("div",Y,[(r(!0),g(y,null,I(s.menu.children,l=>{var c,f,h;return r(),g("div",{key:(c=l.path)!=null?c:d(n).getUseId(l),class:"w-full break-inside-avoid"},[((f=l.meta)==null?void 0:f.menu)!==!1?(r(),p(i,{key:0,"unique-key":[...s.uniqueKey,(h=l.path)!=null?h:d(n).getUseId(l)],menu:l,level:s.level+1},null,8,["unique-key","menu","level"])):k("",!0)])}),128))])]),_:1},8,["class"]),[[j,d(K)]])]),_:1},16)):(r(!0),g(y,{key:1},I(s.menu.children,l=>{var c,f,h;return r(),g(y,{key:(c=l.path)!=null?c:d(n).getUseId(l)},[((f=l.meta)==null?void 0:f.menu)!==!1?(r(),p(i,{key:0,"unique-key":[...s.uniqueKey,(h=l.path)!=null?h:d(n).getUseId(l)],menu:l,level:s.level+1},null,8,["unique-key","menu","level"])):k("",!0)],64)}),128))],8,["disabled"])):k("",!0)],64)}}});export{ee as _};
