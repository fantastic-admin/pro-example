
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-By5ZZJ0U-vEde17m7.js","./index-H6QnEWHf.js","./index-BDMvhiMS.css"])))=>i.map(i=>d[i]);
import{n as f,aB as Ce,x as n,N as Z,C as U,a7 as $e,c as s,o as r,b as c,l as Ae,e as i,g as we,f as F,aC as Le,M as X,t as K,a4 as xe,aH as _e}from"./index-H6QnEWHf.js";import{s as Ne,J as Te,x as Se,ag as Y,E as J,A as Fe,c as A,ah as ze,d as Be,w as P,Q as ee,F as le,L as Ee}from"./vue-data-ui-3mUtIY8T.js";import{E as Me,M as je}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{s as De,i as q}from"./useNestedProp-DaR1dBmj-DbQzF8J-.js";import{T as Oe,j as Ve}from"./BaseScanner-BMpwQAfz-CIrlPhSG.js";import{k as Ie}from"./useFitSvgText-2crs6Fv5-B9kk6-lf.js";import{i as Ze}from"./useThemeCheck-DGJ31Vi5-CGxdxkCJ.js";import"./alert-yicQvtMn.js";import"./command.vue_vue_type_script_setup_true_lang-Diw_3237.js";import"./index.vue_vue_type_script_setup_true_lang-ByxJxKu_.js";const ae={style:{backgroundColor:"#1A1A1A",dataLabel:{color:"#CCCCCC"},trendLabel:{color:"#CCCCCC"}}},te={style:{backgroundColor:"#FFF8E1",line:{smooth:!1},dataLabel:{color:"#424242"},trendLabel:{color:"#424242"}}},oe={style:{backgroundColor:"#1E1E1E",line:{smooth:!1},dataLabel:{color:"#BDBDBD"},trendLabel:{color:"#BDBDBD"}}},ue={style:{backgroundColor:"#1A1A1A",line:{stroke:"#00FF00",smooth:!1},dataLabel:{color:"#AACCAA"},trendLabel:{color:"#99CC99"},arrow:{colors:{positive:"#66CC66",negative:"#196619"}}}},ne={style:{backgroundColor:"#fbfafa",line:{stroke:"#B9B99D"},dataLabel:{color:"#8A9892"},trendLabel:{color:"#99CC99"},arrow:{colors:{positive:"#B9B99D",negative:"#C09E85",neutral:"#A5AFC1"}}}},re={style:{backgroundColor:"#f6f6fb",line:{stroke:"#4A6A75"},dataLabel:{color:"#61747E"},trendLabel:{color:"#8A9892"},arrow:{colors:{positive:"#4A6A75",negative:"#C09E85",neutral:"#ABB1BC"}}}},se={default:{},dark:ae,celebration:te,celebrationNight:oe,hack:ue,zen:ne,concrete:re},gl=Object.freeze(Object.defineProperty({__proto__:null,celebration:te,celebrationNight:oe,concrete:re,dark:ae,default:se,hack:ue,zen:ne},Symbol.toStringTag,{value:"Module"})),Je=["id"],Pe=["xmlns","viewBox"],qe=["width","height"],Ge=["id"],Re=["stop-color"],We=["stop-color"],He={key:1},Qe=["d","fill"],Ue=["d","fill"],Xe=["d","stroke","stroke-width","stroke-linecap","stroke-linejoin"],Ke=["d","stroke","stroke-width","stroke-linecap","stroke-linejoin"],Ye=["d"],el=["fill","d"],ll=["x","y","width","height"],al=["x","y","fill","font-size","font-weight"],tl=["stroke","cx","cy","fill"],ol=["x","y","font-size","fill","font-weight"],ul={__name:"vue-ui-spark-trend",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},setup(ie){const ve=Le(()=>_e(()=>import("./PackageVersion-By5ZZJ0U-vEde17m7.js"),__vite__mapDeps([0,1,2]),import.meta.url)),{vue_ui_spark_trend:de}=De(),{isThemeValid:fe,warnInvalidTheme:ye}=Ze(),h=ie,z=f(null),G=f(null),R=f(null),w=f(null),x=f(null),_=f(!1),p=f(null),L=f(Te()),e=f(M()),{loading:C,FINAL_DATASET:B,manualLoading:E}=Oe({...Ce(h),FINAL_CONFIG:e,prepareConfig:M,skeletonDataset:[1,2,3,5,8,13,21,34,55,89,144,233],skeletonConfig:Se({defaultConfig:e.value,userConfig:{style:{animation:{show:!1},backgroundColor:"#99999930",line:{stroke:"#6A6A6A",useColorTrend:!1},dataLabel:{show:!1,useColorTrend:!1,color:"#6A6A6A"}}}})});function M(){const l=q({userConfig:h.config,defaultConfig:de}),a=l.theme;if(!a)return l;if(!fe.value(l))return ye(l),l;const u=q({userConfig:se[a]||h.config,defaultConfig:l});return q({userConfig:h.config,defaultConfig:u})}const g=n(()=>Y({data:B.value,threshold:e.value.downsample.threshold}));Z(()=>h.config,l=>{e.value=M(),O.value=e.value.style.width,$.value=e.value.style.height,W()},{deep:!0});function j(l){return l.map(a=>A(a))}const b=f(Y({data:B.value,threshold:e.value.downsample.threshold}).map(l=>e.value.style.animation.show||[void 0,1/0,-1/0,null,NaN].includes(l)?null:l));Z(g,l=>{p.value&&(cancelAnimationFrame(p.value),p.value=null),e.value.style.animation.show?b.value=Array(l.length).fill(null):b.value=l.map(a=>![void 0,1/0,-1/0,null].includes(a)&&!Number.isNaN(a)?a:null),D(),U(()=>S(".vue-ui-sparktrend-progress-label",6))},{deep:!0,immediate:!0}),Z(()=>JSON.stringify(h.dataset),()=>{p.value&&(cancelAnimationFrame(p.value),p.value=null),E.value=J(h.dataset);const l=g.value;b.value=e.value.style.animation.show?Array(l.length).fill(null):l.map(a=>Number.isFinite(a)?a:null),D(),U(()=>S(".vue-ui-sparktrend-progress-label",6))},{deep:!1,immediate:!0});function D(){let l=1e3/e.value.style.animation.animationFrames,a=performance.now();if(!C.value&&e.value.style.animation.show&&e.value.style.animation.animationFrames&&B.value.length>1){let u=function(){_.value=!0;let k=performance.now(),Q=k-a;Q>l?(a=k-Q%l,y<g.value.length?(b.value.push(g.value[y]),y+=1,p.value=requestAnimationFrame(u)):(cancelAnimationFrame(p.value),b.value=j(g.value),_.value=!1,S(".vue-ui-sparktrend-progress-label",6))):p.value=requestAnimationFrame(u)};b.value=[];let y=0;u()}}$e(()=>{W()});const ce=n(()=>e.value.debug);function W(){if(J(h.dataset)&&(Fe({componentName:"VueUiSparkTrend",type:"dataset",debug:ce.value}),E.value=!0),J(h.dataset)||(E.value=!1),e.value.responsive){const l=Me(()=>{const{width:a,height:u}=je({chart:z.value,source:R.value});requestAnimationFrame(()=>{O.value=a,$.value=u})});w.value&&(x.value&&w.value.unobserve(x.value),w.value.disconnect()),w.value=new ResizeObserver(l),x.value=z.value.parentNode,w.value.observe(x.value)}D(),S(".vue-ui-sparktrend-progress-label",6)}const O=f(e.value.style.width),$=f(e.value.style.height),v=n(()=>({height:$.value,width:O.value})),o=n(()=>({top:e.value.style.padding.top,left:e.value.style.padding.left,right:v.value.width-e.value.style.padding.right,bottom:v.value.height-e.value.style.padding.bottom,height:v.value.height-(e.value.style.padding.top+e.value.style.padding.bottom)-(e.value.style.dataLabel.show?e.value.style.dataLabel.fontSize:0),width:v.value.width-(e.value.style.padding.left+e.value.style.padding.right)})),V=n(()=>{const l=j(g.value).filter(Number.isFinite);if(!l.length)return{max:0,min:0};let a=l[0],u=l[0];for(let y=1;y<l.length;y++){const k=l[y];k>a&&(a=k),k<u&&(u=k)}return{max:a,min:u}}),he=n(()=>{const l=g.value,a=l.length?l[l.length-1]:"x";return[L.value,l.length,Number.isFinite(a)?a:"x",e.value.downsample.threshold,e.value.style.line.smooth?"s":"l"].join("-")}),N=n(()=>{const l=V.value.min>=0?0:V.value.min;return Math.abs(l)}),pe=n(()=>V.value.max+N.value);function H(l){return l/pe.value}const ge=n(()=>g.value.length),t=n(()=>b.value.map((l,a)=>{const u=isNaN(l)||[void 0,null,"NaN",NaN,1/0,-1/0].includes(l)?0:l||0;return{value:A(l),absoluteValue:A(u),plotValue:A(u+N.value),toMax:H(u+N.value),x:o.value.left+A(a*(o.value.width/(ge.value-1)))-e.value.style.padding.right,y:o.value.bottom-A(o.value.height*H(u+N.value))}})),T=n(()=>{const l=j(g.value);return e.value.style.trendLabel.trendType==="global"?ze(l):e.value.style.trendLabel.trendType==="n-1"&&l.length>1?(l.at(-1)/l.at(-2)-1)*100:e.value.style.trendLabel.trendType==="lastToFirst"?(l.at(-1)/l[0]-1)*100:0}),I=n(()=>_.value||T.value===0?"neutral":T.value>0?"positive":"negative"),m=n(()=>e.value.style.arrow.colors[I.value]),me=n(()=>{const l={x:t.value[0].x,y:v.value.height-6},a={x:t.value[t.value.length-1].x,y:v.value.height-6},u=[];return t.value.forEach(y=>{u.push("".concat(y.x,",").concat(y.y," "))}),[l.x,l.y,...u,a.x,a.y].toString()}),be=n(()=>{let l=[];return t.value.forEach(a=>{l.push("".concat(a.x,",").concat(a.y," "))}),"M ".concat(l.toString())}),d=n(()=>$.value/2-e.value.style.trendLabel.fontSize),ke=n(()=>o.value.left*.8),{fitText:S}=Ie({svgRef:G,unitWidth:ke,fontSize:e.value.style.trendLabel.fontSize});return(l,a)=>(r(),s("div",{ref_key:"sparkTrendChart",ref:z,class:"vue-data-ui-component vue-ui-spark-trend",id:L.value,style:xe("width:100%;font-family:".concat(e.value.style.fontFamily,";background:").concat(e.value.style.backgroundColor))},[(r(),s("svg",{key:he.value,ref_key:"svgRef",ref:G,xmlns:i(Be),viewBox:"0 0 ".concat(v.value.width," ").concat(v.value.height),style:"width:100%;background:transparent;overflow:visible"},[we(i(ve)),l.$slots["chart-background"]?(r(),s("foreignObject",{key:0,x:0,y:0,width:v.value.width<=0?10:v.value.width,height:v.value.height<=0?10:v.value.height,style:{pointerEvents:"none"}},[X(l.$slots,"chart-background",{},void 0,!0)],8,qe)):c("",!0),F("defs",null,[F("linearGradient",{x1:"0%",y1:"0%",x2:"0%",y2:"100%",id:"pill_gradient_".concat(L.value)},[F("stop",{offset:"0%","stop-color":i(P)(e.value.style.line.useColorTrend?m.value:e.value.style.line.stroke,e.value.style.area.opacity)},null,8,Re),F("stop",{offset:"100%","stop-color":e.value.style.backgroundColor},null,8,We)],8,Ge)]),e.value.style.area.show&&t.value[0]?(r(),s("g",He,[e.value.style.line.smooth?(r(),s("path",{key:0,d:"M ".concat(t.value[0].x,",").concat(o.value.bottom," ").concat(i(ee)(t.value)," L ").concat(t.value.at(-1).x,",").concat(o.value.bottom," Z"),fill:e.value.style.area.useGradient?"url(#pill_gradient_".concat(L.value,")"):i(P)(e.value.style.line.useColorTrend?m.value:e.value.style.line.stroke,e.value.style.area.opacity),stroke:"none"},null,8,Qe)):(r(),s("path",{key:1,d:"M".concat(me.value,"Z"),fill:e.value.style.area.useGradient?"url(#pill_gradient_".concat(L.value,")"):i(P)(e.value.style.line.useColorTrend?m.value:e.value.style.line.stroke,e.value.style.area.opacity),stroke:"none"},null,8,Ue))])):c("",!0),e.value.style.line.smooth&&t.value.length?(r(),s("path",{key:2,d:"M ".concat(i(ee)(t.value)),stroke:e.value.style.line.useColorTrend?m.value:e.value.style.line.stroke,fill:"none","stroke-width":e.value.style.line.strokeWidth,"stroke-linecap":e.value.style.line.strokeLinecap,"stroke-linejoin":e.value.style.line.strokeLinejoin},null,8,Xe)):c("",!0),!e.value.style.line.smooth&&t.value.length?(r(),s("path",{key:3,d:be.value,stroke:e.value.style.line.useColorTrend?m.value:e.value.style.line.stroke,fill:"none","stroke-width":e.value.style.line.strokeWidth,"stroke-linecap":e.value.style.line.strokeLinecap,"stroke-linejoin":e.value.style.line.strokeLinejoin},null,8,Ke)):c("",!0),i(C)?(r(),s("path",{key:4,fill:"#6A6A6A",d:"M ".concat(o.value.left/2+6,", ").concat(d.value+7," ").concat(o.value.left/2-7,", ").concat(d.value," ").concat(o.value.left/2-7,", ").concat(d.value+14," Z")},null,8,Ye)):(r(),s("path",{key:5,fill:m.value,d:I.value==="positive"?"M ".concat(o.value.left/2,", ").concat(d.value," ").concat(o.value.left/2-7,", ").concat(d.value+12," ").concat(o.value.left/2+7,", ").concat(d.value+12," Z"):I.value==="negative"?"M ".concat(o.value.left/2,", ").concat(d.value+12," ").concat(o.value.left/2-7,", ").concat(d.value," ").concat(o.value.left/2+7,", ").concat(d.value," Z"):"M ".concat(o.value.left/2+6,", ").concat(d.value+7," ").concat(o.value.left/2-7,", ").concat(d.value," ").concat(o.value.left/2-7,", ").concat(d.value+14," Z")},null,8,el)),i(C)?(r(),s("rect",{key:6,x:o.value.left/2-e.value.style.trendLabel.fontSize-2,y:$.value/2+e.value.style.trendLabel.fontSize-2,width:e.value.style.trendLabel.fontSize*2,height:e.value.style.trendLabel.fontSize,fill:"#6A6A6A80",rx:"3"},null,8,ll)):c("",!0),!_.value&&!i(C)?(r(),s("text",{key:7,class:"vue-ui-sparktrend-progress-label",x:o.value.left/2,y:$.value/2+e.value.style.trendLabel.fontSize*2,"text-anchor":"middle",fill:e.value.style.trendLabel.useColorTrend?m.value:e.value.style.trendLabel.color,"font-size":e.value.style.trendLabel.fontSize,"font-weight":e.value.style.trendLabel.bold?"bold":"normal"},K(i(le)({p:T.value>0?"+":"",v:T.value,s:"%",r:e.value.style.trendLabel.rounding})),9,al)):c("",!0),t.value.length&&t.value.at(-1).x!==void 0?(r(),s("circle",{key:8,stroke:e.value.style.backgroundColor,"stroke-width":2,cx:t.value.at(-1).x,cy:t.value.at(-1).y,r:4,fill:i(C)?"#6A6A6A":m.value},null,8,tl)):c("",!0),t.value.length&&t.value.at(-1).x!==void 0&&e.value.style.dataLabel.show?(r(),s("text",{key:9,"text-anchor":"middle",x:t.value.at(-1).x,y:t.value.at(-1).y-e.value.style.dataLabel.fontSize/1.5,"font-size":e.value.style.dataLabel.fontSize,fill:e.value.style.dataLabel.useColorTrend?m.value:e.value.style.dataLabel.color,"font-weight":e.value.style.dataLabel.bold?"bold":"normal"},K(i(Ee)(e.value.style.dataLabel.formatter,t.value.at(-1).value,i(le)({p:e.value.style.dataLabel.prefix,v:t.value.at(-1).value,s:e.value.style.dataLabel.suffix,r:e.value.style.dataLabel.rounding}),{datapoint:t.value.at(-1)})),9,ol)):c("",!0)],8,Pe)),l.$slots.source?(r(),s("div",{key:0,ref_key:"source",ref:R,dir:"auto"},[X(l.$slots,"source",{},void 0,!0)],512)):c("",!0),i(C)?(r(),Ae(Ve,{key:1})):c("",!0)],12,Je))}},nl=Ne(ul,[["__scopeId","data-v-74429f5b"]]),ml=Object.freeze(Object.defineProperty({__proto__:null,default:nl},Symbol.toStringTag,{value:"Module"}));export{gl as a,ml as b,nl as v};
