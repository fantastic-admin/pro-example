
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{g as m,a3 as _,ca as F,d as R,M as C,Z as Y,N as D,o as P,a as x,aq as $,U as O,n as T,b as J,m as b,l as z,r as W,b9 as X}from"./index-Bnionyve.js";function K(){const l=m(null),s=new Proxy(l,{get(c,e){if(typeof e=="string"||typeof e=="symbol")return e==="current"?Reflect.get(c,"value"):Reflect.get(c,e)},set(c,e,u){return e==="value"?Reflect.set(c,e,(u==null?void 0:u.$el)||u):e==="animations"?Reflect.set(c,e,u):!0}});s.animations=[];const o=F(s);return _(()=>{s.animations.forEach(c=>c.stop())}),[s,o]}const V=["width","height"],k="url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIj4KICA8Y2lyY2xlIGN4PSIxNiIgY3k9IjE2IiByPSIxNSIgc3R5bGU9ImZpbGw6I2ZmZjtzdHJva2U6IzAwMDtzdHJva2Utd2lkdGg6MXB4OyIgLz4KPC9zdmc+'), auto",q=R({name:"FaScratchOff",__name:"index",props:{width:{},height:{},minScratchPercentage:{default:50},gradientColors:{default:()=>["#A97CF8","#F38CB8","#FDCC92"]},class:{}},emits:["complete"],setup(l,{emit:s}){const o=l,c=s,e=m(),u=C(()=>"".concat(o.width,"px")),A=C(()=>"".concat(o.height,"px")),n=m(),i=m(!1),M=m(!1);function B(){i.value=!0}function H(){i.value=!0}const r=C(()=>{var t;return((t=e.value)==null?void 0:t.width)||o.width}),d=C(()=>{var t;return((t=e.value)==null?void 0:t.height)||o.height});function Z(t){n.value=t.value.getContext("2d"),n.value.fillStyle="#ccc",n.value.fillRect(0,0,r.value,d.value);const a=n.value.createLinearGradient(0,0,r.value,d.value);a.addColorStop(0,o.gradientColors[0]),a.addColorStop(.5,o.gradientColors[1]),a.addColorStop(1,o.gradientColors[2]),n.value.fillStyle=a,n.value.fillRect(0,0,r.value,d.value)}function E(t,a){if(e.value&&n.value){const g=e.value.getBoundingClientRect(),p=t-g.left+16,y=a-g.top+16;n.value.globalCompositeOperation="destination-out",n.value.beginPath(),n.value.arc(p,y,30,0,Math.PI*2),n.value.fill()}}function v(t){i.value&&E(t.clientX,t.clientY)}function f(t){if(!i.value)return;const a=t.touches[0];E(a.clientX,a.clientY)}function L(){i.value=!1,S()}function h(){i.value=!1,S()}function G(){document.addEventListener("mousedown",v),document.addEventListener("mousemove",v),document.addEventListener("touchstart",f),document.addEventListener("touchmove",f),document.addEventListener("mouseup",L),document.addEventListener("touchend",h),document.addEventListener("touchcancel",h)}function S(){if(!M.value&&e.value&&n.value){const a=n.value.getImageData(0,0,r.value,d.value).data,g=a.length/4;let p=0;for(let w=3;w<a.length;w+=4)a[w]===0&&p++;p/g*100>=o.minScratchPercentage?(M.value=!0,n.value.clearRect(0,0,r.value,d.value),U()):i.value=!1}}const[I,N]=K();async function U(){I.value&&(N(I.value,{scale:1,rotate:[0,10,-10,10,-10,0]}),c("complete"))}Y(()=>{e.value&&(Z(e),G())});function j(){document.removeEventListener("mousedown",v),document.removeEventListener("mousemove",v),document.removeEventListener("touchstart",f),document.removeEventListener("touchmove",f),document.removeEventListener("mouseup",L),document.removeEventListener("touchend",h),document.removeEventListener("touchcancel",h)}return _(()=>{j()}),(t,a)=>(P(),D(x($),{ref_key:"containerRef",ref:I,class:T(x(J)("relative select-none",o.class)),style:O({width:x(u),height:x(A),cursor:k}),initial:{scale:1,rotate:[0,10,-10,10,-10,0]},transition:{duration:.5}},{default:b(()=>[z("canvas",{ref_key:"canvasRef",ref:e,width:l.width,height:l.height,class:"absolute left-0 top-0",onMousedown:B,onTouchstart:H},null,40,V),W(t.$slots,"default")]),_:3},8,["class","style"]))}}),ee=R({__name:"_demo1",setup(l){function s(){X.success("恭喜你刮中了")}return(o,c)=>{const e=q;return P(),D(e,{width:250,height:250,"min-scratch-percentage":30,class:"flex items-center justify-center overflow-hidden border-2 rounded-2xl bg-gray-100",onComplete:s},{default:b(()=>[...c[0]||(c[0]=[z("div",{class:"text-8xl"}," 🥳 ",-1)])]),_:1})}}});export{ee as _};
