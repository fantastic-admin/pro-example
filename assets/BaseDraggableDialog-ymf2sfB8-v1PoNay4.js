
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{g as S,bu as P,M as _,Z as F,N as V,a3 as I,o as y,c as Y,O as U,l as a,aF as d,a as Z,r as L,k as j,U as B,n as R,bm as q,ao as A}from"./index-Bnionyve.js";import{s as G,y as J,u as K}from"./vue-data-ui-DO-nR8BN.js";import"./alert-Vqv_sKXu.js";import"./command.vue_vue_type_script_setup_true_lang-BupUAzs5.js";import"./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js";const Q=["xmlns"],ee={class:"modal-title"},te={class:"draggable-dialog-actions"},ne={__name:"BaseDraggableDialog",props:{backgroundColor:{type:String},color:{type:String},headerBg:{type:String},headerColor:{type:String},fullscreenParent:{type:HTMLElement},isFullscreen:{type:Boolean,default:!1},withPadding:{type:Boolean,default:!1},forcedWidth:{type:Number,default:400}},emits:["close"],setup(r,{expose:H,emit:X}){const f=r,$=X,g=S(!1),E=S(!1),z=S(0);function w(){z.value+=1}const e=P({left:window.innerWidth/2-200,top:window.innerHeight/2-120,width:f.forcedWidth,height:400,dragging:!1,resizing:!1,dragOffsetX:0,dragOffsetY:0,pointerStartX:0,pointerStartY:0,resizeStartW:0,resizeStartH:0});function D(){g.value=!0,A(()=>{E.value||(e.left=Math.max(0,window.innerWidth/2-e.width/2),e.top=Math.max(0,window.innerHeight/2-e.height/2),E.value=!0)})}function x(){g.value=!1,$("close")}H({open:D,close:x});const O=_(()=>({position:"fixed",left:"".concat(e.left,"px"),top:"".concat(e.top,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),padding:0,border:"none",background:f.backgroundColor,boxShadow:"0 4px 24px rgba(0,0,0,0.15)",zIndex:9999,overflow:"visible",borderRadius:"2px","--dlg-color":f.color}));function l(t){return t.touches&&t.touches.length?{x:t.touches[0].clientX,y:t.touches[0].clientY}:{x:t.clientX,y:t.clientY}}function M(t){var o;(o=t.preventDefault)==null||o.call(t),w(),e.dragging=!0;const n=l(t);e.dragOffsetX=n.x-e.left,e.dragOffsetY=n.y-e.top,document.addEventListener("mousemove",h),document.addEventListener("mouseup",u),document.addEventListener("touchmove",h,{passive:!1}),document.addEventListener("touchend",u)}function h(t){var s;if(!e.dragging)return;(s=t.preventDefault)==null||s.call(t);const n=l(t);let o=n.x-e.dragOffsetX,i=n.y-e.dragOffsetY;o=Math.max(0,Math.min(o,window.innerWidth-e.width)),i=Math.max(0,Math.min(i,window.innerHeight-e.height)),e.left=o,e.top=i}function u(){e.dragging=!1,document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",u),document.removeEventListener("touchmove",h),document.removeEventListener("touchend",u)}function k(t){var o;(o=t.preventDefault)==null||o.call(t),w(),e.resizing=!0;const n=l(t);e.pointerStartX=n.x,e.pointerStartY=n.y,e.resizeStartW=e.width,e.resizeStartH=e.height,document.addEventListener("mousemove",v),document.addEventListener("mouseup",c),document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",c)}function v(t){var s;if(!e.resizing)return;(s=t.preventDefault)==null||s.call(t);const n=l(t);let o=n.x-e.pointerStartX,i=n.y-e.pointerStartY;e.width=Math.max(240,e.resizeStartW+o),e.height=Math.max(400,e.resizeStartH+i)}function c(){e.resizing=!1,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",c),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",c)}function b(t){var o;(o=t.preventDefault)==null||o.call(t),w(),e.resizing=!0;const n=l(t);e.pointerStartX=n.x,e.pointerStartY=n.y,e.resizeStartW=e.width,e.resizeStartH=e.height,e.resizeStartLeft=e.left,e.resizeStartTop=e.top,document.addEventListener("mousemove",p),document.addEventListener("mouseup",m),document.addEventListener("touchmove",p,{passive:!1}),document.addEventListener("touchend",m)}function p(t){var W;if(!e.resizing)return;(W=t.preventDefault)==null||W.call(t);const n=l(t);let o=n.x-e.pointerStartX,i=Math.min(Math.max(0,e.resizeStartLeft+o),e.resizeStartLeft+e.resizeStartW-240),s=e.resizeStartW-(i-e.resizeStartLeft),T=n.y-e.pointerStartY,N=Math.max(400,e.resizeStartH+T);e.left=i,e.width=s,e.height=N}function m(){e.resizing=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",m),document.removeEventListener("touchmove",p),document.removeEventListener("touchend",m)}F(()=>{document.addEventListener("keydown",C)});function C(t){t.key&&t.key==="Escape"&&x()}return I(()=>{u(),c(),m(),document.removeEventListener("keydown",C)}),(t,n)=>(y(),V(q,{to:r.isFullscreen?r.fullscreenParent:"body",key:z.value},[g.value?(y(),Y("div",{key:0,class:"modal vue-ui-draggable-dialog",style:B(O.value),onClick:n[0]||(n[0]=d(()=>{},["stop"]))},[a("div",{class:"modal-header",style:B({backgroundColor:r.headerBg,color:r.headerColor})},[a("span",{class:"drag-handle",onMousedown:d(M,["stop","prevent"]),onTouchstart:d(M,["stop","prevent"])},[(y(),Y("svg",{xmlns:Z(J),width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},[...n[1]||(n[1]=[a("path",{d:"M5 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M5 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M12 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M12 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M19 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M19 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1)])],8,Q))],32),a("span",ee,[L(t.$slots,"title",{},void 0,!0)]),a("div",te,[L(t.$slots,"actions",{},void 0,!0),a("button",{class:"close",onClick:x},[j(K,{name:"close",stroke:r.headerColor},null,8,["stroke"])])])],4),a("div",{class:R({"modal-body":!r.withPadding,"modal-body-pad":r.withPadding})},[L(t.$slots,"content",{},void 0,!0)],2),a("div",{class:"resize-handle",onMousedown:d(k,["stop","prevent"]),onTouchstart:d(k,["stop","prevent"])},null,32),a("div",{class:"resize-handle resize-handle-left",onMousedown:d(b,["stop","prevent"]),onTouchstart:d(b,["stop","prevent"])},null,32)],4)):U("",!0)],8,["to"]))}},de=G(ne,[["__scopeId","data-v-1be15e28"]]);export{de as default};
