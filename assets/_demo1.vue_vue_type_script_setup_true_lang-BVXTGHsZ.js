
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as $,g as k,a1 as B,N as x,o,k as y,T as z,m as S,c as p,O as _,w as N,l as d,x as F,P as L,R as M,S as E,U as P,a,n as V,p as C,bm as j,H as A,G as I,b9 as w}from"./index-Bnionyve.js";const D={key:0,class:"fixed inset-0 z-5000 size-full flex items-center justify-center backdrop-blur-2xl"},R={class:"relative h-96"},G={class:"relative mx-auto mt-40 max-w-xl flex flex-col justify-start"},H={class:"flex flex-col"},O={key:0,class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},U=$({name:"FaMultiStepLoader",__name:"index",props:{loading:{type:Boolean,default:!1},steps:{},preventClose:{type:Boolean,default:!1}},emits:["stateChange","complete","close","error"],setup(i,{emit:l}){const m=i,f=l,e=k(0),c=k(!1),t=k({});async function r(n){if(typeof n.action=="function")try{const u=await n.action(t.value);return n.name&&(t.value[n.name]=u),!0}catch(u){return f("error",u,e.value),!1}return!0}async function b(){const n=m.steps[e.value];!n||!await r(n)||(e.value<m.steps.length-1?(e.value++,f("stateChange",e.value),v()):(c.value=!0,f("complete")))}async function v(){m.steps[e.value]&&await b()}function T(){f("close")}return B(()=>m.loading,n=>{n&&(e.value=0,c.value=!1,t.value={},v())}),(n,u)=>{const h=L;return o(),x(j,{to:"body"},[y(z,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-300","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:S(()=>[i.loading&&i.steps.length>0?(o(),p("div",D,[N(d("button",{class:"absolute right-4 top-4 z-5001 h-9 inline-flex items-center justify-center whitespace-nowrap rounded-md bg-primary px-3 text-sm text-primary-foreground font-medium ring-offset-background transition-colors disabled:pointer-events-none hover:bg-primary/90 disabled:opacity-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-ring",size:"sm",onClick:T},[y(h,{name:"i-heroicons:x-mark",class:"size-6"})],512),[[F,!i.preventClose]]),d("div",R,[d("div",G,[(o(!0),p(M,null,E(i.steps,(g,s)=>(o(),p("div",{key:s},[g?(o(),p("div",{key:0,class:"mb-4 flex items-center gap-2 text-left transition-all duration-300 ease-in-out",style:P({opacity:s===a(e)?1:Math.max(1-Math.abs(s-a(e))*.2,0),transform:"translateY(".concat(s===a(e)?-(a(e)*40):-(a(e)*40),"px)")})},[s<a(e)||s===i.steps.length-1&&s===a(e)&&a(c)?(o(),x(h,{key:0,name:"i-heroicons:check-circle-solid",class:"size-6 text-primary"})):s===a(e)&&(!a(c)||s!==i.steps.length-1)?(o(),x(h,{key:1,name:"i-heroicons:arrow-path",class:"size-6 animate-spin text-primary"})):(o(),x(h,{key:2,name:"i-heroicons:check-circle",class:"size-6 text-black opacity-50 dark:text-white"})),d("div",H,[d("span",{class:V(["text-lg text-black dark:text-white",[s>a(e)&&"opacity-50"]])},C(g.text),3),y(z,{"enter-active-class":"transition-all duration-300","enter-from-class":"opacity-0 -translate-y-1","enter-to-class":"opacity-100 translate-y-0"},{default:S(()=>[g.afterText&&(s<a(e)||s===i.steps.length-1&&s===a(e)&&a(c))?(o(),p("span",O,C(g.afterText),1)):_("",!0)]),_:2},1024)])],4)):_("",!0)]))),128))])]),u[0]||(u[0]=d("div",{class:"[mask-image:radial-gradient(900px_at_center,hsl(var(--primary))_30%,transparent)] absolute inset-x-0 bottom-0 z--1 h-full bg-white bg-gradient-to-t dark:bg-black"},null,-1))])):_("",!0)]),_:1})])}}}),Y={class:"flex gap-4"},J=$({__name:"_demo1",setup(i){const l=k(!1),m=[{text:"获取用户数据",afterText:"获取用户数据成功",name:"user",action:async()=>(await new Promise(t=>setTimeout(t,1e3)),{id:1,name:"张三"})},{text:"获取用户订单（这一步会模拟随机错误）",afterText:"获取用户订单成功",name:"orders",action:async t=>{if(await new Promise(r=>setTimeout(r,1500)),Math.random()>.5)throw new Error("获取订单数据失败：网络连接超时");return[{id:1,userId:t.user.id,product:"商品A"},{id:2,userId:t.user.id,product:"商品B"}]}},{text:"处理订单数据",action:async t=>(await new Promise(r=>setTimeout(r,2e3)),{user:t.user,orders:t.orders,totalAmount:t.orders.length*100})}];function f(t){w.info("当前步骤：".concat(t+1))}function e(){w.success("所有步骤已完成"),l.value=!1}function c(t,r){w.error("步骤 ".concat(r+1," 执行失败: ").concat(t.message)),l.value=!1}return(t,r)=>{const b=A,v=U;return o(),p("div",Y,[y(b,{onClick:r[0]||(r[0]=T=>l.value=!a(l))},{default:S(()=>[I(C(a(l)?"停止":"开始"),1)]),_:1}),y(v,{loading:a(l),steps:m,"prevent-close":"",onStateChange:f,onComplete:e,onError:c},null,8,["loading"])])}}});export{J as _};
