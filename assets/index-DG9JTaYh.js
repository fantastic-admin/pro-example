
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-D68I4d47.js";import{d as q,aM as j,aN as H,e as G,g as F,ac as J,c as r,o as n,l as u,O as p,R as K,S as Q,U,w as B,aF as I,k as b,P as W,x as M,n as C,a as i,b as R,r as X,N as Y,p as w,b9 as N,b_ as Z}from"./index-Bnionyve.js";import{f as $}from"./filesize-BlNqgPst.js";import{u as ee}from"./index-Cz617MeX.js";const te={class:"space-y-2"},ae={class:"flex flex-wrap gap-2"},oe=["src"],ie={key:0,class:"absolute inset-0 grid grid-cols-2 place-items-center rounded-lg bg-black/50 p-2 text-white opacity-0 transition-opacity group-hover/image-upload:opacity-100"},se=["onClick"],ne=["onClick"],le=["onClick"],re=["onClick"],ce=["disabled"],de={class:"size-full flex-center border border-2 rounded-lg border-dashed p-0 text-primary"},ue=["multiple"],pe={key:0,class:"flex flex-wrap gap-1 text-xs text-card-foreground/50 empty:hidden"},fe={key:0,class:"after:content-[';_'] last:after:content-empty"},he={key:1,class:"after:content-[';_'] last:after:content-empty"},me={key:2,class:"after:content-[';_'] last:after:content-empty"},ve={key:3,class:"after:content-[';_'] last:after:content-empty"},_e=q({name:"FaImageUpload",__name:"index",props:j({action:{},method:{default:"post"},headers:{default:()=>({})},data:{default:()=>({})},name:{default:"file"},afterUpload:{},multiple:{type:Boolean,default:!1},ext:{default:()=>[]},max:{default:1},width:{default:100},height:{default:100},dimension:{},size:{default:5*1024*1024},hideTips:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:j(["onSuccess"],["update:modelValue"]),setup(x,{emit:_}){const e=x,V=_,t=H(x,"modelValue"),{t:f}=G(),k=F(!1),h=F(0),z=J("fileInputRef");function D(a){var o;const c=a.target;if(!c.files)return;const d=Array.from(c.files),T=e.max===0?d.length:e.max-t.value.length,m=[];for(const s of d.slice(0,T)){if(e.ext.length>0){const g=(o=s.name.split(".").pop())==null?void 0:o.toLowerCase();if(!e.ext.map(y=>y.toLowerCase()).includes(g||"")){N.error(f("typeError",{ext:e.ext.join(" / ")}),{description:s.name});continue}}if(e.size>0&&s.size>e.size){N.error(f("sizeError",{size:$(e.size,{standard:"jedec"})}),{description:"".concat(s.name," (").concat($(s.size,{standard:"jedec"}),")")});continue}m.push(s)}z.value.value="",m.forEach(s=>{k.value=!0,h.value=0;const g=new FormData;Object.entries(e.data).forEach(([l,v])=>{g.append(l,v)}),g.append(e.name,s);let y={};return e.headers instanceof Headers?e.headers.forEach((l,v)=>{y[v]=l}):y={...e.headers},Z({url:e.action,method:e.method,headers:y,data:g,onUploadProgress:l=>{l.total&&(h.value=Math.round(l.loaded*100/l.total))}}).then(async l=>{var S;const v=await((S=e.afterUpload)==null?void 0:S.call(e,l.data));v&&t.value.push(v),V("onSuccess",l.data,s)}).finally(()=>{k.value=!1,h.value=0})})}function L(a){t.value.splice(a,1)}function O(a){ee().open(t.value,a)}function E(a,c){c==="forward"&&a!==0&&(t.value[a]=t.value.splice(a-1,1,t.value[a])[0]),c==="backward"&&a!==t.value.length-1&&(t.value[a]=t.value.splice(a+1,1,t.value[a])[0])}return(a,c)=>{const d=W,T=A;return n(),r("div",te,[u("div",ae,[(n(!0),r(K,null,Q(t.value,(m,o)=>(n(),r("div",{key:m,class:"group/image-upload relative flex items-center justify-center overflow-hidden border rounded-lg",style:U({width:"".concat(e.width,"px"),height:"".concat(e.height,"px")})},[u("img",{src:m,class:"h-full w-full object-contain"},null,8,oe),e.disabled?p("",!0):(n(),r("div",ie,[u("div",{class:"flex-center cursor-pointer opacity-60 transition-all hover:scale-110 hover:opacity-100",onClick:I(s=>O(o),["prevent"])},[b(d,{name:"i-icon-park-outline:preview-open",class:"size-6"})],8,se),u("div",{class:"flex-center cursor-pointer opacity-60 transition-all hover:scale-110 hover:opacity-100",onClick:I(s=>L(o),["prevent"])},[b(d,{name:"i-icon-park-outline:delete",class:"size-6"})],8,ne),B(u("div",{class:C(i(R)("flex-center cursor-pointer opacity-60 transition-all",{"hover:scale-110 hover:opacity-100":o!==0,"cursor-not-allowed":o===0})),onClick:s=>E(o,"forward")},[b(d,{name:"i-icon-park-outline:arrow-circle-left",class:"size-6"})],10,le),[[M,t.value.length>1]]),B(u("div",{class:C(i(R)("flex-center cursor-pointer opacity-60 transition-all",{"hover:scale-110 hover:opacity-100":o!==t.value.length-1,"cursor-not-allowed":o===t.value.length-1})),onClick:s=>E(o,"backward")},[b(d,{name:"i-icon-park-outline:arrow-circle-right",class:"size-6"})],10,re),[[M,t.value.length>1]])]))],4))),128)),t.value.length<e.max||e.max===0?(n(),r("button",{key:0,type:"button",class:C(["relative flex-center overflow-hidden bg-transparent",{"cursor-not-allowed":e.disabled||i(k)}]),style:U({width:"".concat(e.width,"px"),height:"".concat(e.height,"px")}),disabled:e.disabled||i(k),onClick:c[0]||(c[0]=m=>{var o;return(o=i(z))==null?void 0:o.click()})},[X(a.$slots,"default",{},()=>[u("div",de,[b(d,{name:"i-icon-park-outline:upload",class:"text-2xl text-card-foreground/50"})])]),i(k)&&i(h)>0&&i(h)<100?(n(),Y(T,{key:0,"model-value":i(h),class:"absolute inset-x-1 inset-b-1 h-1 w-auto"},null,8,["model-value"])):p("",!0),u("input",{ref_key:"fileInputRef",ref:z,type:"file",accept:"image/*",multiple:e.multiple,class:"hidden",onChange:D},null,40,ue)],14,ce)):p("",!0)]),e.hideTips?p("",!0):(n(),r("div",pe,[e.dimension?(n(),r("div",fe,w(i(f)("dimensionTip",{width:e.dimension.width,height:e.dimension.height})),1)):p("",!0),e.ext.length>0?(n(),r("div",he,w(i(f)("extTip",{ext:e.ext.join(" / ")})),1)):p("",!0),e.size>0?(n(),r("div",me,w(i(f)("sizeTip",{size:i($)(e.size,{standard:"jedec"})})),1)):p("",!0),e.max>1?(n(),r("div",ve,w(i(f)("countTip",{max:e.max})),1)):p("",!0)]))])}}});function P(x){const _=x;_.__i18n=_.__i18n||[],_.__i18n.push({locale:"",resource:{"zh-cn":{dimensionTip:{t:0,b:{t:2,i:[{t:3,v:"建议尺寸为 "},{t:4,k:"width"},{t:3,v:"*"},{t:4,k:"height"}]}},extTip:{t:0,b:{t:2,i:[{t:3,v:"支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeTip:{t:0,b:{t:2,i:[{t:3,v:"大小不超过 "},{t:4,k:"size"}]}},countTip:{t:0,b:{t:2,i:[{t:3,v:"数量不超过 "},{t:4,k:"max"},{t:3,v:" 个"}]}},typeError:{t:0,b:{t:2,i:[{t:3,v:"上传图片只支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeError:{t:0,b:{t:2,i:[{t:3,v:"上传图片大小不能超过 "},{t:4,k:"size"}]}}},"zh-tw":{dimensionTip:{t:0,b:{t:2,i:[{t:3,v:"建議尺寸為 "},{t:4,k:"width"},{t:3,v:"*"},{t:4,k:"height"}]}},extTip:{t:0,b:{t:2,i:[{t:3,v:"支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeTip:{t:0,b:{t:2,i:[{t:3,v:"大小不超過 "},{t:4,k:"size"}]}},countTip:{t:0,b:{t:2,i:[{t:3,v:"數量不超過 "},{t:4,k:"max"},{t:3,v:" 個"}]}},typeError:{t:0,b:{t:2,i:[{t:3,v:"上傳圖片只支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeError:{t:0,b:{t:2,i:[{t:3,v:"上傳圖片大小不能超過 "},{t:4,k:"size"}]}}},en:{dimensionTip:{t:0,b:{t:2,i:[{t:3,v:"Recommended dimension is "},{t:4,k:"width"},{t:3,v:"*"},{t:4,k:"height"}]}},extTip:{t:0,b:{t:2,i:[{t:3,v:"Support "},{t:4,k:"ext"},{t:3,v:" format"}]}},sizeTip:{t:0,b:{t:2,i:[{t:3,v:"Size not more than "},{t:4,k:"size"}]}},countTip:{t:0,b:{t:2,i:[{t:3,v:"Number not more than "},{t:4,k:"max"}]}},typeError:{t:0,b:{t:2,i:[{t:3,v:"Upload image only support "},{t:4,k:"ext"},{t:3,v:" format"}]}},sizeError:{t:0,b:{t:2,i:[{t:3,v:"Upload image size cannot exceed "},{t:4,k:"size"}]}}}}})}typeof P=="function"&&P(_e);export{_e as _};
