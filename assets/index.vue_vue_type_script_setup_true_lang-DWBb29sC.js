
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as $,g as m,a1 as b,bt as F,bu as K,c as M,o as v,n as L,a as R,b as T,R as g,S as U,O as W,N as A,ad as j,ao as D}from"./index-Bnionyve.js";import{r as G,I as H}from"./item-w-j_qmtO.js";import{_ as J}from"./sub.vue_vue_type_script_setup_true_lang-OO-NHHnH.js";const Z=$({name:"MainMenu",__name:"index",props:{menu:{},value:{},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1},dark:{type:Boolean,default:!1},direction:{default:"ltr"}},setup(w){const u=w,I=new WeakMap;function f(e){return I.has(e)||I.set(e,j()),I.get(e)}const s=m(u.value),o=m({}),t=m({}),c=m([]),N=m([]);function x(e,l=[]){e.forEach(a=>{var d,h;const n=(d=a.path)!=null?d:f(a);if((h=a.children)!=null&&h.some(i=>{var p;return((p=i.meta)==null?void 0:p.menu)!==!1})){const i=[...l,n];t.value[n]={index:n,indexPath:i,active:!1},x(a.children,i)}else o.value[n]={index:n,indexPath:l}})}const C=e=>{c.value.includes(e)||c.value.push(e)},k=e=>{if(Array.isArray(e)){D(()=>{k(e.at(-1)),e.length>1&&k(e.slice(0,-1))});return}Object.keys(t.value).forEach(l=>{t.value[l].indexPath.includes(e)&&(c.value=c.value.filter(a=>a!==e))})};function B(e){var l,a;for(const n in t.value)t.value[n].active=!1;(l=t.value[e])==null||l.indexPath.forEach(n=>{t.value[n].active=!0}),(a=o.value[e])==null||a.indexPath.forEach(n=>{t.value[n].active=!0})}const E=e=>{(u.mode==="horizontal"||u.collapse)&&(c.value=[]),B(e)},S=e=>{c.value.includes(e)?k(e):C(e)};function _(){const e=s.value&&o.value[s.value];B(s.value),!(!e||u.collapse)&&e.indexPath.forEach(l=>{t.value[l]&&C(l)})}return b(()=>u.menu,e=>{x(e),_()},{deep:!0,immediate:!0}),b(()=>u.value,e=>{o.value[e]||(s.value="");const l=o.value[e]||s.value&&o.value[s.value]||o.value[u.value];l?s.value=l.index:s.value=e,_()}),b(()=>u.collapse,e=>{e&&(c.value=[]),_()}),F(G,K({props:u,items:o,subMenus:t,activeIndex:s,openedMenus:c,mouseInMenu:N,openMenu:C,closeMenu:k,handleMenuItemClick:E,handleSubMenuClick:S,getUseId:f})),(e,l)=>(v(),M("div",{class:L(R(T)("h-full w-full flex flex-col of-hidden transition-all",{"flex-row w-auto":u.mode==="horizontal","py-1":u.mode==="vertical"}))},[(v(!0),M(g,null,U(w.menu,a=>{var n,d,h,i,p,P;return v(),M(g,{key:(n=a.path)!=null?n:f(a)},[((d=a.meta)==null?void 0:d.menu)!==!1?(v(),M(g,{key:0},[(h=a.children)!=null&&h.length?(v(),A(J,{key:0,menu:a,"unique-key":[(i=a.path)!=null?i:a.children.every(y=>{var r;return((r=y.meta)==null?void 0:r.menu)===!1})?a.children[0].path:f(a)]},null,8,["menu","unique-key"])):(v(),A(H,{key:1,item:a,"unique-key":[(P=a.path)!=null?P:(p=a.children)!=null&&p.every(y=>{var r;return((r=y.meta)==null?void 0:r.menu)===!1})?a.children[0].path:f(a)],onClick:y=>{var r,q;return E((q=a.path)!=null?q:(r=a.children)!=null&&r.every(O=>{var z;return((z=O.meta)==null?void 0:z.menu)===!1})?a.children[0].path:f(a))}},null,8,["item","unique-key","onClick"]))],64)):W("",!0)],64)}),128))],2))}});export{Z as _};
