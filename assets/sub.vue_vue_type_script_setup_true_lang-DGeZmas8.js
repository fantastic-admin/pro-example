
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-ChpqWgwo.js";import{d as U,s as x,Q as A,x as q,r as P,c as g,o as r,F as y,g as R,l as p,b as k,e as d,T as V,R as L,S as N,U as j,w as H,W as z,X as D,A as Q,f as X,q as I,V as B,C as G}from"./index-H6QnEWHf.js";import{r as J,I as O}from"./item-DR3E2Ae_.js";const Y={class:"columns-3 p-2 px-3 2xl:columns-4"},ne=U({name:"SubMenu",__name:"sub",props:{uniqueKey:{},menu:{},level:{default:0}},setup(s){var b;const u=s,M=x("itemRef"),w=x("subMenuRef"),n=A(J),v=(b=u.menu.path)!=null?b:n.getUseId(u.menu),K=q(()=>n.openedMenus.includes(u.uniqueKey.at(-1))),T={enter(e){e.offsetHeight>window.innerHeight&&(e.style.height="".concat(window.innerHeight,"px"))},afterEnter:()=>{},beforeLeave:e=>{e.style.overflow="hidden",e.style.maxHeight="".concat(e.offsetHeight,"px")},leave:e=>{e.style.maxHeight="0"},afterLeave(e){e.style.overflow="",e.style.maxHeight=""}},E={enterActiveClass:"ease-in-out duration-300",enterFromClass:"opacity-0 translate-x-4",enterToClass:"opacity-100",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},f=q(()=>{var e,t;return(t=(e=u.menu.children)==null?void 0:e.some(i=>{var a;return((a=i.meta)==null?void 0:a.menu)!==!1}))!=null?t:!1});function W(){var e,t;f.value||(e=u.menu.meta)!=null&&e.link||(t=u.menu.meta)!=null&&t.newWindow||n.handleMenuItemClick(v)}let o;function S(){u.level===0&&(n.mouseInMenu=u.uniqueKey,o==null||o(),{stop:o}=B(()=>{if(f.value)n.openMenu(v),G(()=>{var l,c;const e=(l=M.value)==null?void 0:l.ref,t=(c=w.value)==null?void 0:c.$el;if(!e||!t)return;let i=0,a=0;n.props.mode==="vertical"||u.level!==0?(i=e.getBoundingClientRect().top+e.scrollTop,a=(n.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right)+e.getBoundingClientRect().width,i+t.offsetHeight>window.innerHeight&&(i=window.innerHeight-t.offsetHeight)):(i=e.getBoundingClientRect().top+e.getBoundingClientRect().height,a=n.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right,i+t.offsetHeight>window.innerHeight&&(t.style.height="".concat(window.innerHeight-i,"px")),a+t.offsetWidth>document.documentElement.clientWidth&&(a=document.documentElement.clientWidth-t.offsetWidth)),t.style.top="".concat(i,"px"),t.style.insetInlineStart="".concat(a,"px")});else{const e=u.menu.children?n.subMenus[v].indexPath.at(-1):n.items[v].indexPath.at(-1);n.openMenu(e)}},300))}function C(){u.level===0&&(n.mouseInMenu=[],o==null||o(),{stop:o}=B(()=>{n.mouseInMenu.length===0?n.closeMenu(u.uniqueKey):f.value&&!n.mouseInMenu.includes(u.uniqueKey.at(-1))&&n.closeMenu(u.uniqueKey.at(-1))},300))}function $(){o==null||o()}return(e,t)=>{const i=P("SubMenu"),a=F;return r(),g(y,null,[R(O,{ref_key:"itemRef",ref:M,"unique-key":s.uniqueKey,item:s.menu,level:s.level,"sub-menu":d(f),onClick:W,onMouseenter:S,onMouseleave:C},null,8,["unique-key","item","level","sub-menu"]),d(f)?(r(),p(V,{key:0,to:"body",disabled:s.level!==0},[s.level===0?(r(),p(L,N({key:0},E,j(T)),{default:H(()=>[z(R(a,{ref_key:"subMenuRef",ref:w,mask:"",class:Q(["sub-menu z-3000 w-150 overscroll-contain border rounded-lg bg-[var(--g-sub-sidebar-bg)] shadow-xl fixed! 2xl:w-200",{dark:d(n).props.dark}]),onMouseenter:$,onMouseleave:C},{default:H(()=>[X("div",Y,[(r(!0),g(y,null,I(s.menu.children,l=>{var c,m,h;return r(),g("div",{key:(c=l.path)!=null?c:d(n).getUseId(l),class:"w-full break-inside-avoid"},[((m=l.meta)==null?void 0:m.menu)!==!1?(r(),p(i,{key:0,"unique-key":[...s.uniqueKey,(h=l.path)!=null?h:d(n).getUseId(l)],menu:l,level:s.level+1},null,8,["unique-key","menu","level"])):k("",!0)])}),128))])]),_:1},8,["class"]),[[D,d(K)]])]),_:1},16)):(r(!0),g(y,{key:1},I(s.menu.children,l=>{var c,m,h;return r(),g(y,{key:(c=l.path)!=null?c:d(n).getUseId(l)},[((m=l.meta)==null?void 0:m.menu)!==!1?(r(),p(i,{key:0,"unique-key":[...s.uniqueKey,(h=l.path)!=null?h:d(n).getUseId(l)],menu:l,level:s.level+1},null,8,["unique-key","menu","level"])):k("",!0)],64)}),128))],8,["disabled"])):k("",!0)],64)}}});export{ne as _};
