
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as rt,bv as bt,J as ft,K as ut,L as pt,X as ht,bw as vt,e as gt,bd as kt,M as $,ac as O,g as B,Z as J,a1 as V,ao as X,b9 as Z,a2 as q,a3 as _t,c as w,o as p,N as M,l as h,a6 as Q,a as n,k as S,be as mt,n as A,m as C,aj as xt,R as wt,S as St,O as F,w as It,G as Pt,P as Ct,p as W,aF as N,x as Tt,V as yt}from"./index-Bnionyve.js";import{_ as Lt}from"./index.vue_vue_type_script_setup_true_lang-M237O3YI.js";import{_ as Rt}from"./index.vue_vue_type_script_setup_true_lang-C9qLfOM9.js";import{S as $t}from"./sortable.esm-BMgLh4Kk.js";import{u as Y}from"./index-DrbO6XKF.js";import Mt from"./moreAction-BB_N8FNI.js";import{u as Wt}from"./useTabbar-DQUDAxhI.js";import{u as Nt}from"./useMainPage-BMuzrlvW.js";import"./useGraceArea-CADbF9Ky.js";import"./index-D_V_eJgL.js";import"./index-Bo-_Kxas.js";import"./index-GW34aOAv.js";import"./index-Cm0HenuK.js";const zt={class:"tabbar"},Dt={class:"tabbar-container"},Ot=["data-index","onClick","onDblclick"],Bt={class:"size-full"},Vt={class:"tab-content"},At=["onClick"],Ft=["onClick"],Et={class:"text-sm"},Ut={class:"text-accent-foreground/50"},Gt={class:"flex-center flex-shrink-0 gap-2 whitespace-nowrap p-2"},at=rt({name:"Tabbar",__name:"index",setup(E){bt(t=>({v5431278d:n(it),v546490f1:n(st)}));const I=ft(),g=ut(),d=pt(),l=ht(),o=Wt(),U=Nt(),G=vt({reactive:!0}),{t:v}=gt(),{generateI18nTitle:K}=kt(),r=$(()=>o.getId()),et=$(()=>l.list.length>1&&(o.checkCloseOtherSide()||o.checkCloseLeftSide()||o.checkCloseRightSide())),x=O("tabsRef"),z=O("tabContainerRef"),_=O("tabRef"),it=$(()=>{var a,s;const t=l.list.findIndex(i=>i.tabId===r.value);return"".concat(((s=(a=_.value)==null?void 0:a.find(i=>Number.parseInt(i.dataset.index)===t))==null?void 0:s.offsetLeft)||0,"px")}),st=$(()=>{var a,s;const t=l.list.findIndex(i=>i.tabId===r.value);return"".concat(((s=(a=_.value)==null?void 0:a.find(i=>Number.parseInt(i.dataset.index)===t))==null?void 0:s.offsetWidth)||0,"px")}),T=B(!1),y=B(!1);let L;J(()=>{var t;L=new $t((t=z.value)==null?void 0:t.$el,{animation:200,ghostClass:"opacity-0",draggable:".tab",handle:".drag-handle",onStart:()=>{y.value=!0},onEnd:()=>{y.value=!1},onMove:a=>a.dragged.classList.contains("pinned")?a.related.classList.contains("pinned"):!a.related.classList.contains("pinned"),onUpdate:a=>{a.newIndex!==void 0&&a.oldIndex!==void 0&&l.sort(a.newIndex,a.oldIndex)}})}),V([()=>d.mode,()=>d.settings.app.direction],t=>{X(()=>{L==null||L.option("disabled",t[0]==="mobile"||t[1]==="rtl")})},{immediate:!0}),V(()=>I,t=>{d.settings.tabbar.enable&&(l.add(t),X(()=>{var s,i,b,m;const a=l.list.findIndex(e=>e.tabId===r.value);if(a!==-1){const e=(s=_.value)==null?void 0:s.find(c=>Number.parseInt(c.dataset.index)===a),f=(b=(i=x.value)==null?void 0:i.ref)==null?void 0:b.$el;if(e&&f){const c=e.offsetLeft,u=e.offsetWidth,k=f.clientWidth,R=c-(k-u)/2;(m=x.value)==null||m.scrollTo(R)}nt()}}))},{immediate:!0,deep:!0});function nt(){var t,a,s,i;if(((t=z.value)==null?void 0:t.$el.clientWidth)>((i=(s=(a=x.value)==null?void 0:a.ref)==null?void 0:s.$el.clientWidth)!=null?i:0)&&!localStorage.has("tabbarScrollTip")){localStorage.setItem("tabbarScrollTip","");const b=Z.info("温馨提示",{description:"标签栏数量超过展示区域范围，可以将鼠标移到标签栏上，通过鼠标滚轮滑动浏览",position:"top-center",duration:1/0,action:{label:"知道了",onClick:()=>Z.dismiss(b)}})}}function lt(t){switch(d.settings.tabbar.dblclickAction){case"reload":U.reload();break;case"close":o.closeById(t.tabId);break;case"pin":t.isPin?l.unPin(t.tabId):l.pin(t.tabId);break;case"maximize":d.setMainPageMaximize();break;case"window":window.open(g.resolve(t.fullPath).href,"_blank");break}}function ot(t){return[[{label:v("reload"),icon:"i-ri:refresh-line",disabled:t.tabId!==r.value,handle:()=>U.reload()},{label:v("close"),icon:"i-ri:close-line",disabled:!o.checkClose(t.tabId),handle:()=>o.closeById(t.tabId)}],[{label:t.isPin?v("unpin"):v("pin"),icon:t.isPin?"i-lucide:pin-off":"i-lucide:pin",disabled:t.fullPath===d.settings.home.fullPath||t.isPermanent,handle:()=>t.isPin?l.unPin(t.tabId):l.pin(t.tabId)},{label:v("maximize"),icon:"i-ri:picture-in-picture-exit-line",handle:()=>{t.tabId!==r.value&&g.push(t.fullPath),d.setMainPageMaximize()}},{label:v("newWindow"),icon:"i-ci:window",handle:()=>{window.open(g.resolve(t.fullPath).href,"_blank")}}],[{label:v("closeOtherSide"),icon:"i-mdi:close",disabled:!o.checkCloseOtherSide(t.tabId),handle:()=>{o.closeOtherSide(t.tabId)}},{label:v("closeLeftSide"),icon:"i-mdi:arrow-expand-left",disabled:!o.checkCloseLeftSide(t.tabId),handle:()=>{o.closeLeftSide(t.tabId)}},{label:v("closeRightSide"),icon:"i-mdi:arrow-expand-right",disabled:!o.checkCloseRightSide(t.tabId),handle:()=>{o.closeRightSide(t.tabId)}}]]}function j(t,a,s){let i;return!t&&a||t&&!s?i=a:t&&s&&(i=s),i}const P=B([]);function dt(){var s,i,b,m,e,f,c,u;const t=(b=(i=(s=x.value)==null?void 0:s.ref)==null?void 0:i.$el.clientWidth)!=null?b:0,a=(u=(c=(f=(e=(m=x.value)==null?void 0:m.ref)==null?void 0:e.el)==null?void 0:f.viewportElement)==null?void 0:c.scrollLeft)!=null?u:0;if(P.value=[],_.value)for(let k=0;k<_.value.length;k++){const R=_.value[k],H=R.offsetLeft,ct=H+R.offsetWidth;H<a+t&&ct>a&&k>=0&&k<l.list.length&&P.value.push(k)}}function D(t){var a;return(a=P.value.findIndex(s=>s===t))!=null?a:-1}return V(()=>G.alt,t=>{t&&dt()}),J(()=>{q("alt+left,alt+right,alt+w,alt+1,alt+2,alt+3,alt+4,alt+5,alt+6,alt+7,alt+8,alt+9,alt+0",(t,a)=>{var s;if(d.settings.tabbar.enable&&d.settings.tabbar.enableHotkeys)switch(t.preventDefault(),a.key){case"alt+left":if(l.list[0].tabId!==r.value){const i=l.list.findIndex(b=>b.tabId===r.value);g.push(l.list[i-1].fullPath)}break;case"alt+right":if(((s=l.list.at(-1))==null?void 0:s.tabId)!==r.value){const i=l.list.findIndex(b=>b.tabId===r.value);g.push(l.list[i+1].fullPath)}break;case"alt+w":o.closeById(r.value);break;case"alt+1":case"alt+2":case"alt+3":case"alt+4":case"alt+5":case"alt+6":case"alt+7":case"alt+8":case"alt+9":{const i=Number(a.key.split("+")[1]);P.value[i-1]!==void 0&&g.push(l.list[P.value[i-1]].fullPath);break}case"alt+0":g.push(l.list[l.list.length-1].fullPath);break}})}),_t(()=>{q.unbind("alt+left,alt+right,alt+w,alt+1,alt+2,alt+3,alt+4,alt+5,alt+6,alt+7,alt+8,alt+9,alt+0")}),(t,a)=>{const s=Ct,i=Rt,b=Lt,m=mt;return p(),w("div",zt,[(p(),M(Q(n(Y)("tabbar-start")))),h("div",Dt,[S(m,{ref_key:"tabsRef",ref:x,scrollbar:!1,mask:"",horizontal:"","gradient-color":"var(--g-tabbar-bg)",class:A(["tabs",{"tabs-ontop":n(d).settings.topbar.switchTabbarAndToolbar,["tabs-".concat(n(d).settings.tabbar.style)]:n(d).settings.tabbar.style!==""}])},{default:C(()=>[S(xt,{ref_key:"tabContainerRef",ref:z,name:n(y)?void 0:"tabbar",tag:"div",class:A(["tab-container",{dragging:n(y)}]),onBeforeLeave:a[2]||(a[2]=e=>T.value=!0),onAfterLeave:a[3]||(a[3]=e=>T.value=!1)},{default:C(()=>[(p(!0),w(wt,null,St(n(l).list,(e,f)=>(p(),w("div",{key:e.tabMerge==="routeName"&&e.routeName?e.routeName:e.tabId,ref_for:!0,ref_key:"tabRef",ref:_,"data-index":f,class:A(["tab",{"tab-ontop":n(d).settings.topbar.switchTabbarAndToolbar,actived:e.tabId===n(r),pinned:e.isPermanent||e.isPin}]),onClick:c=>!n(T)&&n(g).push(e.fullPath),onDblclick:c=>!n(T)&&lt(e)},[S(b,{items:ot(e)},{default:C(()=>[h("div",Bt,[a[5]||(a[5]=h("div",{class:"tab-dividers"},null,-1)),a[6]||(a[6]=h("div",{class:"tab-background"},null,-1)),S(i,{delay:1e3,side:"bottom"},{content:C(()=>{var c;return[h("div",Et,W(((c=e.customTitleList.find(u=>u.fullPath===e.fullPath))==null?void 0:c.title)||n(K)(e.title)),1),h("div",Ut,W(e.fullPath),1)]}),default:C(()=>{var c;return[h("div",Vt,[(p(),w("div",{key:e.tabId,class:"title"},[n(d).settings.tabbar.enableIcon&&j(e.tabId===n(r),e.icon,e.activeIcon)?(p(),M(s,{key:0,name:j(e.tabId===n(r),e.icon,e.activeIcon),class:"icon"},null,8,["name"])):F("",!0),Pt(" "+W(((c=e.customTitleList.find(u=>u.fullPath===e.fullPath))==null?void 0:c.title)||n(K)(e.title)),1)])),!e.isPermanent&&e.isPin?(p(),w("div",{key:0,class:"action-icon",onClick:N(u=>n(l).unPin(e.tabId),["stop"]),onDblclick:a[0]||(a[0]=N(()=>{},["stop"]))},[S(s,{name:"i-ri:pushpin-2-fill"})],40,At)):!e.isPermanent&&n(l).list.length>1?(p(),w("div",{key:1,class:"action-icon",onClick:N(u=>n(o).closeById(e.tabId),["stop"]),onDblclick:a[1]||(a[1]=N(()=>{},["stop"]))},[S(s,{name:"i-ri:close-fill"})],40,Ft)):F("",!0),It(h("div",{class:"hotkey-number"},W(D(f)+1),513),[[Tt,n(G).alt&&D(f)>=0&&D(f)<9]]),a[4]||(a[4]=h("div",{class:"drag-handle"},null,-1))])]}),_:2},1024)])]),_:2},1032,["items"])],42,Ot))),128))]),_:1},8,["name","class"])]),_:1},8,["class"]),h("div",Gt,[n(et)?(p(),M(Mt,{key:0})):F("",!0)])]),(p(),M(Q(n(Y)("tabbar-end"))))])}}});function tt(E){const I=E;I.__i18n=I.__i18n||[],I.__i18n.push({locale:"",resource:{"zh-cn":{reload:{t:0,b:{t:2,i:[{t:3}],s:"重新加载"}},close:{t:0,b:{t:2,i:[{t:3}],s:"关闭标签页"}},pin:{t:0,b:{t:2,i:[{t:3}],s:"固定"}},unpin:{t:0,b:{t:2,i:[{t:3}],s:"取消固定"}},maximize:{t:0,b:{t:2,i:[{t:3}],s:"最大化"}},newWindow:{t:0,b:{t:2,i:[{t:3}],s:"新窗口中打开"}},closeOtherSide:{t:0,b:{t:2,i:[{t:3}],s:"关闭其它标签页"}},closeLeftSide:{t:0,b:{t:2,i:[{t:3}],s:"关闭左侧标签页"}},closeRightSide:{t:0,b:{t:2,i:[{t:3}],s:"关闭右侧标签页"}}},"zh-tw":{reload:{t:0,b:{t:2,i:[{t:3}],s:"重新加載"}},close:{t:0,b:{t:2,i:[{t:3}],s:"關閉標籤頁"}},pin:{t:0,b:{t:2,i:[{t:3}],s:"固定"}},unpin:{t:0,b:{t:2,i:[{t:3}],s:"取消固定"}},maximize:{t:0,b:{t:2,i:[{t:3}],s:"最大化"}},newWindow:{t:0,b:{t:2,i:[{t:3}],s:"新窗口中打開"}},closeOtherSide:{t:0,b:{t:2,i:[{t:3}],s:"關閉其它標籤頁"}},closeLeftSide:{t:0,b:{t:2,i:[{t:3}],s:"關閉左側標籤頁"}},closeRightSide:{t:0,b:{t:2,i:[{t:3}],s:"關閉右側標籤頁"}}},en:{reload:{t:0,b:{t:2,i:[{t:3}],s:"Reload"}},close:{t:0,b:{t:2,i:[{t:3}],s:"Close"}},pin:{t:0,b:{t:2,i:[{t:3}],s:"Pin"}},unpin:{t:0,b:{t:2,i:[{t:3}],s:"Unpin"}},maximize:{t:0,b:{t:2,i:[{t:3}],s:"Maximize"}},newWindow:{t:0,b:{t:2,i:[{t:3}],s:"Open In New Window"}},closeOtherSide:{t:0,b:{t:2,i:[{t:3}],s:"Close Otherside Tabs"}},closeLeftSide:{t:0,b:{t:2,i:[{t:3}],s:"Close Leftside Tabs"}},closeRightSide:{t:0,b:{t:2,i:[{t:3}],s:"Close Rightside Tabs"}}}}})}typeof tt=="function"&&tt(at);const sa=yt(at,[["__scopeId","data-v-c9c67389"]]);export{sa as default};
