
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-TgflyMpU-BuemEpsd.js","./index-Bnionyve.js","./index-DpF4sDjY.css"])))=>i.map(i=>d[i]);
import{bv as ge,M as C,g as c,ar as me,Z as H,a1 as j,c as o,ao as q,o as a,O as d,N as U,U as S,l as f,G as be,p as g,a as r,k as xe,cA as ke,r as X,R as y,S as p,n as Y,cC as Ce}from"./index-Bnionyve.js";import{s as Ae,Q as we,A as _e,g as $e,p as P,b as ze,O as m,I as Q,f as J,y as Le,G as R}from"./vue-data-ui-DO-nR8BN.js";import{E as Se,M as Me}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{t as Fe,o as Z}from"./useNestedProp-dJX_8vvZ-Dub3p3M4.js";import{S as Ie,T as Ee}from"./BaseScanner-BgWxam9d-Cak_1oua.js";import{k as Ne}from"./useFitSvgText-2crs6Fv5-ueK6mTpV.js";import{o as Oe}from"./useChartAccessibility-9icAAmYg-DZae9bBn.js";import{w as Re}from"./Shape-CNXKB8O0-CSD830I9.js";import{J as We}from"./themes-AUNCOb2G-RAhReTPj.js";import"./alert-Vqv_sKXu.js";import"./command.vue_vue_type_script_setup_true_lang-BupUAzs5.js";import"./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js";const Ve={key:0},Te={key:1},Be=["xmlns","viewBox"],Ge=["width","height"],De=["id"],He=["stop-color"],je=["stop-color"],qe=["id"],Ue=["stop-color"],Xe=["stop-color"],Ye=["id"],Pe=["stop-color"],Qe=["stop-color"],Je=["height","width","fill","x","stroke","stroke-width","rx","stroke-dasharray"],Ze={key:1},Ke=["x","y","height","width","fill","stroke","stroke-width","rx"],et={key:2},tt=["x","y","font-size","font-weight","fill"],lt=["x","y","font-size","fill"],at=["x","y","font-size","fill"],ot=["height","width","x","onMouseover","onMouseleave","onClick"],st={__name:"vue-ui-sparkhistogram",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},emits:["selectDatapoint"],setup(K,{emit:ee}){ge(l=>({v693dff61:ve.value}));const te=ke(()=>Ce(()=>import("./PackageVersion-TgflyMpU-BuemEpsd.js"),__vite__mapDeps([0,1,2]),import.meta.url)),{vue_ui_sparkhistogram:le}=Fe(),b=K,x=c(we()),W=c(null),V=c(null),M=c(null),A=c(null),_=c(null),e=c(E()),{loading:T,FINAL_DATASET:w}=Ie({...me(b),FINAL_CONFIG:e,prepareConfig:E,skeletonDataset:[{value:1,intensity:.2,color:"#CACACA"},{value:2,intensity:.3,color:"#CACACA"},{value:3,intensity:.5,color:"#CACACA"},{value:5,intensity:.7,color:"#CACACA"},{value:8,intensity:.9,color:"#CACACA"},{value:13,intensity:.95,color:"#CACACA"},{value:21,intensity:1,color:"#CACACA"},{value:13,intensity:.95,color:"#CACACA"},{value:8,intensity:.9,color:"#CACACA"},{value:5,intensity:.7,color:"#CACACA"},{value:3,intensity:.5,color:"#CACACA"},{value:2,intensity:.3,color:"#CACACA"},{value:1,intensity:.2,color:"#CACACA"}],skeletonConfig:_e({defaultConfig:e.value,userConfig:{style:{animation:{show:!1},backgroundColor:"#99999930"}}})}),F=c(e.value.style.layout.width),I=c(e.value.style.layout.height),{svgRef:B}=Oe({config:e.value.style.title});function E(){const l=Z({userConfig:b.config,defaultConfig:le});return l.theme?{...Z({userConfig:We.vue_ui_sparkhistogram[l.theme]||b.config,defaultConfig:l})}:l}H(()=>{D()});const G=C(()=>!!e.value.debug);function D(){if($e(b.dataset)?P({componentName:"VueUiSparkHistogram",type:"dataset",debug:G.value}):b.dataset.forEach((l,s)=>{ze({datasetObject:l,requiredAttributes:["value"]}).forEach(t=>{P({componentName:"VueUiSparkHistogram",type:"datasetSerieAttribute",property:t,index:s,debug:G.value})})}),e.value.responsive){const l=Se(()=>{const{width:s,height:t}=Me({chart:M.value,title:e.value.style.title.text?V.value:null,source:W.value});requestAnimationFrame(()=>{F.value=Math.max(10,s),I.value=Math.max(10,t-12)})});A.value&&(_.value&&A.value.unobserve(_.value),A.value.disconnect()),A.value=new ResizeObserver(l),_.value=M.value.parentNode,A.value.observe(_.value)}}j(()=>b.config,l=>{e.value=E(),D()},{deep:!0});const v=C(()=>{const l=I.value,s=F.value,t=e.value.style.layout.padding.top,i=l-e.value.style.layout.padding.bottom,h=e.value.style.layout.padding.left,$=s-e.value.style.layout.padding.right,z=t+(l-t-e.value.style.layout.padding.bottom)/2,N=l-e.value.style.layout.padding.top-e.value.style.layout.padding.bottom,L=s-e.value.style.layout.padding.left-e.value.style.layout.padding.right;return{bottom:i,centerY:z,drawingHeight:N,drawingWidth:L,height:l,left:h,right:$,top:t,width:s}}),ae=C(()=>Math.max(...w.value.map(l=>Math.abs(l.value||0))));function oe(l){return Math.abs(l)/ae.value}const u=C(()=>w.value.map((l,s)=>{const t=oe(l.value||0),i=v.value.drawingHeight*t,h=v.value.drawingWidth/w.value.length,$=h*(e.value.style.bars.gap/100),z=h-$,N=v.value.centerY-i/2,L=v.value.left+($/2+s*h),ye=v.value.left+s*h,O=typeof l.intensity>"u"?100:Math.round(l.intensity*100),ce=l.color?l.color:l.value>=0?m(e.value.style.bars.colors.positive,O):m(e.value.style.bars.colors.negative,O),pe=l.color?l.color:l.value>=0?e.value.style.bars.colors.positive:e.value.style.bars.colors.negative,he=l.color?"url(#gradient_datapoint_".concat(s,"_").concat(x.value,")"):l.value>=0?"url(#gradient_positive_".concat(s,"_").concat(x.value,")"):"url(#gradient_negative_".concat(s,"_").concat(x.value,")"),fe=L+z/2;return{...l,color:ce,gradient:he,height:i,intensity:O,proportion:t,stroke:pe,textAnchor:fe,trapX:ye,unitWidth:h,width:z,x:L,y:N}}));function se(l,s){return Q(e.value.style.labels.value.formatter,l.value,J({p:e.value.style.labels.value.prefix,v:l.value,s:e.value.style.labels.value.suffix,r:e.value.style.labels.value.rounding}),{datapoint:l,seriesIndex:s})}const n=c(null),ie=ee;function ue(l,s){ie("selectDatapoint",{datapoint:l,index:s}),e.value.events.datapointClick&&e.value.events.datapointClick({datapoint:l,seriesIndex:s})}function re(l,s){n.value=s,e.value.events.datapointEnter&&e.value.events.datapointEnter({datapoint:l,seriesIndex:s})}function ne(l,s){n.value=null,e.value.events.datapointLeave&&e.value.events.datapointLeave({datapoint:l,seriesIndex:s})}const ve=C(()=>"".concat(e.value.style.animation.speedMs,"ms")),de=C(()=>v.value.drawingWidth/w.value.length*.9),{fitText:k}=Ne({svgRef:B,unitWidth:de});return H(async()=>{await q(),k(".vue-ui-sparkhistogram-top-label",e.value.style.labels.value.minFontSize),k(".vue-ui-sparkhistogram-bottom-label",e.value.style.labels.valueLabel.minFontSize),k(".vue-ui-sparkhistogram-time-label",e.value.style.labels.timeLabel.minFontSize)}),j([F,I,()=>w.value],async()=>{await q(),k(".vue-ui-sparkhistogram-top-label",e.value.style.labels.value.minFontSize),k(".vue-ui-sparkhistogram-bottom-label",e.value.style.labels.valueLabel.minFontSize),k(".vue-ui-sparkhistogram-time-label",e.value.style.labels.timeLabel.minFontSize)}),(l,s)=>(a(),o("div",{class:"vue-data-ui-component vue-ui-spark-histogram",ref_key:"histogramChart",ref:M,style:S("width:100%;background:".concat(e.value.style.backgroundColor,";font-family:").concat(e.value.style.fontFamily)),onMouseleave:s[0]||(s[0]=t=>n.value=null)},[e.value.style.title.text?(a(),o("div",{key:0,ref_key:"chartTitle",ref:V,style:S("width:calc(100% - 12px);background:transparent;margin:0 auto;margin:".concat(e.value.style.title.margin,";padding: 0 6px;text-align:").concat(e.value.style.title.textAlign))},[f("div",{style:S("font-size:".concat(e.value.style.title.fontSize,"px;color:").concat(e.value.style.title.color,";font-weight:").concat(e.value.style.title.bold?"bold":"normal"))},[be(g(e.value.style.title.text)+" ",1),n.value!==null?(a(),o("span",Ve,"- "+g(u.value[n.value].timeLabel||"")+" "+g(r(Q)(e.value.style.labels.value.formatter,u.value[n.value].value,r(J)({p:e.value.style.labels.value.prefix,v:u.value[n.value].value,s:e.value.style.labels.value.suffix,r:e.value.style.labels.value.rounding}),{datapoint:u.value[n.value],seriesIndex:n.value})),1)):d("",!0),![void 0,null].includes(n.value)&&![null,void 0].includes(u.value[n.value].valueLabel)?(a(),o("span",Te,"("+g(u.value[n.value].valueLabel||0)+")",1)):d("",!0)],4),e.value.style.title.subtitle.text?(a(),o("div",{key:0,style:S("font-size:".concat(e.value.style.title.subtitle.fontSize,"px;color:").concat(e.value.style.title.subtitle.color,";font-weight:").concat(e.value.style.title.subtitle.bold?"bold":"normal"))},g(e.value.style.title.subtitle.text),5)):d("",!0)],4)):d("",!0),(a(),o("svg",{ref_key:"svgRef",ref:B,xmlns:r(Le),viewBox:"0 0 ".concat(v.value.width," ").concat(v.value.height),style:{overflow:"visible"}},[xe(r(te)),l.$slots["chart-background"]?(a(),o("foreignObject",{key:0,x:0,y:0,width:v.value.width,height:v.value.height,style:{pointerEvents:"none"}},[X(l.$slots,"chart-background",{},void 0,!0)],8,Ge)):d("",!0),f("defs",null,[(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("radialGradient",{id:"gradient_positive_".concat(i,"_").concat(x.value),cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[f("stop",{offset:"0%","stop-color":r(m)(r(R)(e.value.style.bars.colors.positive,.05),t.intensity)},null,8,He),f("stop",{offset:"100%","stop-color":r(m)(e.value.style.bars.colors.positive,t.intensity)},null,8,je)],8,De))),256)),(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("radialGradient",{id:"gradient_negative_".concat(i,"_").concat(x.value),cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[f("stop",{offset:"0%","stop-color":r(m)(r(R)(e.value.style.bars.colors.negative,.05),t.intensity)},null,8,Ue),f("stop",{offset:"100%","stop-color":r(m)(e.value.style.bars.colors.negative,t.intensity)},null,8,Xe)],8,qe))),256)),(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("radialGradient",{id:"gradient_datapoint_".concat(i,"_").concat(x.value),cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[f("stop",{offset:"0%","stop-color":r(m)(r(R)(t.color,.05),t.intensity)},null,8,Pe),f("stop",{offset:"100%","stop-color":r(m)(t.color,t.intensity)},null,8,Qe)],8,Ye))),256))]),(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("g",null,[n.value!==null&&n.value===i?(a(),o("rect",{key:0,height:v.value.height,width:t.unitWidth,fill:e.value.style.selector.fill,x:t.trapX,y:0,stroke:e.value.style.selector.stroke,"stroke-width":e.value.style.selector.strokeWidth,rx:e.value.style.selector.borderRadius,"stroke-dasharray":e.value.style.selector.strokeDasharray},null,8,Je)):d("",!0)]))),256)),!e.value.style.bars.shape||e.value.style.bars.shape==="square"?(a(),o("g",Ze,[(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("rect",{x:t.x,y:t.y,height:t.height,width:t.width,fill:e.value.style.bars.colors.gradient.show?t.gradient:t.color,stroke:t.stroke,"stroke-width":e.value.style.bars.strokeWidth,rx:"".concat(e.value.style.bars.borderRadius*t.proportion/12,"%"),class:Y({"vue-ui-sparkhistogram-shape":e.value.style.animation.show})},null,10,Ke))),256))])):(a(),o("g",et,[(a(!0),o(y,null,p(u.value,(t,i)=>(a(),U(Re,{plot:{x:t.x+t.width/2,y:t.y+t.height/2},color:e.value.style.bars.colors.gradient.show?t.gradient:t.color,shape:e.value.style.bars.shape,radius:Math.min(t.height*.4,t.width*.4),class:Y({"vue-ui-sparkhistogram-shape":e.value.style.animation.show})},null,8,["plot","color","shape","radius","class"]))),256))])),r(T)?d("",!0):(a(),o(y,{key:3},[(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("text",{class:"vue-ui-sparkhistogram-top-label","text-anchor":"middle",x:t.textAnchor,y:t.y-e.value.style.labels.value.fontSize/3+e.value.style.labels.value.offsetY,"font-size":e.value.style.labels.value.fontSize,"font-weight":e.value.style.labels.value.bold?"bold":"normal",fill:e.value.style.labels.value.color},g(se(t,i)),9,tt))),256)),(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("g",null,[t.valueLabel?(a(),o("text",{key:0,class:"vue-ui-sparkhistogram-bottom-label",x:t.textAnchor,y:t.y+t.height+e.value.style.labels.valueLabel.fontSize,"font-size":e.value.style.labels.valueLabel.fontSize,"text-anchor":"middle",fill:e.value.style.labels.valueLabel.color},g(t.valueLabel),9,lt)):d("",!0)]))),256)),(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("g",null,[t.timeLabel?(a(),o("text",{key:0,class:"vue-ui-sparkhistogram-time-label",x:t.textAnchor,y:v.value.height-e.value.style.labels.timeLabel.fontSize/2,"font-size":e.value.style.labels.timeLabel.fontSize,fill:e.value.style.labels.timeLabel.color,"text-anchor":"middle"},g(t.timeLabel),9,at)):d("",!0)]))),256))],64)),(a(!0),o(y,null,p(u.value,(t,i)=>(a(),o("g",null,[f("rect",{height:v.value.height,width:t.unitWidth,fill:"transparent",x:t.trapX,y:0,onMouseover:h=>re(t,i),onMouseleave:h=>ne(t,i),onClick:()=>ue(t,i)},null,40,ot)]))),256))],8,Be)),l.$slots.source?(a(),o("div",{key:1,ref_key:"source",ref:W,dir:"auto"},[X(l.$slots,"source",{},void 0,!0)],512)):d("",!0),r(T)?(a(),U(Ee,{key:2})):d("",!0)],36))}},mt=Ae(st,[["__scopeId","data-v-df871618"]]);export{mt as default};
