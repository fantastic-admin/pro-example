
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-TgflyMpU-BuemEpsd.js","./index-Bnionyve.js","./index-DpF4sDjY.css","./Tooltip-68Yi_FFl-C-5RJwT5.js","./vue-data-ui-DO-nR8BN.js","./alert-Vqv_sKXu.js","./command.vue_vue_type_script_setup_true_lang-BupUAzs5.js","./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js","./vue-data-ui-D1HaM8UR.css"])))=>i.map(i=>d[i]);
import{an as be,Z as H,g as c,ar as xe,a1 as J,M as _,c as s,o as r,O as f,k as Z,N as we,U as p,l as v,p as I,a as d,cA as K,R as b,S as A,n as L,m as X,r as M,D as ee,E as te,cC as le}from"./index-Bnionyve.js";import{s as Ce,Q as ae,A as $e,v as _e,m as u,a as F,C as Se,g as Ie,p as oe,b as Ae,f as j,y as Fe,O as re,G as se,I as ie,F as ze}from"./vue-data-ui-DO-nR8BN.js";import{t as Be,o as ne}from"./useNestedProp-dJX_8vvZ-Dub3p3M4.js";import{o as De}from"./useChartAccessibility-9icAAmYg-DZae9bBn.js";import{J as Ee}from"./themes-AUNCOb2G-RAhReTPj.js";import{S as Oe,T as Le}from"./BaseScanner-BgWxam9d-Cak_1oua.js";import"./alert-Vqv_sKXu.js";import"./command.vue_vue_type_script_setup_true_lang-BupUAzs5.js";import"./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js";const Ne=["xmlns","viewBox"],Pe=["id"],Re=["stop-color"],Te=["stop-color"],Ve=["stop-color"],Me={id:"stackPill",clipPathUnits:"objectBoundingBox"},je=["fill"],Ge={key:0,"clip-path":"url(#stackPill)"},Ue=["x","width","height","fill"],Ye=["x","width","height","fill","stroke"],We=["x","width","height","onClick","onMouseenter","onMouseleave"],qe=["width","height","rx"],Qe=["onClick"],He={style:{display:"flex","flex-direction":"row","align-items":"center",gap:"4px","justify-content":"center"}},Je=["height","width"],Ze=["id"],Ke=["stop-color"],Xe=["stop-color"],et=["fill"],tt={key:2,ref:"source",dir:"auto"},lt={__name:"vue-ui-sparkstackbar",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},emits:["selectDatapoint"],setup(ue,{emit:de}){const ve=K(()=>le(()=>import("./PackageVersion-TgflyMpU-BuemEpsd.js"),__vite__mapDeps([0,1,2]),import.meta.url)),ce=K(()=>le(()=>import("./Tooltip-68Yi_FFl-C-5RJwT5.js"),__vite__mapDeps([3,4,1,2,5,6,7,8]),import.meta.url)),{vue_ui_sparkstackbar:pe}=Be(),x=ue,ge=be();H(()=>{ge["chart-background"]&&console.warn("VueUiSparkStackbar does not support the #chart-background slot.")});const G=c(null),z=c(ae()),N=c(!1),P=c(""),e=c(R()),{loading:w,FINAL_DATASET:m}=Oe({...xe(x),FINAL_CONFIG:e,prepareConfig:R,skeletonDataset:[{name:"_",value:8,color:"#808080"},{name:"_",value:5,color:"#ADADAD"},{name:"_",value:3,color:"#DBDBDB"}],skeletonConfig:$e({defaultConfig:e.value,userConfig:{style:{backgroundColor:"#99999930",animation:{show:!1},bar:{gradient:{inderlayerColor:"#6A6A6A"}},title:{backgroundColor:"transparent"}}}})}),{svgRef:ye}=De({config:e.value.style.title});function R(){const t=ne({userConfig:x.config,defaultConfig:pe});return t.theme?{...ne({userConfig:Ee.vue_ui_sparkstackbar[t.theme]||x.config,defaultConfig:t}),customPalette:_e[t.theme]||u}:t}J(()=>x.config,t=>{e.value=R(),W()},{deep:!0}),J(()=>m.value,t=>{k.value=m.value.map((o,l)=>({...o,color:o.color?F(o.color):S.value[l]||u[l]||u[l%u.length]})),U()},{deep:!0});const S=_(()=>Se(e.value.customPalette)),k=c(m.value.map((t,o)=>({...t,value:e.value.style.animation.show?0:t.value||0,color:t.color?F(t.color):S.value[o]||u[o]||u[o%u.length]}))),C=c(!0);function U(){if(!e.value.style.animation.show)return;const t=e.value.style.animation.animationFrames,o=m.value.map(i=>i.value||0),l=o.map(i=>i/t),a=o.reduce((i,n)=>i+n,0);let h=0;C.value=!0,k.value=m.value.map((i,n)=>({...i,value:0,color:i.color?F(i.color):S.value[n]||u[n]||u[n%u.length]}));function O(){h+=a/t,h<a?(k.value=k.value.map((i,n)=>({...i,value:Math.min(i.value+l[n],o[n]),color:i.color?F(i.color):S.value[n]||u[n]||u[n%u.length]})),requestAnimationFrame(O)):(C.value=!1,k.value=m.value.map((i,n)=>({...i,value:o[n],color:i.color?F(i.color):S.value[n]||u[n]||u[n%u.length],id:ae()})))}O()}H(()=>{W()});const Y=_(()=>e.value.debug);function W(){Ie(x.dataset)?oe({componentName:"VueUiSparkStackbar",type:"dataset",debug:Y.value}):x.dataset.forEach((t,o)=>{Ae({datasetObject:t,requiredAttributes:["name","value"]}).forEach(l=>{oe({componentName:"VueUiSparkStackbar",type:"datasetSerieAttribute",property:l,index:o,debug:Y.value})})}),U()}const g=c({width:500,height:16}),y=c([]),q=_(()=>m.value.map(t=>t.value||0).filter((t,o)=>!y.value.includes(o)).reduce((t,o)=>t+o,0)),B=_(()=>k.value.map((t,o)=>{const l=t.value||0,a=l/q.value,h=isNaN(a)?0:a,O=h*g.value.width;return{...t,value:l,proportion:h,width:O,seriesIndex:o,proportionLabel:j({v:h*100,s:"%",r:e.value.style.legend.percentage.rounding})}})),T=_(()=>B.value.filter((t,o)=>!y.value.includes(o)));function fe(t){y.value.includes(t)?y.value=y.value.filter(o=>o!==t):y.value.length<k.value.length-1&&y.value.push(t)}const D=_(()=>{let t=0;const o=[];for(let l=0;l<T.value.length;l+=1)o.push({...T.value[l],start:t}),t+=T.value[l].width;return o}),he=de;function Q(t,o,l=!1){he("selectDatapoint",{datapoint:t,index:o}),e.value.events.datapointClick&&!l&&e.value.events.datapointClick({datapoint:t,seriesIndex:t.seriesIndex})}const V=c(null),E=c(!1),$=c(null);function me({datapoint:t,seriesIndex:o}){N.value=!1,$.value=null,e.value.events.datapointLeave&&e.value.events.datapointLeave({datapoint:t,seriesIndex:t.seriesIndex})}function ke({datapoint:t,seriesIndex:o}){if(e.value.events.datapointEnter&&e.value.events.datapointEnter({datapoint:t,seriesIndex:t.seriesIndex}),!e.value.style.tooltip.show)return;V.value={datapoint:t,seriesIndex:o,config:e.value,series:B.value},N.value=!0,$.value=o;const l=e.value.style.tooltip.customFormat;if(ze(l))try{const a=l({seriesIndex:t.seriesIndex,datapoint:t,series:B.value,config:e.value});typeof a=="string"&&(P.value=a,E.value=!0)}catch(a){console.warn("Custom format cannot be applied."),E.value=!1}if(!E.value){let a="";a+='<div style="width:100%;text-align:center;border-bottom:1px solid '.concat(e.value.style.tooltip.borderColor,';padding-bottom:6px;margin-bottom:3px;">').concat(t.name,"</div>"),a+='<div style="display:flex;flex-direction:row;gap:6px;align-items:center;"><svg viewBox="0 0 12 12" height="14" width="14"><circle cx="6" cy="6" r="6" stroke="none" fill="'.concat(t.color,'"/></svg>'),a+="<b>".concat(t.proportionLabel,"</b>"),a+="<span>(".concat(ie(e.value.style.legend.value.formatter,t.value,j({p:e.value.style.legend.value.prefix,v:t.value,s:e.value.style.legend.value.suffix,r:e.value.style.legend.value.rounding}),{datapoint:t,seriesIndex:o}),")</span>"),P.value="<div>".concat(a,"</div>")}}return(t,o)=>(r(),s("div",{class:"vue-data-ui-component vue-ui-spark-stackbar",ref_key:"sparkstackbarChart",ref:G,style:p("width:100%; background:".concat(e.value.style.backgroundColor))},[e.value.style.title.text?(r(),s("div",{key:0,style:p("width:calc(100% - 12px);background:transparent;margin:0 auto;margin:".concat(e.value.style.title.margin,";padding: 0 6px;text-align:").concat(e.value.style.title.textAlign))},[v("div",{class:"atom-title",style:p("font-size:".concat(e.value.style.title.fontSize,"px;color:").concat(e.value.style.title.color,";font-weight:").concat(e.value.style.title.bold?"bold":"normal"))},I(e.value.style.title.text),5),e.value.style.title.subtitle.text?(r(),s("div",{key:0,class:"atom-subtitle",style:p("font-size:".concat(e.value.style.title.subtitle.fontSize,"px;color:").concat(e.value.style.title.subtitle.color,";font-weight:").concat(e.value.style.title.subtitle.bold?"bold":"normal"))},I(e.value.style.title.subtitle.text),5)):f("",!0)],4)):f("",!0),(r(),s("svg",{ref_key:"svgRef",ref:ye,xmlns:d(Fe),width:"100%",viewBox:"0 0 ".concat(g.value.width," ").concat(g.value.height)},[Z(d(ve)),v("defs",null,[(r(!0),s(b,null,A(D.value,(l,a)=>(r(),s("linearGradient",{key:"stack_gradient_".concat(a),gradientTransform:"rotate(90)",id:"stack_gradient_".concat(a,"_").concat(z.value)},[v("stop",{offset:"0%","stop-color":l.color},null,8,Re),v("stop",{offset:"50%","stop-color":d(re)(d(se)(l.color,.05),100-e.value.style.bar.gradient.intensity)},null,8,Te),v("stop",{offset:"100%","stop-color":l.color},null,8,Ve)],8,Pe))),128)),v("clipPath",Me,[v("rect",{x:"0.005",y:"-2",width:"0.99",height:"5",rx:"3",ry:"3",fill:e.value.style.backgroundColor},null,8,je)])]),q.value>0?(r(),s("g",Ge,[(r(!0),s(b,null,A(D.value,(l,a)=>(r(),s("rect",{key:"stack_underlayer_".concat(a),x:l.start,y:0,width:l.width,height:g.value.height,fill:e.value.style.bar.gradient.underlayerColor,class:L({animated:!C.value&&!d(w)}),style:p({opacity:$.value!==null&&e.value.style.tooltip.show?$.value===a?1:.5:1})},null,14,Ue))),128)),(r(!0),s(b,null,A(D.value,(l,a)=>(r(),s("rect",{key:"stack_".concat(a),x:l.start,y:0,width:l.width,height:g.value.height,fill:e.value.style.bar.gradient.show?"url(#stack_gradient_".concat(a,"_").concat(z.value,")"):l.color,stroke:e.value.style.backgroundColor,"stroke-linecap":"round",class:L({animated:!C.value&&!d(w)}),style:p({opacity:$.value!==null&&e.value.style.tooltip.show?$.value===a?1:.5:1})},null,14,Ye))),128)),(r(!0),s(b,null,A(D.value,(l,a)=>(r(),s("rect",{key:"stack_trap_".concat(a),x:l.start,y:0,width:l.width,height:g.value.height,fill:"transparent",stroke:"none",class:L({animated:!C.value&&!d(w)}),onClick:()=>Q(l,a),onMouseenter:()=>ke({datapoint:l,seriesIndex:a}),onMouseleave:h=>me({datapoint:l,seriesIndex:a})},null,42,We))),128))])):(r(),s("rect",{key:1,x:2,y:1,width:g.value.width-4,height:g.value.height-2,stroke:"#CCCCCC","stroke-width":"2",fill:"transparent",rx:(g.value.height-4)/2},null,8,qe))],8,Ne)),e.value.style.legend.show?(r(),s("div",{key:1,style:p("background:transparent;margin:0 auto;margin:".concat(e.value.style.legend.margin,";justify-content:").concat(e.value.style.legend.textAlign==="left"?"flex-start":e.value.style.legend.textAlign==="right"?"flex-end":"center")),class:"vue-ui-sparkstackbar-legend"},[(r(!0),s(b,null,A(B.value,(l,a)=>(r(),s("div",{style:p("font-size:".concat(e.value.style.legend.fontSize,"px;")),class:L({"vue-ui-sparkstackbar-legend-item":!0,"vue-ui-sparkstackbar-legend-item-unselected":y.value.includes(a)}),onClick:h=>{fe(a),Q(l,a,!0)}},[v("div",He,[(r(),s("svg",{height:"".concat(e.value.style.legend.fontSize,"px"),width:"".concat(e.value.style.legend.fontSize,"px"),viewBox:"0 0 10 10"},[v("defs",null,[v("radialGradient",{id:"legend_grad_".concat(a,"-").concat(z.value)},[v("stop",{offset:"0%","stop-color":d(w)?"#FFFFFF":d(re)(d(se)(l.color,.05),100-e.value.style.bar.gradient.intensity)},null,8,Ke),v("stop",{offset:"100%","stop-color":l.color},null,8,Xe)],8,Ze)]),v("circle",{cx:5,cy:5,r:5,fill:e.value.style.bar.gradient.show?"url(#legend_grad_".concat(a,"-").concat(z.value,")"):l.color},null,8,et)],8,Je)),d(w)?f("",!0):(r(),s(b,{key:0},[v("span",{style:p("color:".concat(e.value.style.legend.name.color,"; font-weight:").concat(e.value.style.legend.name.bold?"bold":"normal"))},I(l.name),5),C.value?f("",!0):(r(),s(b,{key:0},[e.value.style.legend.percentage.show?(r(),s("span",{key:0,style:p("font-weight:".concat(e.value.style.legend.percentage.bold?"bold":"normal",";color:").concat(e.value.style.legend.percentage.color))},I(y.value.includes(a)?" - ":l.proportionLabel),5)):f("",!0),e.value.style.legend.value.show?(r(),s("span",{key:1,style:p("font-weight:".concat(e.value.style.legend.value.bold?"bold":"normal",";color:").concat(e.value.style.legend.value.color))}," ("+I(d(ie)(e.value.style.legend.value.formatter,l.value,d(j)({p:e.value.style.legend.value.prefix,v:l.value,s:e.value.style.legend.value.suffix,r:e.value.style.legend.value.rounding}),{datapoint:l,seriesIndex:a}))+") ",5)):f("",!0)],64))],64))])],14,Qe))),256))],4)):f("",!0),Z(d(ce),{show:N.value&&e.value.style.tooltip.show,parent:G.value,backgroundColor:e.value.style.tooltip.backgroundColor,color:e.value.style.tooltip.color,fontSize:e.value.style.tooltip.fontSize,borderRadius:e.value.style.tooltip.borderRadius,borderColor:e.value.style.tooltip.borderColor,borderWidth:e.value.style.tooltip.borderWidth,backgroundOpacity:e.value.style.tooltip.backgroundOpacity,position:e.value.style.tooltip.position,content:P.value,isCustom:E.value,offsetY:-124+e.value.style.tooltip.offsetY,blockShiftY:!0,smooth:e.value.style.tooltip.smooth,backdropFilter:e.value.style.tooltip.backdropFilter,smoothForce:e.value.style.tooltip.smoothForce,smoothSnapThreshold:e.value.style.tooltip.smoothSnapThreshold},{"tooltip-before":X(()=>[M(t.$slots,"tooltip-before",ee(te({...V.value})),void 0,!0)]),"tooltip-after":X(()=>[M(t.$slots,"tooltip-after",ee(te({...V.value})),void 0,!0)]),_:3},8,["show","parent","backgroundColor","color","fontSize","borderRadius","borderColor","borderWidth","backgroundOpacity","position","content","isCustom","offsetY","smooth","backdropFilter","smoothForce","smoothSnapThreshold"]),t.$slots.source?(r(),s("div",tt,[M(t.$slots,"source",{},void 0,!0)],512)):f("",!0),d(w)?(r(),we(Le,{key:3})):f("",!0)],4))}},ct=Ce(lt,[["__scopeId","data-v-ae2ae4f4"]]);export{ct as default};
