
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as ie,aN as ce,e as de,K as fe,L as pe,bQ as he,a0 as me,bd as ve,g as P,ac as q,bR as _e,M as be,a1 as Z,a2 as _,Z as ge,a3 as ye,bS as A,N as z,o as h,m as b,l as r,c as k,a as l,R as W,S as X,n as Y,O as N,P as xe,p as w,G as ee,k as m,w as ke,aP as T,aF as V,v as we,bC as Re,b7 as Se}from"./index-Bnionyve.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js";import{m as te}from"./index-Cm0HenuK.js";import Ce from"./index-CAGKFdhm.js";import{_ as Ie}from"./item.vue_vue_type_script_setup_true_lang-Cx1MIO9V.js";const ze={class:"h-12 flex flex-shrink-0 items-center"},Ne={class:"h-full w-14 flex-center"},Te=["placeholder","onKeydown"],Ve={key:0,class:"h-full w-14 flex-center border-s"},Ee={class:"w-full flex justify-between px-4 py-3"},Be={class:"flex gap-8"},Le={class:"inline-flex items-center gap-1 text-xs"},$e={class:"inline-flex items-center gap-1 text-xs"},Fe={key:0,class:"inline-flex items-center gap-1 text-xs"},He=["data-index","onClick","onMouseover"],Ue={class:"flex flex-1 flex-col gap-1 truncate border-s px-4 py-3"},De={class:"truncate text-start text-base font-bold"},Ke={key:1,class:"h-full flex-col-center py-6 text-secondary-foreground/50"},Pe={class:"m-2 text-base"},qe={key:2,class:"h-full flex-col-center py-6 text-secondary-foreground/50"},Oe={class:"m-2 text-base"},je=ie({name:"NavSearchModal",__name:"search",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(E){const c=ce(E,"modelValue"),{t:R}=de(),ne=fe(),M=pe(),B=he(),ae=me(),{generateI18nTitle:S}=ve(),f=P(""),O=q("searchInputRef"),{focused:le}=_e(O),L=P([]),o=P(-1),$=q("searchResultRef"),C=q("searchResultItemRef"),g=be(()=>{let a=[];return a=L.value.filter(e=>{var n,i;let t=!1;return f.value!==""&&(e.path.includes(f.value)&&(t=!0),(S(e.title).toString().includes(f.value)||((i=(n=te(S(e.title).toString(),f.value,{continuous:!0}))==null?void 0:n.length)!=null?i:0)>0)&&(t=!0),B.getRouteMatchedByPath(e.path).some(s=>{var u,d,v,p;return S((u=s.meta)==null?void 0:u.title).toString().includes(f.value)||((p=(v=te(S((d=s.meta)==null?void 0:d.title).toString(),f.value,{continuous:!0}))==null?void 0:v.length)!=null?p:0)>0})&&(t=!0)),t}),a});Z(()=>c.value,a=>{a?(f.value="",o.value=-1,_("up",F),_("down",H),_("enter",U),_("esc",e=>{M.settings.navSearch.enableHotkeys&&(e.preventDefault(),c.value=!1)})):(_.unbind("up",F),_.unbind("down",H),_.unbind("enter",U),_.unbind("esc"))}),Z(()=>g.value,()=>{o.value=-1,D()}),ge(()=>{oe(),_("command+k, ctrl+k",a=>{M.settings.navSearch.enableHotkeys&&(a.preventDefault(),c.value=!0)})}),ye(()=>{_.unbind("command+k, ctrl+k")});function oe(){L.value=[],ae.allMenus.forEach(a=>{j(a.children)})}function re(a){var t;let e=!0;return(t=a.children)!=null&&t.every(n=>{var i;return((i=n.meta)==null?void 0:i.menu)===!1})&&(e=!1),e}function j(a,e,t){a.forEach(n=>{var i,s,u,d,v,p,y,x;((i=n.meta)==null?void 0:i.menu)!==!1&&(n.children&&re(n)?j(n.children,A(e,n.path),(u=(s=n.meta)==null?void 0:s.icon)!=null?u:t):L.value.push({path:A(e,n.path),query:(d=n.meta)==null?void 0:d.query,icon:(p=(v=n.meta)==null?void 0:v.icon)!=null?p:t,title:(y=n.meta)==null?void 0:y.title,link:(x=n.meta)==null?void 0:x.link}))})}function F(){g.value.length&&(o.value-=1,o.value<0&&(o.value=g.value.length-1),D())}function H(){g.value.length&&(o.value+=1,o.value>g.value.length-1&&(o.value=0),D())}function U(){var a,e;o.value!==-1&&((e=(a=C.value)==null?void 0:a.find(t=>Number.parseInt(t.dataset.index)===o.value))==null||e.click())}function D(){var a,e,t,n,i,s,u,d,v,p;if((n=(t=(e=(a=$.value)==null?void 0:a.areaRef)==null?void 0:e.ref)==null?void 0:t.el)!=null&&n.viewportElement){const y=$.value.areaRef.ref.el.viewportElement;let x=0;if(o.value!==-1){x=y.scrollTop;const I=(u=(s=(i=C.value)==null?void 0:i.find(K=>Number.parseInt(K.dataset.index)===o.value))==null?void 0:s.offsetTop)!=null?u:0,G=(p=(v=(d=C.value)==null?void 0:d.find(K=>Number.parseInt(K.dataset.index)===o.value))==null?void 0:v.clientHeight)!=null?p:0,J=y.scrollTop,Q=y.clientHeight;I+G>J+Q?x=I+G-Q:I<=J&&(x=I-16)}y.scrollTo({top:x})}}function ue(a,e,t){t?window.open(t,"_blank"):ne.push({path:a,query:e}),c.value=!1}return(a,e)=>{const t=xe,n=Me,i=Se;return h(),z(i,{ref_key:"searchResultRef",ref:$,modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=s=>c.value=s),border:"",footer:l(M).mode==="pc",closable:!1,class:"w-full lg-max-w-2xl","content-class":"flex flex-col p-0 min-h-auto","header-class":"p-0","footer-class":"p-0",onOpened:e[4]||(e[4]=s=>le.value=!0)},{header:b(()=>[r("div",ze,[r("div",Ne,[m(t,{name:"i-ri:search-line",class:"size-4 text-foreground/30"})]),ke(r("input",{ref_key:"searchInputRef",ref:O,"onUpdate:modelValue":e[0]||(e[0]=s=>we(f)?f.value=s:null),placeholder:l(R)("input"),class:"h-full w-full border-0 rounded-md bg-transparent text-base text-foreground focus-outline-none placeholder-foreground/30",onKeydown:[e[1]||(e[1]=T(V(s=>c.value=!1,["prevent"]),["esc"])),T(V(F,["prevent"]),["up"]),T(V(H,["prevent"]),["down"]),T(V(U,["prevent"]),["enter"])]},null,40,Te),[[Re,l(f)]]),l(M).mode==="mobile"?(h(),k("div",Ve,[m(t,{name:"i-carbon:close",class:"size-4",onClick:e[2]||(e[2]=s=>c.value=!1)})])):N("",!0)])]),footer:b(()=>[r("div",Ee,[r("div",Be,[r("div",Le,[m(n,null,{default:b(()=>[m(t,{name:"i-ion:md-return-left",class:"size-4"})]),_:1}),r("span",null,w(l(R)("enter")),1)]),r("div",$e,[m(n,null,{default:b(()=>[m(t,{name:"i-ant-design:caret-up-filled",class:"size-4"})]),_:1}),m(n,null,{default:b(()=>[m(t,{name:"i-ant-design:caret-down-filled",class:"size-4"})]),_:1}),r("span",null,w(l(R)("up_down")),1)])]),l(M).settings.navSearch.enableHotkeys?(h(),k("div",Fe,[m(n,null,{default:b(()=>[...e[5]||(e[5]=[ee(" ESC ",-1)])]),_:1}),r("span",null,w(l(R)("esc")),1)])):N("",!0)])]),default:b(()=>[r("div",null,[l(g).length>0?(h(!0),k(W,{key:0},X(l(g),(s,u)=>(h(),k("div",{ref_for:!0,ref_key:"searchResultItemRef",ref:C,key:s.path,class:"p-4","data-index":u,onClick:d=>ue(s.path,s.query,s.link),onMouseover:d=>o.value=u},[r("a",{class:Y(["flex cursor-pointer items-center border rounded-lg",{"-mt-4":u!==0,"bg-accent":u===l(o)}])},[s.icon?(h(),z(t,{key:0,name:s.icon,class:Y(["size-5 basis-16 transition",{"scale-120 text-primary":u===l(o)}])},null,8,["name","class"])):N("",!0),r("div",Ue,[r("div",De,w(l(S)(s.title)),1),l(B).getRouteMatchedByPath(s.path).length?(h(),z(Ce,{key:0,class:"truncate"},{default:b(()=>[(h(!0),k(W,null,X(l(B).getRouteMatchedByPath(s.path),(d,v)=>(h(),z(Ie,{key:v,class:"text-xs"},{default:b(()=>{var p;return[ee(w(l(S)((p=d.meta)==null?void 0:p.title)),1)]}),_:2},1024))),128))]),_:2},1024)):N("",!0)])],2)],40,He))),128)):l(f)===""?(h(),k("div",Ke,[m(t,{name:"i-tabler:mood-smile",class:"size-10"}),r("p",Pe,w(l(R)("welcome")),1)])):(h(),k("div",qe,[m(t,{name:"i-tabler:mood-empty",class:"size-10"}),r("p",Oe,w(l(R)("empty")),1)]))])]),_:1},8,["modelValue","footer"])}}});function se(E){const c=E;c.__i18n=c.__i18n||[],c.__i18n.push({locale:"",resource:{"zh-cn":{input:{t:0,b:{t:2,i:[{t:3}],s:"支持标题、拼音(首字母)、URL模糊查询"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"输入你要搜索的导航"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"没有找到你想要的"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"切换"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"访问"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"退出"}}},"zh-tw":{input:{t:0,b:{t:2,i:[{t:3}],s:"支持標題、拼音(首字母)、URL模糊查詢"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"輸入你要搜索的導航"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"沒有找到你想要的"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"切換"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"訪問"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"退出"}}},en:{input:{t:0,b:{t:2,i:[{t:3}],s:"Support title, URL fuzzy query"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"Enter the navigation you want to search"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"Not found"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"Choice"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"Enter"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"Exit"}}}}})}typeof se=="function"&&se(je);export{je as default};
