
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as S,n as m,N as B,O as $,P as K,c as M,o as v,A as L,e as T,B as U,F as w,q as W,b as j,l as z,v as D,C as G}from"./index-H6QnEWHf.js";import{r as H,I as J}from"./item-DR3E2Ae_.js";import{_ as Q}from"./sub.vue_vue_type_script_setup_true_lang-DGeZmas8.js";const Z=S({name:"MainMenu",__name:"index",props:{menu:{},value:{},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1},dark:{type:Boolean,default:!1},direction:{default:"ltr"}},setup(x){const u=x,I=new WeakMap;function f(e){return I.has(e)||I.set(e,D()),I.get(e)}const s=m(u.value),o=m({}),t=m({}),c=m([]),N=m([]);function E(e,l=[]){e.forEach(a=>{var h,d;const n=(h=a.path)!=null?h:f(a);if((d=a.children)!=null&&d.some(i=>{var p;return((p=i.meta)==null?void 0:p.menu)!==!1})){const i=[...l,n];t.value[n]={index:n,indexPath:i,active:!1},E(a.children,i)}else o.value[n]={index:n,indexPath:l}})}const C=e=>{c.value.includes(e)||c.value.push(e)},k=e=>{if(Array.isArray(e)){G(()=>{k(e.at(-1)),e.length>1&&k(e.slice(0,-1))});return}Object.keys(t.value).forEach(l=>{t.value[l].indexPath.includes(e)&&(c.value=c.value.filter(a=>a!==e))})};function P(e){var l,a;for(const n in t.value)t.value[n].active=!1;(l=t.value[e])==null||l.indexPath.forEach(n=>{t.value[n].active=!0}),(a=o.value[e])==null||a.indexPath.forEach(n=>{t.value[n].active=!0})}const b=e=>{(u.mode==="horizontal"||u.collapse)&&(c.value=[]),P(e)},F=e=>{c.value.includes(e)?k(e):C(e)};function _(){const e=s.value&&o.value[s.value];P(s.value),!(!e||u.collapse)&&e.indexPath.forEach(l=>{t.value[l]&&C(l)})}return B(()=>u.menu,e=>{E(e),_()},{deep:!0,immediate:!0}),B(()=>u.value,e=>{o.value[e]||(s.value="");const l=o.value[e]||s.value&&o.value[s.value]||o.value[u.value];l?s.value=l.index:s.value=e,_()}),B(()=>u.collapse,e=>{e&&(c.value=[]),_()}),$(H,K({props:u,items:o,subMenus:t,activeIndex:s,openedMenus:c,mouseInMenu:N,openMenu:C,closeMenu:k,handleMenuItemClick:b,handleSubMenuClick:F,getUseId:f})),(e,l)=>(v(),M("div",{class:L(T(U)("h-full w-full flex flex-col of-hidden",{"flex-row w-auto":u.mode==="horizontal","py-1":u.mode==="vertical"}))},[(v(!0),M(w,null,W(x.menu,a=>{var n,h,d,i,p,g;return v(),M(w,{key:(n=a.path)!=null?n:f(a)},[((h=a.meta)==null?void 0:h.menu)!==!1?(v(),M(w,{key:0},[(d=a.children)!=null&&d.length?(v(),z(Q,{key:0,menu:a,"unique-key":[(i=a.path)!=null?i:a.children.every(y=>{var r;return((r=y.meta)==null?void 0:r.menu)===!1})?a.children[0].path:f(a)]},null,8,["menu","unique-key"])):(v(),z(J,{key:1,item:a,"unique-key":[(g=a.path)!=null?g:(p=a.children)!=null&&p.every(y=>{var r;return((r=y.meta)==null?void 0:r.menu)===!1})?a.children[0].path:f(a)],onClick:y=>{var r,q;return b((q=a.path)!=null?q:(r=a.children)!=null&&r.every(O=>{var A;return((A=O.meta)==null?void 0:A.menu)===!1})?a.children[0].path:f(a))}},null,8,["item","unique-key","onClick"]))],64)):j("",!0)],64)}),128))],2))}});export{Z as _};
