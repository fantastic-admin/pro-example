
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{_ as ue}from"./index.vue_vue_type_script_setup_true_lang-Dq4MN271.js";import{d as fe,s as pe,n as N,a7 as me,N as F,r as u,aw as ge,c as w,o as b,g as a,f as D,w as s,i as V,am as ve,l as $,b as S,e as i,W as he,_ as _e,t as T,at as B,p as be,b5 as z,L as I,h as ye,k as A}from"./index-H6QnEWHf.js";import{a as x}from"./dictionary-2rfPmV2q.js";import Ce from"./index-rmZRMk5z.js";import xe from"./index-CfXD3YZi.js";import{_ as Ee}from"./index.vue_vue_type_script_setup_true_lang-z3DPDC4I.js";import{u as ke}from"./usePagination-Ci1eRh1x.js";const De={class:"absolute size-full flex flex-col"},Ve={class:"flex-1 overflow-auto"},Le={class:"custom-tree-node"},$e=["title"],ze={class:"code"},Ie={class:"actions"},Ne={key:0,class:"contents"},we={key:1,class:"flex-center flex-1 text-3xl text-primary/50"},G=fe({name:"PagesExampleDictionary",__name:"index",setup(Se){const P=pe("dictionaryRef"),l=N({search:"",tree:[],currentNode:void 0,currentData:void 0,dialog:{visible:!1,parentId:"",id:""}}),{pagination:p,getParams:H,onSizeChange:W,onCurrentChange:j,onSortChange:q}=ke();p.value.size=20,p.value.sizes=[20,50,100];const o=N({loading:!1,search:{dictionaryId:"",title:""},dataList:[],selectionDataList:[],dialog:{visible:!1,id:""}});function U(){o.value.search.dictionaryId="",x.list().then(e=>{l.value.tree=e.data})}me(()=>{U()}),F(()=>l.value.search,e=>{var t;(t=P.value)==null||t.filter(e)});function J(e,t){return e?t.label.includes(e):!0}function M(e){var t;l.value.currentData=e,l.value.dialog.parentId=(t=e==null?void 0:e.id)!=null?t:"",l.value.dialog.id="",l.value.dialog.visible=!0}function K(e,t){var d,f;l.value.currentNode=e,l.value.currentData=t,l.value.dialog.parentId=(f=(d=e.parent)==null?void 0:d.data.id)!=null?f:"",l.value.dialog.id=t.id,l.value.dialog.visible=!0}function O(e,t){z.confirm("确认删除「".concat(t.label,"」吗？"),"确认信息").then(()=>{x.delete(t.id).then(()=>{I.success("模拟删除成功");const d=e.parent,f=(d==null?void 0:d.data.children)||(d==null?void 0:d.data),r=f.findIndex(c=>c.id===t.id);f.splice(r,1),l.value.tree=[...l.value.tree]})})}function Q(e){l.value.currentData?(l.value.currentData.children||(l.value.currentData.children=[]),l.value.currentData.children.push({id:e.id,label:e.label,code:e.code})):l.value.tree.push({id:e.id,label:e.label,code:e.code})}function X(e,t){var d,f;if(l.value.currentNode&&l.value.currentData)if(((f=(d=l.value.currentNode.parent)==null?void 0:d.data.id)!=null?f:"")===t)l.value.currentData.label=e.label,l.value.currentData.code=e.code;else{const r=l.value.currentNode.parent,c=(r==null?void 0:r.data.children)||(r==null?void 0:r.data),g=c.findIndex(y=>y.id===e.id);if(c[g].label=e.label,c[g].code=e.code,t){const y=(_,v)=>{for(const C in _){if(_[C].id===v)return _[C];if(_[C].children){const L=y(_[C].children,v);if(L)return L}}},k=y(l.value.tree,t);k.children||(k.children=[]),k.children.push(c[g])}else l.value.tree.push(c[g]);c.splice(g,1)}}function Y(e){p.value.page=1,o.value.search.dictionaryId=e.id}F(()=>o.value.search.dictionaryId,()=>{m()});function m(){o.value.loading=!0;const e={...H(),dictionary_id:o.value.search.dictionaryId,...o.value.search.title&&{title:o.value.search.title}};x.itemList(e).then(t=>{o.value.loading=!1,o.value.dataList=t.data.list,o.value.dataList.forEach(d=>{d.enableLoading=!1}),p.value.total=t.data.total})}function Z(e){return new Promise(t=>{z.confirm("确认".concat(e.enable?"禁用":"启用","「").concat(e.name,"」吗？"),"确认信息").then(()=>{e.enableLoading=!0,x.itemChangeEnable({id:e.id,enable:!e.enable}).then(()=>(e.enableLoading=!1,I.success("模拟".concat(e.enable?"禁用":"启用","成功")),t(!0))).catch(()=>(e.enableLoading=!1,t(!1)))}).catch(()=>t(!1))})}function ee(e){W(e).then(()=>m())}function te(e=1){j(e).then(()=>m())}function le({prop:e,order:t}){q(e,t).then(()=>m())}function ae(){o.value.dialog.id="",o.value.dialog.visible=!0}function ie(e){o.value.dialog.id=e.id,o.value.dialog.visible=!0}function ne(e){z.confirm("确认删除「".concat(e.name,"」吗？"),"确认信息").then(()=>{x.itemDelete(e.id).then(()=>{m(),I.success("模拟删除成功")})}).catch(()=>{})}function oe(e){z.confirm("确认删除选中的 ".concat(e.length," 条数据吗？"),"确认信息").then(()=>{x.itemDelete(e.map(t=>t.id)).then(()=>{m(),I.success("模拟删除成功")})}).catch(()=>{})}const E=N(!1);return(e,t)=>{const d=u("ElButton"),f=ve,r=_e,c=u("ElButtonGroup"),g=u("ElInput"),y=u("ElTree"),k=u("ElScrollbar"),_=u("ElSpace"),v=u("ElTableColumn"),C=u("ElTag"),L=u("ElSwitch"),de=u("ElTable"),se=u("ElPagination"),re=ue,ce=ge("loading");return b(),w("div",De,[a(f,{title:"字典管理",description:"页面数据为 Mock 示例数据，非真实数据。",class:"mb-0"},{default:s(()=>[a(d,{onClick:t[0]||(t[0]=n=>E.value=!0)},{default:s(()=>[...t[9]||(t[9]=[V(" 使用示例 ",-1)])]),_:1})]),_:1}),D("div",Ve,[a(re,{"hide-left-side-toggle":"",class:"static","left-side-class":"h-full flex flex-col gap-4","default-class":"flex flex-col flex-1 gap-4"},{leftSide:s(()=>[a(c,{class:"inline-flex"},{default:s(()=>[a(d,{type:"primary",class:"w-full",onClick:t[1]||(t[1]=n=>M())},{default:s(()=>[...t[10]||(t[10]=[V(" 新增字典 ",-1)])]),_:1}),a(d,{onClick:U},{icon:s(()=>[a(r,{name:"i-ep:refresh"})]),_:1})]),_:1}),a(g,{modelValue:i(l).search,"onUpdate:modelValue":t[2]||(t[2]=n=>i(l).search=n),placeholder:"请输入关键词筛选字典",clearable:""},null,8,["modelValue"]),a(k,{class:"tree"},{default:s(()=>[a(y,{ref_key:"dictionaryRef",ref:P,data:i(l).tree,"filter-node-method":J,"default-expand-all":"",onNodeClick:Y},{default:s(({node:n,data:h})=>[D("div",Le,[D("div",{class:"label",title:n.label},T(n.label),9,$e),D("div",ze,T(h.code),1),D("div",Ie,[a(c,null,{default:s(()=>[a(d,{type:"primary",plain:"",size:"default",onClick:B(R=>M(h),["stop"])},{icon:s(()=>[a(r,{name:"i-ep:plus"})]),_:1},8,["onClick"]),a(d,{type:"info",plain:"",size:"default",onClick:B(R=>K(n,h),["stop"])},{icon:s(()=>[a(r,{name:"i-ep:edit"})]),_:1},8,["onClick"]),a(d,{type:"danger",plain:"",size:"default",onClick:B(R=>O(n,h),["stop"])},{icon:s(()=>[a(r,{name:"i-ep:delete"})]),_:1},8,["onClick"])]),_:2},1024)])])]),_:1},8,["data","filter-node-method"])]),_:1})]),default:s(()=>[i(o).search.dictionaryId?(b(),w("div",Ne,[a(_,{wrap:""},{default:s(()=>[a(d,{type:"primary",onClick:ae},{icon:s(()=>[a(r,{name:"i-ep:plus"})]),_:1}),a(d,{type:"danger",disabled:!i(o).selectionDataList.length,onClick:t[3]||(t[3]=n=>oe(i(o).selectionDataList))},{icon:s(()=>[a(r,{name:"i-ep:delete"})]),_:1},8,["disabled"]),a(g,{modelValue:i(o).search.title,"onUpdate:modelValue":t[4]||(t[4]=n=>i(o).search.title=n),placeholder:"请输入关键词筛选字典项",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),a(d,{onClick:m},{icon:s(()=>[a(r,{name:"i-ep:search"})]),_:1})]),_:1}),he((b(),$(de,{data:i(o).dataList,stripe:"","highlight-current-row":"",border:"",height:"100%",onSortChange:le,onSelectionChange:t[5]||(t[5]=n=>i(o).selectionDataList=n)},{default:s(()=>[a(v,{type:"selection",align:"center",fixed:""}),a(v,{prop:"name",label:"名称"}),a(v,{label:"键值",align:"center",width:"150"},{default:s(n=>[a(C,{type:"info"},{default:s(()=>[V(T(n.row.value),1)]),_:2},1024)]),_:1}),a(v,{label:"状态",width:"100",align:"center"},{default:s(n=>[a(L,{modelValue:n.row.enable,"onUpdate:modelValue":h=>n.row.enable=h,loading:n.row.enableLoading,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>Z(n.row)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])]),_:1}),a(v,{label:"操作",width:"200",align:"center"},{default:s(n=>[a(d,{type:"primary",size:"small",plain:"",onClick:h=>ie(n.row)},{default:s(()=>[...t[11]||(t[11]=[V(" 编辑 ",-1)])]),_:1},8,["onClick"]),a(d,{type:"danger",size:"small",plain:"",onClick:h=>ne(n.row)},{default:s(()=>[...t[12]||(t[12]=[V(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ce,i(o).loading]]),a(se,{"current-page":i(p).page,total:i(p).total,"page-size":i(p).size,"page-sizes":i(p).sizes,layout:i(p).layout,"hide-on-single-page":!1,class:"pagination",background:"",onSizeChange:ee,onCurrentChange:te},null,8,["current-page","total","page-size","page-sizes","layout"])])):(b(),w("div",we," 请在左侧新增或选择一个字典 "))]),_:1}),i(l).dialog.visible?(b(),$(Ce,{key:0,id:i(l).dialog.id,modelValue:i(l).dialog.visible,"onUpdate:modelValue":t[6]||(t[6]=n=>i(l).dialog.visible=n),"parent-id":i(l).dialog.parentId,tree:i(l).tree,onAddNode:Q,onEditNode:X},null,8,["id","modelValue","parent-id","tree"])):S("",!0),i(o).dialog.visible?(b(),$(xe,{key:1,id:i(o).dialog.id,modelValue:i(o).dialog.visible,"onUpdate:modelValue":t[7]||(t[7]=n=>i(o).dialog.visible=n),"dictionary-id":i(o).search.dictionaryId,tree:i(l).tree,onSuccess:m},null,8,["id","modelValue","dictionary-id","tree"])):S("",!0),i(E)?(b(),$(Ee,{key:2,modelValue:i(E),"onUpdate:modelValue":t[8]||(t[8]=n=>be(E)?E.value=n:null)},null,8,["modelValue"])):S("",!0)])])}}});typeof A=="function"&&A(G);const Ae=ye(G,[["__scopeId","data-v-d02f47ac"]]);export{Ae as default};
