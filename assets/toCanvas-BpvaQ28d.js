
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{l as b}from"./index-CVFwfjqr.js";import"./index-H6QnEWHf.js";import"./index.vue_vue_type_script_setup_true_lang-CfFfwFlx.js";import"./index.vue_vue_type_script_setup_true_lang-KWURIfPl.js";import"./index.vue_vue_type_script_setup_true_lang-CW0fgqfj.js";import"./index.vue_vue_type_script_setup_true_lang-BoQ-Tlfp.js";import"./index.vue_vue_type_script_setup_true_lang-BnHOlB0K.js";import"./useGraceArea-DMfrKGwH.js";import"./clamp-BstbYvQo.js";import"./useFormControl-Su_HZn2q.js";import"./VisuallyHiddenInput-CUkjjV_e.js";import"./index-ClELmDgR.js";function C(e){return typeof e=="string"&&/^data:image\/svg\+xml/i.test(e)}function M(e){let r=e.indexOf(",");return r>=0?decodeURIComponent(e.slice(r+1)):""}function v(e){return"data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(e))}function F(e){let r=[],t="",i=0;for(let a=0;a<e.length;a++){let n=e[a];n==="("&&i++,n===")"&&(i=Math.max(0,i-1)),n===";"&&i===0?(r.push(t),t=""):t+=n}return t.trim()&&r.push(t),r.map(a=>a.trim()).filter(Boolean)}function k(e){let r=[],t="",i=0;for(let n=0;n<e.length;n++){let s=e[n];s==="("&&i++,s===")"&&(i=Math.max(0,i-1)),s===","&&i===0?(r.push(t.trim()),t=""):t+=s}t.trim()&&r.push(t.trim());let a=[];for(let n of r){if(/\binset\b/i.test(n))continue;let s=n.match(/-?\d+(?:\.\d+)?px/gi)||[],[l="0px",o="0px",p="0px"]=s,u=n.replace(/-?\d+(?:\.\d+)?px/gi,"").replace(/\binset\b/ig,"").trim().replace(/\s{2,}/g," "),d=!!u&&u!==",";a.push("drop-shadow(".concat(l," ").concat(o," ").concat(p).concat(d?" ".concat(u):"",")"))}return a.join(" ")}function y(e){let r=F(e),t=null,i=null,a=null,n=[];for(let l of r){let o=l.indexOf(":");if(o<0)continue;let p=l.slice(0,o).trim().toLowerCase(),u=l.slice(o+1).trim();p==="box-shadow"?a=u:p==="filter"?t=u:p==="-webkit-filter"?i=u:n.push([p,u])}if(a){let l=k(a);l&&(t=t?"".concat(t," ").concat(l):l,i=i?"".concat(i," ").concat(l):l)}let s=[...n];return t&&s.push(["filter",t]),i&&s.push(["-webkit-filter",i]),s.map(([l,o])=>"".concat(l,":").concat(o)).join(";")}function I(e){return e.replace(/([^{}]+)\{([^}]*)\}/g,(r,t,i)=>"".concat(t,"{").concat(y(i),"}"))}function N(e){return e=e.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi,(r,t)=>r.replace(t,I(t))),e=e.replace(/style=(['"])([\s\S]*?)\1/gi,(r,t,i)=>"style=".concat(t).concat(y(i)).concat(t)),e}function S(e){if(!b()||!C(e))return e;try{let r=M(e),t=N(r);return v(t)}catch(r){return e}}async function A(e,r){let{width:t,height:i,scale:a=1,dpr:n=1,meta:s={},backgroundColor:l}=r;e=S(e);let o=new Image;o.loading="eager",o.decoding="sync",o.crossOrigin="anonymous",o.src=e,await o.decode();let p=o.naturalWidth,u=o.naturalHeight,d=Number.isFinite(s.w0)?s.w0:p,x=Number.isFinite(s.h0)?s.h0:u,m,c,$=Number.isFinite(t),w=Number.isFinite(i);if($&&w)m=Math.max(1,t),c=Math.max(1,i);else if($){let g=t/Math.max(1,d);m=t,c=x*g}else if(w){let g=i/Math.max(1,x);c=i,m=d*g}else m=p,c=u;m=m*a,c=c*a;let f=document.createElement("canvas");f.width=m*n,f.height=c*n,f.style.width="".concat(m,"px"),f.style.height="".concat(c,"px");let h=f.getContext("2d");return n!==1&&h.scale(n,n),l&&(h.save(),h.fillStyle=l,h.fillRect(0,0,m,c),h.restore()),h.drawImage(o,0,0,m,c),f}export{A as toCanvas};
