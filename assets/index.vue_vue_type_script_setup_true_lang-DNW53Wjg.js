
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as P,aB as U,bx as L,bF as J,bw as Q,x as y,n as G,N as A,by as W,l as b,o as g,w as x,M as $,g as O,e as l,S as N,bz as F,aS as X,a7 as Y,ae as Z,aG as S,C as ee,bG as te,bH as ae,bA as R,bB as le,B as z,bI as T,ap as K,aq as ne,v as oe,p as se,c as ue,F as re,q as de}from"./index-H6QnEWHf.js";import{V as ie}from"./VisuallyHiddenInput-CUkjjV_e.js";const[pe,ce]=W("PinInputRoot");var me=P({inheritAttrs:!1,__name:"PinInputRoot",props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},placeholder:{type:String,required:!1,default:""},mask:{type:Boolean,required:!1},otp:{type:Boolean,required:!1},type:{type:null,required:!1,default:"text"},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},id:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1},name:{type:String,required:!1},required:{type:Boolean,required:!1}},emits:["update:modelValue","complete"],setup(d,{emit:n}){var w;const t=d,o=n,{mask:u,otp:c,placeholder:_,type:i,disabled:p,dir:v}=U(t),{forwardRef:I}=L(),q=J(v),h=Q(t,"modelValue",o,{defaultValue:(w=t.defaultValue)!=null?w:[],passive:!0,deep:!0}),B=y(()=>Array.isArray(h.value)?[...h.value]:[]),V=G(new Set);function D(m){V.value.add(m)}const k=y(()=>t.type==="number"),M=y(()=>B.value.filter(f=>!!f||k.value&&f===0).length===V.value.size);return A(h,()=>{M.value&&o("complete",h.value)},{deep:!0}),ce({modelValue:h,currentModelValue:B,mask:u,otp:c,placeholder:_,type:i,dir:q,disabled:p,isCompleted:M,inputElements:V,onInputElementChange:D,isNumericMode:k}),(m,f)=>(g(),b(l(F),N(m.$attrs,{ref:l(I),dir:l(q),"data-complete":M.value?"":void 0,"data-disabled":l(p)?"":void 0}),{default:x(()=>{var e;return[$(m.$slots,"default",{modelValue:l(h)}),O(ie,{id:m.id,as:"input",feature:"focusable",tabindex:"-1",value:B.value.join(""),name:(e=m.name)!=null?e:"",disabled:l(p),required:m.required,onFocus:f[0]||(f[0]=a=>{var s,r;return(r=(s=Array.from(V.value))==null?void 0:s[0])==null?void 0:r.focus()})},null,8,["id","value","name","disabled","required"])]}),_:3},16,["dir","data-complete","data-disabled"]))}}),fe=me,ve=P({__name:"PinInputInput",props:{index:{type:Number,required:!0},disabled:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"input"}},setup(d){const n=d,t=pe(),o=y(()=>Array.from(t.inputElements.value)),u=y(()=>t.currentModelValue.value[n.index]),c=y(()=>n.disabled||t.disabled.value),_=y(()=>t.otp.value),i=y(()=>t.mask.value),{primitiveElement:p,currentElement:v}=X();function I(e){var r,C;const a=e.target;if(((C=(r=e.data)==null?void 0:r.length)!=null?C:0)>1){w(a.value);return}if(t.isNumericMode.value&&!/^\d*$/.test(a.value)){a.value=a.value.replace(/\D/g,"");return}a.value=e.data||a.value.slice(-1),f(n.index,a.value);const s=o.value[n.index+1];s&&s.focus()}function q(){const e=v.value;ee(()=>{e&&!e.value&&(e.placeholder=t.placeholder.value)})}function h(e){te(e,ae(),void 0,{itemsArray:o.value,focus:!0,loop:!1,arrowKeyOptions:"horizontal",dir:t.dir.value})}function B(e){if(e.preventDefault(),e.target.value)f(n.index,"");else{const r=o.value[n.index-1];r&&(r.focus(),f(n.index-1,""))}}function V(e){e.key==="Delete"&&(e.preventDefault(),f(n.index,""))}function D(e){const a=e.target;a.setSelectionRange(1,1),a.value||(a.placeholder=""),setTimeout(()=>{a.value||(a.placeholder="")})}function k(e){q()}function M(e){e.preventDefault();const a=e.clipboardData;if(!a)return;const s=a.getData("text");w(s)}function w(e){var C;const a=[...t.currentModelValue.value],s=e.length>=o.value.length?0:n.index,r=Math.min(s+e.length,o.value.length);for(let E=s;E<r;E++){const H=o.value[E],j=e[E-s];t.isNumericMode.value&&!/^\d*$/.test(j)||(a[E]=j,H.focus())}t.modelValue.value=a,(C=o.value[r])==null||C.focus()}function m(e){let a=e.length-1;for(;a>=0&&e[a]==="";)e.pop(),a--;return e}function f(e,a){const s=[...t.currentModelValue.value];if(t.isNumericMode.value){const r=+a;a===""||isNaN(r)?delete s[e]:s[e]=r}else s[e]=a;t.modelValue.value=m(s)}return A(u,()=>{u.value||q()}),Y(()=>{t.onInputElementChange(v.value)}),Z(()=>{var e;(e=t.inputElements)==null||e.value.delete(v.value)}),(e,a)=>(g(),b(l(F),{ref_key:"primitiveElement",ref:p,autocapitalize:"none",as:e.as,"as-child":e.asChild,autocomplete:_.value?"one-time-code":"false",type:i.value?"password":"text",inputmode:l(t).isNumericMode.value?"numeric":"text",pattern:l(t).isNumericMode.value?"[0-9]*":void 0,placeholder:l(t).placeholder.value,value:u.value,disabled:c.value,"data-disabled":c.value?"":void 0,"data-complete":l(t).isCompleted.value?"":void 0,"aria-label":"pin input ".concat(e.index+1," of ").concat(o.value.length),onInput:a[0]||(a[0]=s=>I(s)),onKeydown:[S(h,["left","right","up","down","home","end"]),S(B,["backspace"]),S(V,["delete"])],onFocus:D,onBlur:k,onPaste:M},{default:x(()=>[$(e.$slots,"default")]),_:3},8,["as","as-child","autocomplete","type","inputmode","pattern","placeholder","value","disabled","data-disabled","data-complete","aria-label"]))}}),he=ve;const ye=P({__name:"PinInput",props:{modelValue:{default:()=>[]},defaultValue:{},placeholder:{},mask:{type:Boolean},otp:{type:Boolean},type:{},dir:{},disabled:{type:Boolean},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue","complete"],setup(d,{emit:n}){const t=d,o=n,u=R(t,"class"),c=le(u,o);return(_,i)=>(g(),b(l(fe),N(l(c),{class:l(z)("flex gap-2 items-center",t.class)}),{default:x(()=>[$(_.$slots,"default")]),_:3},16,["class"]))}}),ge=P({__name:"PinInputGroup",props:{asChild:{type:Boolean},as:{},class:{}},setup(d){const n=d,t=R(n,"class"),o=T(t);return(u,c)=>(g(),b(l(F),N(l(o),{class:l(z)("flex items-center",n.class)}),{default:x(()=>[$(u.$slots,"default")]),_:3},16,["class"]))}}),_e=P({__name:"PinInputSlot",props:{index:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(d){const n=d,t=R(n,"class"),o=T(t);return(u,c)=>(g(),b(l(he),N(l(o),{class:l(z)("relative text-center focus:outline-none focus:ring-2 focus:ring-ring focus:relative focus:z-10 flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",n.class)}),null,16,["class"]))}}),xe=P({name:"FaPinInput",__name:"index",props:K({length:{default:6}},{modelValue:{},modelModifiers:{}}),emits:K(["complete"],["update:modelValue"]),setup(d,{emit:n}){const t=n,o=ne(d,"modelValue"),u=G([]);A(o,i=>{var p;u.value=(p=i==null?void 0:i.split(""))!=null?p:[]});function c(i){o.value=i.join(""),t("complete")}const _=oe();return(i,p)=>(g(),b(l(ye),{id:l(_),modelValue:l(u),"onUpdate:modelValue":p[0]||(p[0]=v=>se(u)?u.value=v:null),placeholder:"○",otp:"",onComplete:c},{default:x(()=>[O(l(ge),null,{default:x(()=>[(g(!0),ue(re,null,de(d.length,(v,I)=>(g(),b(l(_e),{key:v,index:I},null,8,["index"]))),128))]),_:1})]),_:1},8,["id","modelValue"]))}});export{xe as _};
