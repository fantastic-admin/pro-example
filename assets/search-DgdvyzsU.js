
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as ue,aq as ie,b9 as ce,J as fe,a as de,ay as pe,aX as me,az as he,n as D,s as K,bg as ve,x as _e,N as G,b7 as b,a7 as be,ae as ge,bh as W,l as I,o as h,w as g,g as p,c as w,e as l,F as X,q as Q,f as o,A as Y,b as C,_ as ye,t as k,i as Z,W as xe,aG as T,at as V,p as we,ac as ke,a1 as Re}from"./index-H6QnEWHf.js";import{_ as Se}from"./index.vue_vue_type_script_setup_true_lang-ChpqWgwo.js";import{_ as Me}from"./index.vue_vue_type_script_setup_true_lang-ByxJxKu_.js";import{m as ee}from"./index-Cm0HenuK.js";import ze from"./index-5LqAGxil.js";import{_ as Ie}from"./item.vue_vue_type_script_setup_true_lang-CPGgrVV-.js";import"./useNonce-BgbsT9jy.js";import"./clamp-BstbYvQo.js";const Ce={class:"h-12 flex flex-shrink-0 items-center"},Te={class:"h-full w-14 flex-center"},Ve=["placeholder","onKeydown"],Ee={key:0,class:"h-full w-14 flex-center border-s"},Ne={class:"w-full flex justify-between px-4 py-3"},$e={class:"flex gap-8"},Be={class:"inline-flex items-center gap-1 text-xs"},Fe={class:"inline-flex items-center gap-1 text-xs"},Le={key:0,class:"inline-flex items-center gap-1 text-xs"},He=["data-index","onClick","onMouseover"],Ue={class:"flex flex-1 flex-col gap-1 truncate border-s px-4 py-3"},qe={class:"truncate text-start text-base font-bold"},De={key:1,class:"h-full flex-col-center py-6 text-secondary-foreground/50"},Ke={class:"m-2 text-base"},Pe={key:2,class:"h-full flex-col-center py-6 text-secondary-foreground/50"},Ae={class:"m-2 text-base"},Je=ue({name:"NavSearchModal",__name:"search",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(E){const c=ie(E,"modelValue"),{t:R}=ce(),se=fe(),M=de(),N=pe(),ne=me(),{generateI18nTitle:S}=he(),m=D(""),P=K("searchInputRef"),{focused:ae}=ve(P),$=D([]),r=D(0),B=K("searchResultRef"),z=K("searchResultItemRef"),y=_e(()=>{let a=[];return a=$.value.filter(e=>{var n,i;let t=!1;return m.value!==""&&(e.path.includes(m.value)&&(t=!0),(S(e.title).toString().includes(m.value)||((i=(n=ee(S(e.title).toString(),m.value,{continuous:!0}))==null?void 0:n.length)!=null?i:0)>0)&&(t=!0),N.getRouteMatchedByPath(e.path).some(v=>{var s,u,f,d;return S((s=v.meta)==null?void 0:s.title).toString().includes(m.value)||((d=(f=ee(S((u=v.meta)==null?void 0:u.title).toString(),m.value,{continuous:!0}))==null?void 0:f.length)!=null?d:0)>0})&&(t=!0)),t}),a});G(()=>c.value,a=>{a?(m.value="",r.value=0,b("up",F),b("down",L),b("enter",H),b("esc",e=>{M.settings.navSearch.enableHotkeys&&(e.preventDefault(),c.value=!1)})):(b.unbind("up",F),b.unbind("down",L),b.unbind("enter",H),b.unbind("esc"))}),G(()=>y.value,()=>{r.value=0,U()}),be(()=>{le(),b("command+k, ctrl+k",a=>{M.settings.navSearch.enableHotkeys&&(a.preventDefault(),c.value=!0)})}),ge(()=>{b.unbind("command+k, ctrl+k")});function le(){$.value=[],ne.allMenus.forEach(a=>{A(a.children)})}function oe(a){var t;let e=!0;return(t=a.children)!=null&&t.every(n=>{var i;return((i=n.meta)==null?void 0:i.menu)===!1})&&(e=!1),e}function A(a,e,t){a.forEach(n=>{var i,v,s,u,f,d,_,x;((i=n.meta)==null?void 0:i.menu)!==!1&&(n.children&&oe(n)?A(n.children,W(e,n.path),(s=(v=n.meta)==null?void 0:v.icon)!=null?s:t):$.value.push({path:W(e,n.path),query:(u=n.meta)==null?void 0:u.query,icon:(d=(f=n.meta)==null?void 0:f.icon)!=null?d:t,title:(_=n.meta)==null?void 0:_.title,link:(x=n.meta)==null?void 0:x.link}))})}function F(){y.value.length&&(r.value-=1,r.value<0&&(r.value=y.value.length-1),U())}function L(){y.value.length&&(r.value+=1,r.value>y.value.length-1&&(r.value=0),U())}function H(){var a,e;(e=(a=z.value)==null?void 0:a.find(t=>Number.parseInt(t.dataset.index)===r.value))==null||e.click()}function U(){var a,e,t,n,i,v,s,u,f;if((t=(e=(a=B.value)==null?void 0:a.ref)==null?void 0:e.el)!=null&&t.viewportElement){const d=B.value.ref.el.viewportElement;let _=0;if(y.value.length>0){_=d.scrollTop;const x=(v=(i=(n=z.value)==null?void 0:n.find(q=>Number.parseInt(q.dataset.index)===r.value))==null?void 0:i.offsetTop)!=null?v:0,J=(f=(u=(s=z.value)==null?void 0:s.find(q=>Number.parseInt(q.dataset.index)===r.value))==null?void 0:u.clientHeight)!=null?f:0,O=d.scrollTop,j=d.clientHeight;x+J>O+j?_=x+J-j:x<=O&&(_=x-16)}d.scrollTo({top:_})}}function re(a,e,t){t?window.open(t,"_blank"):se.push({path:a,query:e}),c.value=!1}return(a,e)=>{const t=ye,n=Me,i=Se,v=Re;return h(),I(v,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=s=>c.value=s),border:"",footer:l(M).mode==="pc",closable:!1,class:"w-full lg-max-w-2xl","content-class":"flex flex-col p-0 min-h-auto","header-class":"p-0","footer-class":"p-0",onOpened:e[4]||(e[4]=s=>ae.value=!0)},{header:g(()=>[o("div",Ce,[o("div",Te,[p(t,{name:"i-ri:search-line",class:"size-4 text-foreground/30"})]),xe(o("input",{ref_key:"searchInputRef",ref:P,"onUpdate:modelValue":e[0]||(e[0]=s=>we(m)?m.value=s:null),placeholder:l(R)("input"),class:"h-full w-full border-0 rounded-md bg-transparent text-base text-foreground focus-outline-none placeholder-foreground/30",onKeydown:[e[1]||(e[1]=T(V(s=>c.value=!1,["prevent"]),["esc"])),T(V(F,["prevent"]),["up"]),T(V(L,["prevent"]),["down"]),T(V(H,["prevent"]),["enter"])]},null,40,Ve),[[ke,l(m)]]),l(M).mode==="mobile"?(h(),w("div",Ee,[p(t,{name:"i-carbon:close",class:"size-4",onClick:e[2]||(e[2]=s=>c.value=!1)})])):C("",!0)])]),footer:g(()=>[o("div",Ne,[o("div",$e,[o("div",Be,[p(n,null,{default:g(()=>[p(t,{name:"i-ion:md-return-left",class:"size-4"})]),_:1}),o("span",null,k(l(R)("enter")),1)]),o("div",Fe,[p(n,null,{default:g(()=>[p(t,{name:"i-ant-design:caret-up-filled",class:"size-4"})]),_:1}),p(n,null,{default:g(()=>[p(t,{name:"i-ant-design:caret-down-filled",class:"size-4"})]),_:1}),o("span",null,k(l(R)("up_down")),1)])]),l(M).settings.navSearch.enableHotkeys?(h(),w("div",Le,[p(n,null,{default:g(()=>[...e[5]||(e[5]=[Z(" ESC ",-1)])]),_:1}),o("span",null,k(l(R)("esc")),1)])):C("",!0)])]),default:g(()=>[p(i,{ref_key:"searchResultRef",ref:B},{default:g(()=>[l(y).length>0?(h(!0),w(X,{key:0},Q(l(y),(s,u)=>(h(),w("div",{ref_for:!0,ref_key:"searchResultItemRef",ref:z,key:s.path,class:"p-4","data-index":u,onClick:f=>re(s.path,s.query,s.link),onMouseover:f=>r.value=u},[o("a",{class:Y(["flex cursor-pointer items-center border rounded-lg",{"-mt-4":u!==0,"bg-accent":u===l(r)}])},[s.icon?(h(),I(t,{key:0,name:s.icon,class:Y(["size-5 basis-16 transition",{"scale-120 text-primary":u===l(r)}])},null,8,["name","class"])):C("",!0),o("div",Ue,[o("div",qe,k(l(S)(s.title)),1),l(N).getRouteMatchedByPath(s.path).length?(h(),I(ze,{key:0,class:"truncate"},{default:g(()=>[(h(!0),w(X,null,Q(l(N).getRouteMatchedByPath(s.path),(f,d)=>(h(),I(Ie,{key:d,class:"text-xs"},{default:g(()=>{var _;return[Z(k(l(S)((_=f.meta)==null?void 0:_.title)),1)]}),_:2},1024))),128))]),_:2},1024)):C("",!0)])],2)],40,He))),128)):l(m)===""?(h(),w("div",De,[p(t,{name:"i-tabler:mood-smile",class:"size-10"}),o("p",Ke,k(l(R)("welcome")),1)])):(h(),w("div",Pe,[p(t,{name:"i-tabler:mood-empty",class:"size-10"}),o("p",Ae,k(l(R)("empty")),1)]))]),_:1},512)]),_:1},8,["modelValue","footer"])}}});function te(E){const c=E;c.__i18n=c.__i18n||[],c.__i18n.push({locale:"",resource:{"zh-cn":{input:{t:0,b:{t:2,i:[{t:3}],s:"支持标题、拼音(首字母)、URL模糊查询"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"输入你要搜索的导航"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"没有找到你想要的"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"切换"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"访问"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"退出"}}},"zh-tw":{input:{t:0,b:{t:2,i:[{t:3}],s:"支持標題、拼音(首字母)、URL模糊查詢"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"輸入你要搜索的導航"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"沒有找到你想要的"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"切換"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"訪問"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"退出"}}},en:{input:{t:0,b:{t:2,i:[{t:3}],s:"Support title, URL fuzzy query"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"Enter the navigation you want to search"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"Not found"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"Choice"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"Enter"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"Exit"}}}}})}typeof te=="function"&&te(Je);export{Je as default};
