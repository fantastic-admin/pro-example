
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./vue-ui-sparkline-DA40psbw-BtZs10Zn.js","./index-Bnionyve.js","./index-DpF4sDjY.css","./vue-data-ui-DO-nR8BN.js","./alert-Vqv_sKXu.js","./command.vue_vue_type_script_setup_true_lang-BupUAzs5.js","./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js","./vue-data-ui-D1HaM8UR.css","./useNestedProp-dJX_8vvZ-Dub3p3M4.js","./useResponsive-DfdjqQps-DzVAt69W.js","./useChartAccessibility-9icAAmYg-DZae9bBn.js","./BaseScanner-BgWxam9d-Cak_1oua.js","./themes-AUNCOb2G-RAhReTPj.js","./useTimeLabels-BGFjWgrv-C_AB8TRS.js","./UserOptions-1OZ3jcm6-ChPN5pX4.js","./vClickOutside-C6WiFswA-B2BXHGcD.js","./img-BecE5qXd-BcsKpilD.js","./dom-to-png--BNgrTZV-Dq14aDuv.js"])))=>i.map(i=>d[i]);
import{bv as Te,g as c,an as We,Z as ye,M as k,a1 as he,cE as Me,af as Be,c as d,o as v,O as f,l as p,U as r,p as x,w as Re,a as u,k as P,cA as q,R as Q,S as Z,n as J,N as Ge,co as Ue,m as F,r as $,B as ke,ao as je,cC as K}from"./index-Bnionyve.js";import{t as Le,o as xe}from"./useNestedProp-dJX_8vvZ-Dub3p3M4.js";import{s as He,Q as Xe,v as qe,m as E,C as Qe,g as Ze,p as _e,b as Je,aa as Ke,a as Ye,I as T,f as W,e as et,r as tt}from"./vue-data-ui-DO-nR8BN.js";import{m as at}from"./usePrinter-DTzqpYKF-B2bIVIDD.js";import{a as lt}from"./useUserOptionState-BIvW1Kz7-KDDO9AXL.js";import{i as ot}from"./vClickOutside-C6WiFswA-B2BXHGcD.js";import{J as nt}from"./themes-AUNCOb2G-RAhReTPj.js";import"./alert-Vqv_sKXu.js";import"./command.vue_vue_type_script_setup_true_lang-BupUAzs5.js";import"./index.vue_vue_type_script_setup_true_lang-BlKfdQqy.js";const ut=["id"],st={style:{"z-index":"1","padding-right":"24px"}},rt={key:0,style:{display:"flex",flexDirection:"row",alignItems:"center"}},it={key:0,style:{display:"flex",flexDirection:"row",alignItems:"center"}},vt=["onClick"],dt=["onClick"],ct=["data-cell"],pt=["data-cell","onPointerenter"],mt=["data-cell"],bt=["data-cell"],gt=["data-cell"],ft=["data-cell"],yt={key:1,ref:"source",dir:"auto"},ht={__name:"vue-ui-table-sparkline",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},setup(Ce,{expose:we}){Te(t=>({v310cbdc6:t.tdo}));const Ie=q(()=>K(()=>import("./vue-ui-sparkline-DA40psbw-BtZs10Zn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),N=q(()=>K(()=>import("./vue-data-ui-DO-nR8BN.js").then(t=>t.aw),__vite__mapDeps([3,1,2,4,5,6,7]),import.meta.url)),Ae=q(()=>K(()=>import("./UserOptions-1OZ3jcm6-ChPN5pX4.js"),__vite__mapDeps([14,1,2,15,3,4,5,6,7,16,17]),import.meta.url)),{vue_ui_table_sparkline:Se}=Le(),_=Ce,M=c(Xe()),Y=c(0),B=c(0),R=c(null),$e=We();ye(()=>{$e["chart-background"]&&console.warn("VueUiTableSparkline does not support the #chart-background slot.")});const e=k({get:()=>ae(),set:t=>t}),{userOptionsVisible:G,setUserOptionsVisibility:ee,keepUserOptionState:te}=lt({config:e.value});function ae(){const t=xe({userConfig:_.config,defaultConfig:Se});return t.theme?{...xe({userConfig:nt.vue_ui_table_sparkline[t.theme]||_.config,defaultConfig:t}),customPalette:qe[t.theme]||E}:t}he(()=>_.config,t=>{e.value=ae(),G.value=!e.value.userOptions.showOnChartHover,se(),B.value+=1},{deep:!0}),he(()=>_.dataset,t=>{b.value=O.value,B.value+=1},{deep:!0});const{isPrinting:le,isImaging:oe,generatePdf:ne,generateImage:ue}=at({elementId:"table_".concat(M.value),fileName:e.value.title.text||"vue-ui-table-sparkline",options:e.value.userOptions.print}),Oe=k(()=>Qe(e.value.customPalette)),V=c(null),U=c(!1),ze=k(()=>e.value.responsiveBreakpoint);ye(()=>{se()});const j=c(e.value.colNames),I=Me(null);function se(){Ze(_.dataset)&&_e({componentName:"VueUiTableSparkline",type:"dataset"}),I.value&&I.value.disconnect(),I.value=new ResizeObserver(t=>{t.forEach(l=>{U.value=l.contentRect.width<ze.value})}),V.value&&I.value.observe(V.value),j.value=[];for(let t=0;t<ve.value;t+=1)j.value.push(e.value.colNames[t]||"col ".concat(t))}Be(()=>{I.value&&I.value.disconnect()});const re=k(()=>(_.dataset.forEach((t,l)=>{Je({datasetObject:t,requiredAttributes:["name","values"]}).forEach(a=>{_e({componentName:"VueUiTableSparkline",type:"datasetSerieAttribute",property:a,index:l})})}),_.dataset.map((t,l)=>{const a=(t.values||[]).map(n=>isNaN(n)?0:n!=null?n:0),o=a.reduce((n,m)=>n+m,0),s=o/a.length,i=Ke(a);return{...t,values:t.values||[],color:Ye(t.color)||Oe.value[l]||E[l]||E[l%E.length],sum:o,average:s,median:i,sparklineDataset:a.map((n,m)=>({period:e.value.colNames[m]||"col ".concat(m),value:n||0}))}})));function Pe(t){const l=(t[0].values||[]).map((a,o)=>t.map(s=>s.values[o]||[])).map(a=>a.map((o,s)=>[o,s]).sort((o,s)=>s[0]-o[0]).map(o=>o[1]));return t.map((a,o)=>({...a,values:a.values||[],orders:l[o]}))}const O=k(()=>Pe(re.value)),b=c(O.value),Fe=k(()=>Math.max(...b.value.map(t=>(t.values||[]).length))),L=c(void 0),H=c(!1),g=c(void 0),ie=c(1);function A(){H.value=!1,g.value=void 0,y.value=void 0,ie.value=1,z.value.forEach(t=>t.state=1),C.value={name:1,sum:1,average:1,median:1},b.value=O.value}function D(t,l,a){if(["name","sum","average","median"].includes(t.type)){Ne(t.type,l,a);return}if(!pe(l))return;if(w.value=l,y.value=void 0,![null,void 0].includes(g.value)&&l!==g.value&&(g.value=void 0,A()),z.value[l].state===a&&g.value===l){g.value=void 0,A();return}H.value=!0,g.value=l;const o=O.value.map(n=>n.values[l]||[]),s=a;z.value[l].state=s,ie.value=s,l===L.value?L.value=void 0:L.value=l;const i=o.map((n,m)=>[m,n]).sort((n,m)=>s*(m[1]-n[1])).map(n=>n[0]).map(n=>O.value[n]);b.value=i,B.value+=1}const ve=k(()=>Math.max(..._.dataset.map(t=>(t.values||[]).length))),h=k(()=>{let t=j.value.map(a=>({type:"reg",value:a}));if(!t.length)for(let a=0;a<ve.value;a+=1)t.push({type:"reg",value:"col ".concat(a+1)});e.value.showTotal&&(t=[...t,{type:"sum",value:e.value.translations.total}]);let l;return e.value.showAverage&&e.value.showMedian?l=[...t,{type:"average",value:e.value.translations.average},{type:"median",value:e.value.translations.median}]:e.value.showAverage&&!e.value.showMedian?l=[...t,{type:"average",value:e.value.translations.average}]:!e.value.showAverage&&e.value.showMedian?l=[...t,{type:"median",value:e.value.translations.median}]:l=t,e.value.showSparklines?[...l,{type:"chart",value:e.value.translations.chart}]:l}),C=c({name:1,sum:1,average:1,median:1}),y=c(void 0);function Ne(t,l,a){if(!b.value||b.value.length===0||!me(t))return;if(y.value!==t&&(y.value=void 0),![null,void 0].includes(g.value)&&l!==g.value&&A(),g.value=void 0,C.value[t]===a&&y.value){y.value=void 0,A();return}y.value=t,H.value=!0,C.value[t]=a,[null,void 0].includes(l)||(z.value[l].state=C.value[t]);const o=C.value[t],s=[...b.value].sort((i,n)=>{var ge,fe;const m=(ge=i[t])!=null?ge:typeof i[t]=="number"?0:"",S=(fe=n[t])!=null?fe:typeof n[t]=="number"?0:"";return typeof m=="string"&&typeof S=="string"?o===-1?m.localeCompare(S):S.localeCompare(m):typeof m=="number"&&typeof S=="number"?o===-1?m-S:S-m:0});b.value=s}const w=c(void 0),X=c(void 0);function Ve({dataIndex:t,serieIndex:l}){w.value=t,X.value=l,R.value[t]&&!U.value&&R.value[t].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}const de=c(!1);function De(t){de.value=t,Y.value+=1}function ce(t=null){je(()=>{const l=[e.value.translations.serie].concat(h.value),a=re.value.map((i,n)=>[[i.name],i.values,[i.sum],[i.average],[i.median]]),o=[l].concat(a),s=et(o);t?t(s):tt({csvContent:s,title:e.value.title.text||"vue-ui-table-sparkline"})})}function pe(t){return e.value.sortedDataColumnIndices.includes(t)}function me(t){return t.type==="name"||t==="name"?e.value.sortedSeriesName:t.type==="sum"||t==="sum"?e.value.sortedSum:t.type==="average"||t==="average"?e.value.sortedAverage:t.type==="median"||t==="median"?e.value.sortedMedian:!1}function be(t,l,a){return["sum","average","median"].includes(l.type)?y.value===l.type&&C.value[l.type]===a?1:.3:t===g.value&&z.value[t].state===a?1:.3}function Ee(){e.value.resetSortOnClickOutside&&A()}const z=k({get:()=>h.value.map(t=>({state:1})),set:t=>t});return we({generatePdf:ne,generateImage:ue,generateCsv:ce,restoreOrder:A}),(t,l)=>(v(),d("div",{ref_key:"tableContainer",ref:V,class:J({"vue-data-ui-component":!0,"vue-ui-table-sparkline":!0,"vue-ui-responsive":U.value}),style:{overflow:"hidden"},id:"table_".concat(M.value),onMouseenter:l[3]||(l[3]=()=>u(ee)(!0)),onMouseleave:l[4]||(l[4]=()=>u(ee)(!1))},[e.value.title.text?(v(),d("div",{key:0,class:"vue-ui-table-sparkline-caption",style:r({backgroundColor:e.value.title.backgroundColor})},[p("div",{class:"atom-title",style:r({fontSize:"".concat(e.value.title.fontSize,"px"),fontWeight:e.value.title.bold?"bold":"normal",color:e.value.title.color,textAlign:e.value.title.textAlign})},x(e.value.title.text),5),e.value.title.subtitle.text?(v(),d("div",{key:0,class:"atom-subtitle",style:r({fontSize:"".concat(e.value.title.subtitle.fontSize,"px"),fontWeight:e.value.title.subtitle.bold?"bold":"normal",color:e.value.title.subtitle.color,textAlign:e.value.title.textAlign})},x(e.value.title.subtitle.text),5)):f("",!0)],4)):f("",!0),p("div",{style:{overflow:"auto"},onPointerleave:l[2]||(l[2]=a=>{X.value=void 0,w.value=void 0})},[p("table",{class:"vue-ui-data-table",style:r({fontFamily:e.value.fontFamily,position:"relative"})},[p("thead",st,[Re((v(),d("tr",{role:"row",class:"vue-ui-data-table__thead-row",style:r({backgroundColor:e.value.thead.backgroundColor,color:e.value.thead.color})},[p("th",{role:"cell",style:r({backgroundColor:e.value.thead.backgroundColor,border:e.value.thead.outline,textAlign:e.value.thead.textAlign,fontWeight:e.value.thead.bold?"bold":"normal"}),class:"sticky-col-first"},[p("div",{style:r({display:"flex",flexDirection:"row",alignItems:"center",gap:"3px",justifyContent:e.value.thead.textAlign})},[p("span",null,x(e.value.translations.serie),1),b.value.length>1&&e.value.sortedSeriesName?(v(),d("div",rt,[p("button",{class:"vue-ui-table-sparkline-sorting-button vue-ui-table-sparkline-sorting-button-down",onClick:l[0]||(l[0]=a=>D({type:"name"},null,-1))},[P(u(N),{size:12,name:"arrowBottom",stroke:e.value.thead.color,style:r({opacity:y.value==="name"&&C.value.name===-1?1:.3})},null,8,["stroke","style"])]),p("button",{class:"vue-ui-table-sparkline-sorting-button vue-ui-table-sparkline-sorting-button-up",onClick:l[1]||(l[1]=a=>D({type:"name"},null,1))},[P(u(N),{size:12,name:"arrowTop",stroke:e.value.thead.color,style:r({opacity:y.value==="name"&&C.value.name===1?1:.3})},null,8,["stroke","style"])])])):f("",!0)],4)],4),(v(!0),d(Q,null,Z(h.value,(a,o)=>(v(),d("th",{role:"cell",style:r({background:e.value.thead.backgroundColor,border:e.value.thead.outline,textAlign:e.value.thead.textAlign,fontWeight:e.value.thead.bold?"bold":"normal",minWidth:o===h.value.length-1?"".concat(e.value.sparkline.dimensions.width,"px"):"48px",paddingRight:o===h.value.length-1&&e.value.userOptions.show?"36px":""}),class:J({"sticky-col":o===h.value.length-1&&e.value.showSparklines})},[p("div",{style:r({display:"flex",flexDirection:"row",alignItems:"center",gap:"3px",justifyContent:e.value.thead.textAlign})},[p("span",null,x(a.value),1),b.value.length>1&&(pe(o)||me(a))?(v(),d("div",it,[p("button",{class:"vue-ui-table-sparkline-sorting-button vue-ui-table-sparkline-sorting-button-down",onClick:()=>D(a,o,-1)},[P(u(N),{size:12,name:"arrowBottom",stroke:e.value.thead.color,style:r({opacity:be(o,a,-1)})},null,8,["stroke","style"])],8,vt),p("button",{class:"vue-ui-table-sparkline-sorting-button vue-ui-table-sparkline-sorting-button-up",onClick:()=>D(a,o,1)},[P(u(N),{size:12,name:"arrowTop",stroke:e.value.thead.color,style:r({opacity:be(o,a,1)})},null,8,["stroke","style"])],8,dt)])):f("",!0)],4),e.value.userOptions.show&&o===h.value.length-1&&(u(te)||u(G))?(v(),Ge(u(Ae),{ref_for:!0,ref:"details",key:"user_option_".concat(Y.value),backgroundColor:e.value.thead.backgroundColor,color:e.value.thead.color,isPrinting:u(le),isImaging:u(oe),uid:M.value,hasPdf:e.value.userOptions.buttons.pdf,hasXls:e.value.userOptions.buttons.csv,hasImg:e.value.userOptions.buttons.img,hasFullscreen:e.value.userOptions.buttons.fullscreen,isFullscreen:de.value,titles:{...e.value.userOptions.buttonTitles},chartElement:V.value,position:e.value.userOptions.position,callbacks:e.value.userOptions.callbacks,printScale:e.value.userOptions.print.scale,onToggleFullscreen:De,onGeneratePdf:u(ne),onGenerateImage:u(ue),onGenerateCsv:ce,style:r({visibility:u(te)?u(G)?"visible":"hidden":"visible"})},Ue({_:2},[t.$slots.menuIcon?{name:"menuIcon",fn:F(({isOpen:s,color:i})=>[$(t.$slots,"menuIcon",ke({ref_for:!0},{isOpen:s,color:i}),void 0,!0)]),key:"0"}:void 0,t.$slots.optionPdf?{name:"optionPdf",fn:F(()=>[$(t.$slots,"optionPdf",{},void 0,!0)]),key:"1"}:void 0,t.$slots.optionCsv?{name:"optionCsv",fn:F(()=>[$(t.$slots,"optionCsv",{},void 0,!0)]),key:"2"}:void 0,t.$slots.optionImg?{name:"optionImg",fn:F(()=>[$(t.$slots,"optionImg",{},void 0,!0)]),key:"3"}:void 0,t.$slots.optionFullscreen?{name:"optionFullscreen",fn:F(({toggleFullscreen:s,isFullscreen:i})=>[$(t.$slots,"optionFullscreen",ke({ref_for:!0},{toggleFullscreen:s,isFullscreen:i}),void 0,!0)]),key:"4"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasPdf","hasXls","hasImg","hasFullscreen","isFullscreen","titles","chartElement","position","callbacks","printScale","onGeneratePdf","onGenerateImage","style"])):f("",!0)],6))),256))],4)),[[u(ot),Ee]])]),p("tbody",null,[(v(!0),d(Q,null,Z(b.value,(a,o)=>{var s;return v(),d("tr",{role:"row",style:r({backgroundColor:e.value.tbody.backgroundColor,color:e.value.tbody.color}),class:J({"vue-ui-data-table__tbody__row":!0,"vue-ui-data-table__tbody__row-even":o%2===0,"vue-ui-data-table__tbody__row-odd":o%2!==0})},[p("td",{role:"cell",style:r({backgroundColor:e.value.tbody.backgroundColor,border:e.value.tbody.outline,fontSize:"".concat(e.value.tbody.fontSize,"px"),fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.serie,class:"vue-ui-data-table__tbody__td sticky-col-first"},[p("div",{dir:"auto",style:r({display:"flex",flexDirection:"row",alignItems:"center",gap:"6px",justifyContent:e.value.tbody.textAlign})},[e.value.tbody.showColorMarker?(v(),d("span",{key:0,style:r({color:a.color})},"⬤",4)):f("",!0),p("span",null,x((s=a.name)!=null?s:"-"),1)],4)],12,ct),(v(!0),d(Q,null,Z(Fe.value,(i,n)=>(v(),d("td",{dir:"auto",role:"cell",ref_for:!0,ref_key:"TD",ref:R,style:r({border:e.value.tbody.outline,fontSize:"".concat(e.value.tbody.fontSize,"px"),fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign,background:w.value!==void 0&&n===w.value?e.value.tbody.selectedColor.useSerieColor?"".concat(a.color.length>7?a.color.slice(0,-2):a.color,"33"):e.value.tbody.selectedColor.fallback:""}),"data-cell":h.value[n]?h.value[n].value:"",class:"vue-ui-data-table__tbody__td",onPointerenter:m=>{X.value=o,w.value=n}},x([null,void 0].includes(a.values[n])?"-":u(T)(e.value.formatter,Number(a.values[n]),u(W)({p:e.value.prefix,v:Number(a.values[n]),s:e.value.suffix,r:e.value.roundingValues}),{datapoint:a,seriesIndex:o,datapointIndex:n})),45,pt))),256)),e.value.showTotal?(v(),d("td",{key:0,dir:"auto",role:"cell",style:r({border:e.value.tbody.outline,fontSize:"".concat(e.value.tbody.fontSize,"px"),fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.total,class:"vue-ui-data-table__tbody__td"},x(u(T)(e.value.formatter,a.sum,u(W)({p:e.value.prefix,v:a.sum,s:e.value.suffix,r:e.value.roundingTotal}),{datapoint:a.sum,seriesIndex:o})),13,mt)):f("",!0),e.value.showAverage?(v(),d("td",{key:1,dir:"auto",role:"cell",style:r({border:e.value.tbody.outline,fontSize:"".concat(e.value.tbody.fontSize,"px"),fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.average,class:"vue-ui-data-table__tbody__td"},x(u(T)(e.value.formatter,a.average,u(W)({p:e.value.prefix,v:a.average,s:e.value.suffix,r:e.value.roundingAverage}),{datapoint:a.average,seriesIndex:o})),13,bt)):f("",!0),e.value.showMedian?(v(),d("td",{key:2,dir:"auto",role:"cell",style:r({border:e.value.tbody.outline,fontSize:"".concat(e.value.tbody.fontSize,"px"),fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign}),"data-cell":e.value.translations.median,class:"vue-ui-data-table__tbody__td"},x(u(T)(e.value.formatter,a.median,u(W)({p:e.value.prefix,v:a.median,s:e.value.suffix,r:e.value.roundingMedian}),{datapoint:a.median,seriesIndex:o})),13,gt)):f("",!0),e.value.showSparklines?(v(),d("td",{key:3,role:"cell","data-cell":e.value.translations.chart,style:r({border:e.value.tbody.outline,fontSize:"".concat(e.value.tbody.fontSize,"px"),fontWeight:e.value.tbody.bold?"bold":"normal",textAlign:e.value.tbody.textAlign,backgroundColor:e.value.tbody.backgroundColor,padding:"0"}),class:"vue-ui-data-table__tbody__td sticky-col"},[P(u(Ie),{onHoverIndex:({index:i})=>Ve({dataIndex:i,serieIndex:o}),"height-ratio":e.value.sparkline.dimensions.heightRatio,"forced-padding":30,dataset:a.sparklineDataset,showInfo:!1,selectedIndex:w.value,config:{type:e.value.sparkline.type,style:{backgroundColor:"transparent",animation:{show:e.value.sparkline.animation.show&&!u(le)&&!u(oe),animationFrames:e.value.sparkline.animation.animationFrames},padding:{right:12},line:{color:a.color,smooth:e.value.sparkline.smooth,strokeWidth:e.value.sparkline.strokeWidth},bar:{color:a.color},area:{color:a.color,opacity:e.value.sparkline.showArea?16:0,useGradient:e.value.sparkline.useGradient},verticalIndicator:{color:a.color},plot:{radius:9,stroke:e.value.tbody.backgroundColor,strokeWidth:3}}}},null,8,["onHoverIndex","height-ratio","dataset","selectedIndex","config"])],12,ft)):f("",!0)],6)}),256))])],4)],32),t.$slots.source?(v(),d("div",yt,[$(t.$slots,"source",{},void 0,!0)],512)):f("",!0)],42,ut))}},zt=He(ht,[["__scopeId","data-v-9e1b786d"]]);export{zt as default};
