
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{_ as A}from"./index.vue_vue_type_script_setup_true_lang-Q8CkpQSJ.js";import{d as O,ap as F,aq as H,b9 as W,n as S,s as X,c as r,o as n,f as u,b as p,F as G,q as J,a4 as B,W as I,at as M,g as b,_ as K,X as U,A as C,e as o,B as R,M as Q,l as Y,t as w,L as V,bi as Z}from"./index-H6QnEWHf.js";import{f as $}from"./filesize-Csas5AuA.js";import{u as ee}from"./index-55_2KoxZ.js";const te={class:"space-y-2"},ae={class:"flex flex-wrap gap-2"},ie=["src"],oe={key:0,class:"absolute inset-0 grid grid-cols-2 place-items-center rounded-lg bg-black/50 p-2 text-white opacity-0 transition-opacity group-hover/image-upload:opacity-100"},se=["onClick"],ne=["onClick"],le=["onClick"],re=["onClick"],ce=["disabled"],de={class:"size-full flex-center border border-2 rounded-lg border-dashed p-0 text-primary"},ue=["multiple"],pe={key:0,class:"flex flex-wrap gap-1 text-xs text-card-foreground/50 empty:hidden"},fe={key:0,class:"after:content-[';_'] last:after:content-empty"},he={key:1,class:"after:content-[';_'] last:after:content-empty"},me={key:2,class:"after:content-[';_'] last:after:content-empty"},ve={key:3,class:"after:content-[';_'] last:after:content-empty"},_e=O({name:"FaImageUpload",__name:"index",props:F({action:{},method:{default:"post"},headers:{default:()=>({})},data:{default:()=>({})},name:{default:"file"},afterUpload:{},multiple:{type:Boolean,default:!1},ext:{default:()=>[]},max:{default:1},width:{default:100},height:{default:100},dimension:{},size:{default:5*1024*1024},hideTips:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:F(["onSuccess"],["update:modelValue"]),setup(x,{emit:_}){const e=x,D=_,t=H(x,"modelValue"),{t:f}=W(),k=S(!1),h=S(0),z=X("fileInputRef");function L(a){var i;const c=a.target;if(!c.files)return;const d=Array.from(c.files),T=e.max===0?d.length:e.max-t.value.length,m=[];for(const s of d.slice(0,T)){if(e.ext.length>0){const g=(i=s.name.split(".").pop())==null?void 0:i.toLowerCase();if(!e.ext.map(y=>y.toLowerCase()).includes(g||"")){V.error(f("typeError",{ext:e.ext.join(" / ")}),{description:s.name});continue}}if(e.size>0&&s.size>e.size){V.error(f("sizeError",{size:$(e.size,{standard:"jedec"})}),{description:"".concat(s.name," (").concat($(s.size,{standard:"jedec"}),")")});continue}m.push(s)}z.value.value="",m.forEach(s=>{k.value=!0,h.value=0;const g=new FormData;Object.entries(e.data).forEach(([l,v])=>{g.append(l,v)}),g.append(e.name,s);let y={};return e.headers instanceof Headers?e.headers.forEach((l,v)=>{y[v]=l}):y={...e.headers},Z({url:e.action,method:e.method,headers:y,data:g,onUploadProgress:l=>{l.total&&(h.value=Math.round(l.loaded*100/l.total))}}).then(async l=>{var j;const v=await((j=e.afterUpload)==null?void 0:j.call(e,l.data));v&&t.value.push(v),D("onSuccess",l.data,s)}).finally(()=>{k.value=!1,h.value=0})})}function N(a){t.value.splice(a,1)}function q(a){ee().open(t.value,a)}function E(a,c){c==="forward"&&a!==0&&(t.value[a]=t.value.splice(a-1,1,t.value[a])[0]),c==="backward"&&a!==t.value.length-1&&(t.value[a]=t.value.splice(a+1,1,t.value[a])[0])}return(a,c)=>{const d=K,T=A;return n(),r("div",te,[u("div",ae,[(n(!0),r(G,null,J(t.value,(m,i)=>(n(),r("div",{key:m,class:"group/image-upload relative flex items-center justify-center overflow-hidden border rounded-lg",style:B({width:"".concat(e.width,"px"),height:"".concat(e.height,"px")})},[u("img",{src:m,class:"h-full w-full object-contain"},null,8,ie),e.disabled?p("",!0):(n(),r("div",oe,[u("div",{class:"flex-center cursor-pointer opacity-60 transition-all hover:scale-110 hover:opacity-100",onClick:M(s=>q(i),["prevent"])},[b(d,{name:"i-icon-park-outline:preview-open",class:"size-6"})],8,se),u("div",{class:"flex-center cursor-pointer opacity-60 transition-all hover:scale-110 hover:opacity-100",onClick:M(s=>N(i),["prevent"])},[b(d,{name:"i-icon-park-outline:delete",class:"size-6"})],8,ne),I(u("div",{class:C(o(R)("flex-center cursor-pointer opacity-60 transition-all",{"hover:scale-110 hover:opacity-100":i!==0,"cursor-not-allowed":i===0})),onClick:s=>E(i,"forward")},[b(d,{name:"i-icon-park-outline:arrow-circle-left",class:"size-6"})],10,le),[[U,t.value.length>1]]),I(u("div",{class:C(o(R)("flex-center cursor-pointer opacity-60 transition-all",{"hover:scale-110 hover:opacity-100":i!==t.value.length-1,"cursor-not-allowed":i===t.value.length-1})),onClick:s=>E(i,"backward")},[b(d,{name:"i-icon-park-outline:arrow-circle-right",class:"size-6"})],10,re),[[U,t.value.length>1]])]))],4))),128)),t.value.length<e.max||e.max===0?(n(),r("button",{key:0,type:"button",class:C(["relative flex-center overflow-hidden bg-transparent",{"cursor-not-allowed":e.disabled||o(k)}]),style:B({width:"".concat(e.width,"px"),height:"".concat(e.height,"px")}),disabled:e.disabled||o(k),onClick:c[0]||(c[0]=m=>{var i;return(i=o(z))==null?void 0:i.click()})},[Q(a.$slots,"default",{},()=>[u("div",de,[b(d,{name:"i-icon-park-outline:upload",class:"text-2xl text-card-foreground/50"})])]),o(k)&&o(h)>0&&o(h)<100?(n(),Y(T,{key:0,"model-value":o(h),class:"absolute inset-x-1 inset-b-1 h-1 w-auto"},null,8,["model-value"])):p("",!0),u("input",{ref_key:"fileInputRef",ref:z,type:"file",accept:"image/*",multiple:e.multiple,class:"hidden",onChange:L},null,40,ue)],14,ce)):p("",!0)]),e.hideTips?p("",!0):(n(),r("div",pe,[e.dimension?(n(),r("div",fe,w(o(f)("dimensionTip",{width:e.dimension.width,height:e.dimension.height})),1)):p("",!0),e.ext.length>0?(n(),r("div",he,w(o(f)("extTip",{ext:e.ext.join(" / ")})),1)):p("",!0),e.size>0?(n(),r("div",me,w(o(f)("sizeTip",{size:o($)(e.size,{standard:"jedec"})})),1)):p("",!0),e.max>1?(n(),r("div",ve,w(o(f)("countTip",{max:e.max})),1)):p("",!0)]))])}}});function P(x){const _=x;_.__i18n=_.__i18n||[],_.__i18n.push({locale:"",resource:{"zh-cn":{dimensionTip:{t:0,b:{t:2,i:[{t:3,v:"建议尺寸为 "},{t:4,k:"width"},{t:3,v:"*"},{t:4,k:"height"}]}},extTip:{t:0,b:{t:2,i:[{t:3,v:"支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeTip:{t:0,b:{t:2,i:[{t:3,v:"大小不超过 "},{t:4,k:"size"}]}},countTip:{t:0,b:{t:2,i:[{t:3,v:"数量不超过 "},{t:4,k:"max"},{t:3,v:" 个"}]}},typeError:{t:0,b:{t:2,i:[{t:3,v:"上传图片只支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeError:{t:0,b:{t:2,i:[{t:3,v:"上传图片大小不能超过 "},{t:4,k:"size"}]}}},"zh-tw":{dimensionTip:{t:0,b:{t:2,i:[{t:3,v:"建議尺寸為 "},{t:4,k:"width"},{t:3,v:"*"},{t:4,k:"height"}]}},extTip:{t:0,b:{t:2,i:[{t:3,v:"支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeTip:{t:0,b:{t:2,i:[{t:3,v:"大小不超過 "},{t:4,k:"size"}]}},countTip:{t:0,b:{t:2,i:[{t:3,v:"數量不超過 "},{t:4,k:"max"},{t:3,v:" 個"}]}},typeError:{t:0,b:{t:2,i:[{t:3,v:"上傳圖片只支持 "},{t:4,k:"ext"},{t:3,v:" 格式"}]}},sizeError:{t:0,b:{t:2,i:[{t:3,v:"上傳圖片大小不能超過 "},{t:4,k:"size"}]}}},en:{dimensionTip:{t:0,b:{t:2,i:[{t:3,v:"Recommended dimension is "},{t:4,k:"width"},{t:3,v:"*"},{t:4,k:"height"}]}},extTip:{t:0,b:{t:2,i:[{t:3,v:"Support "},{t:4,k:"ext"},{t:3,v:" format"}]}},sizeTip:{t:0,b:{t:2,i:[{t:3,v:"Size not more than "},{t:4,k:"size"}]}},countTip:{t:0,b:{t:2,i:[{t:3,v:"Number not more than "},{t:4,k:"max"}]}},typeError:{t:0,b:{t:2,i:[{t:3,v:"Upload image only support "},{t:4,k:"ext"},{t:3,v:" format"}]}},sizeError:{t:0,b:{t:2,i:[{t:3,v:"Upload image size cannot exceed "},{t:4,k:"size"}]}}}}})}typeof P=="function"&&P(_e);export{_e as _};
